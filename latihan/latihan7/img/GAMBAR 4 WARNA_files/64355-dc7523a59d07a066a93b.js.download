(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[64355],{36942:(e,t,n)=>{"use strict";n.d(t,{b:()=>t6});var i=n(52322),r=n(26014),o=n(2784),s=n(84570),a={},l={exports:{}};!function(e,t){!function(n,i){var r="function",o="undefined",s="object",a="string",l="major",c="model",u="name",d="type",h="vendor",g="version",f="architecture",p="console",m="mobile",b="tablet",y="smarttv",v="wearable",w="embedded",_="Amazon",S="Apple",C="ASUS",M="BlackBerry",R="Browser",E="Chrome",O="Firefox",k="Google",x="Huawei",A="Microsoft",T="Motorola",L="Opera",I="Samsung",P="Sharp",D="Sony",N="Xiaomi",F="Zebra",H="Facebook",j="Chromium OS",G="Mac OS",U=function(e,t){var n={};for(var i in e)t[i]&&t[i].length%2==0?n[i]=t[i].concat(e[i]):n[i]=e[i];return n},V=function(e){for(var t={},n=0;n<e.length;n++)t[e[n].toUpperCase()]=e[n];return t},Y=function(e,t){return typeof e===a&&-1!==B(t).indexOf(B(e))},B=function(e){return e.toLowerCase()},q=function(e,t){if(typeof e===a)return e=e.replace(/^\s\s*/,""),typeof t===o?e:e.substring(0,500)},z=function(e,t){for(var n,o,a,l,c,u,d=0;d<t.length&&!c;){var h=t[d],g=t[d+1];for(n=o=0;n<h.length&&!c&&h[n];)if(c=h[n++].exec(e))for(a=0;a<g.length;a++)u=c[++o],typeof(l=g[a])===s&&l.length>0?2===l.length?typeof l[1]==r?this[l[0]]=l[1].call(this,u):this[l[0]]=l[1]:3===l.length?typeof l[1]!==r||l[1].exec&&l[1].test?this[l[0]]=u?u.replace(l[1],l[2]):i:this[l[0]]=u?l[1].call(this,u,l[2]):i:4===l.length&&(this[l[0]]=u?l[3].call(this,u.replace(l[1],l[2])):i):this[l]=u||i;d+=2}},W=function(e,t){for(var n in t)if(typeof t[n]===s&&t[n].length>0){for(var r=0;r<t[n].length;r++)if(Y(t[n][r],e))return"?"===n?i:n}else if(Y(t[n],e))return"?"===n?i:n;return e},J={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},K={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[g,[u,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[g,[u,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[u,g],[/opios[\/ ]+([\w\.]+)/i],[g,[u,L+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[g,[u,L+" GX"]],[/\bopr\/([\w\.]+)/i],[g,[u,L]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[g,[u,"Baidu"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim)\s?(?:browser)?[\/ ]?([\w\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[u,g],[/\bddg\/([\w\.]+)/i],[g,[u,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[g,[u,"UC"+R]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[g,[u,"WeChat"]],[/konqueror\/([\w\.]+)/i],[g,[u,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[g,[u,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[g,[u,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[g,[u,"Smart Lenovo "+R]],[/(avast|avg)\/([\w\.]+)/i],[[u,/(.+)/,"$1 Secure "+R],g],[/\bfocus\/([\w\.]+)/i],[g,[u,O+" Focus"]],[/\bopt\/([\w\.]+)/i],[g,[u,L+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[g,[u,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[g,[u,"Dolphin"]],[/coast\/([\w\.]+)/i],[g,[u,L+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[g,[u,"MIUI "+R]],[/fxios\/([-\w\.]+)/i],[g,[u,O]],[/\bqihu|(qi?ho?o?|360)browser/i],[[u,"360 "+R]],[/(oculus|sailfish|huawei|vivo)browser\/([\w\.]+)/i],[[u,/(.+)/,"$1 "+R],g],[/samsungbrowser\/([\w\.]+)/i],[g,[u,I+" Internet"]],[/(comodo_dragon)\/([\w\.]+)/i],[[u,/_/g," "],g],[/metasr[\/ ]?([\d\.]+)/i],[g,[u,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[u,"Sogou Mobile"],g],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345Explorer)[\/ ]?([\w\.]+)/i],[u,g],[/(lbbrowser)/i,/\[(linkedin)app\]/i],[u],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[u,H],g],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[u,g],[/\bgsa\/([\w\.]+) .*safari\//i],[g,[u,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[g,[u,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[g,[u,E+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[u,E+" WebView"],g],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[g,[u,"Android "+R]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[u,g],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[g,[u,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[g,u],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[u,[g,W,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[u,g],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[u,"Netscape"],g],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[g,[u,O+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[u,g],[/(cobalt)\/([\w\.]+)/i],[u,[g,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[f,"amd64"]],[/(ia32(?=;))/i],[[f,B]],[/((?:i[346]|x)86)[;\)]/i],[[f,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[f,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[f,"armhf"]],[/windows (ce|mobile); ppc;/i],[[f,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[f,/ower/,"",B]],[/(sun4\w)[;\)]/i],[[f,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[f,B]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[c,[h,I],[d,b]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[c,[h,I],[d,m]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[c,[h,S],[d,m]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[c,[h,S],[d,b]],[/(macintosh);/i],[c,[h,S]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[c,[h,P],[d,m]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[c,[h,x],[d,b]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[c,[h,x],[d,m]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[c,/_/g," "],[h,N],[d,m]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[c,/_/g," "],[h,N],[d,b]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[c,[h,"OPPO"],[d,m]],[/\b(opd2\d{3}a?) bui/i],[c,[h,"OPPO"],[d,b]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[c,[h,"Vivo"],[d,m]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[c,[h,"Realme"],[d,m]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[c,[h,T],[d,m]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[c,[h,T],[d,b]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[c,[h,"LG"],[d,b]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[c,[h,"LG"],[d,m]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[c,[h,"Lenovo"],[d,b]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[c,/_/g," "],[h,"Nokia"],[d,m]],[/(pixel c)\b/i],[c,[h,k],[d,b]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[c,[h,k],[d,m]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[c,[h,D],[d,m]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[c,"Xperia Tablet"],[h,D],[d,b]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[c,[h,"OnePlus"],[d,m]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[c,[h,_],[d,b]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[c,/(.+)/g,"Fire Phone $1"],[h,_],[d,m]],[/(playbook);[-\w\),; ]+(rim)/i],[c,h,[d,b]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[c,[h,M],[d,m]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[c,[h,C],[d,b]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[c,[h,C],[d,m]],[/(nexus 9)/i],[c,[h,"HTC"],[d,b]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[h,[c,/_/g," "],[d,m]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[c,[h,"Acer"],[d,b]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[c,[h,"Meizu"],[d,m]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[c,[h,"Ulefone"],[d,m]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[h,c,[d,m]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[h,c,[d,b]],[/(surface duo)/i],[c,[h,A],[d,b]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[c,[h,"Fairphone"],[d,m]],[/(u304aa)/i],[c,[h,"AT&T"],[d,m]],[/\bsie-(\w*)/i],[c,[h,"Siemens"],[d,m]],[/\b(rct\w+) b/i],[c,[h,"RCA"],[d,b]],[/\b(venue[\d ]{2,7}) b/i],[c,[h,"Dell"],[d,b]],[/\b(q(?:mv|ta)\w+) b/i],[c,[h,"Verizon"],[d,b]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[c,[h,"Barnes & Noble"],[d,b]],[/\b(tm\d{3}\w+) b/i],[c,[h,"NuVision"],[d,b]],[/\b(k88) b/i],[c,[h,"ZTE"],[d,b]],[/\b(nx\d{3}j) b/i],[c,[h,"ZTE"],[d,m]],[/\b(gen\d{3}) b.+49h/i],[c,[h,"Swiss"],[d,m]],[/\b(zur\d{3}) b/i],[c,[h,"Swiss"],[d,b]],[/\b((zeki)?tb.*\b) b/i],[c,[h,"Zeki"],[d,b]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[h,"Dragon Touch"],c,[d,b]],[/\b(ns-?\w{0,9}) b/i],[c,[h,"Insignia"],[d,b]],[/\b((nxa|next)-?\w{0,9}) b/i],[c,[h,"NextBook"],[d,b]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[h,"Voice"],c,[d,m]],[/\b(lvtel\-)?(v1[12]) b/i],[[h,"LvTel"],c,[d,m]],[/\b(ph-1) /i],[c,[h,"Essential"],[d,m]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[c,[h,"Envizen"],[d,b]],[/\b(trio[-\w\. ]+) b/i],[c,[h,"MachSpeed"],[d,b]],[/\btu_(1491) b/i],[c,[h,"Rotor"],[d,b]],[/(shield[\w ]+) b/i],[c,[h,"Nvidia"],[d,b]],[/(sprint) (\w+)/i],[h,c,[d,m]],[/(kin\.[onetw]{3})/i],[[c,/\./g," "],[h,A],[d,m]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[c,[h,F],[d,b]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[c,[h,F],[d,m]],[/smart-tv.+(samsung)/i],[h,[d,y]],[/hbbtv.+maple;(\d+)/i],[[c,/^/,"SmartTV"],[h,I],[d,y]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[h,"LG"],[d,y]],[/(apple) ?tv/i],[h,[c,S+" TV"],[d,y]],[/crkey/i],[[c,E+"cast"],[h,k],[d,y]],[/droid.+aft(\w+)( bui|\))/i],[c,[h,_],[d,y]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[c,[h,P],[d,y]],[/(bravia[\w ]+)( bui|\))/i],[c,[h,D],[d,y]],[/(mitv-\w{5}) bui/i],[c,[h,N],[d,y]],[/Hbbtv.*(technisat) (.*);/i],[h,c,[d,y]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[h,q],[c,q],[d,y]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[d,y]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[h,c,[d,p]],[/droid.+; (shield) bui/i],[c,[h,"Nvidia"],[d,p]],[/(playstation [345portablevi]+)/i],[c,[h,D],[d,p]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[c,[h,A],[d,p]],[/((pebble))app/i],[h,c,[d,v]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[c,[h,S],[d,v]],[/droid.+; (glass) \d/i],[c,[h,k],[d,v]],[/droid.+; (wt63?0{2,3})\)/i],[c,[h,F],[d,v]],[/(quest( \d| pro)?)/i],[c,[h,H],[d,v]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[h,[d,w]],[/(aeobc)\b/i],[c,[h,_],[d,w]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[c,[d,m]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[c,[d,b]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[d,b]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[d,m]],[/(android[-\w\. ]{0,9});.+buil/i],[c,[h,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[g,[u,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[g,[u,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[u,g],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[g,u]],os:[[/microsoft (windows) (vista|xp)/i],[u,g],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[u,[g,W,J]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[g,W,J],[u,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[g,/_/g,"."],[u,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[u,G],[g,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[g,u],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[u,g],[/\(bb(10);/i],[g,[u,M]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[g,[u,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[g,[u,O+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[g,[u,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[g,[u,"watchOS"]],[/crkey\/([\d\.]+)/i],[g,[u,E+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[u,j],g],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[u,g],[/(sunos) ?([\w\.\d]*)/i],[[u,"Solaris"],g],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[u,g]]},$=function(e,t){if(typeof e===s&&(t=e,e=i),!(this instanceof $))return new $(e,t).getResult();var p=typeof n!==o&&n.navigator?n.navigator:i,y=e||(p&&p.userAgent?p.userAgent:""),v=p&&p.userAgentData?p.userAgentData:i,w=t?U(K,t):K,_=p&&p.userAgent==y;return this.getBrowser=function(){var e,t={};return t[u]=i,t[g]=i,z.call(t,y,w.browser),t[l]=typeof(e=t[g])===a?e.replace(/[^\d\.]/g,"").split(".")[0]:i,_&&p&&p.brave&&typeof p.brave.isBrave==r&&(t[u]="Brave"),t},this.getCPU=function(){var e={};return e[f]=i,z.call(e,y,w.cpu),e},this.getDevice=function(){var e={};return e[h]=i,e[c]=i,e[d]=i,z.call(e,y,w.device),_&&!e[d]&&v&&v.mobile&&(e[d]=m),_&&"Macintosh"==e[c]&&p&&typeof p.standalone!==o&&p.maxTouchPoints&&p.maxTouchPoints>2&&(e[c]="iPad",e[d]=b),e},this.getEngine=function(){var e={};return e[u]=i,e[g]=i,z.call(e,y,w.engine),e},this.getOS=function(){var e={};return e[u]=i,e[g]=i,z.call(e,y,w.os),_&&!e[u]&&v&&v.platform&&"Unknown"!=v.platform&&(e[u]=v.platform.replace(/chrome os/i,j).replace(/macos/i,G)),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return y},this.setUA=function(e){return y=typeof e===a&&e.length>500?q(e,500):e,this},this.setUA(y),this};$.VERSION="1.0.38",$.BROWSER=V([u,g,l]),$.CPU=V([f]),$.DEVICE=V([c,h,d,p,m,y,b,v,w]),$.ENGINE=$.OS=V([u,g]),e.exports&&(t=e.exports=$),t.UAParser=$;var X=typeof n!==o&&(n.jQuery||n.Zepto);if(X&&!X.ua){var Q=new $;X.ua=Q.getResult(),X.ua.get=function(){return Q.getUA()},X.ua.set=function(e){Q.setUA(e);var t=Q.getResult();for(var n in t)X.ua[n]=t[n]}}}("object"==typeof window?window:s.c)}(l,l.exports);var c=l.exports;Object.defineProperty(a,"__esModule",{value:!0});var u=function(e){return e&&"object"==typeof e&&"default"in e?e.default:e}(o),d=new c,h=d.getBrowser(),g=d.getCPU(),f=d.getDevice(),p=d.getEngine(),m=d.getOS(),b=d.getUA(),y=function(e){return d.setUA(e)},v=function(e){if(!e){console.error("No userAgent string was provided");return}var t=new c(e);return{UA:t,browser:t.getBrowser(),cpu:t.getCPU(),device:t.getDevice(),engine:t.getEngine(),os:t.getOS(),ua:t.getUA(),setUserAgent:function(e){return t.setUA(e)}}},w=Object.freeze({ClientUAInstance:d,browser:h,cpu:g,device:f,engine:p,os:m,ua:b,setUa:y,parseUserAgent:v});function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function S(e){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function C(){return(C=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function M(e){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function R(e,t){return(R=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function E(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function O(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}var x={Mobile:"mobile",Tablet:"tablet",SmartTv:"smarttv",Console:"console",Wearable:"wearable",Embedded:"embedded",Browser:void 0},A={Chrome:"Chrome",Firefox:"Firefox",Opera:"Opera",Yandex:"Yandex",Safari:"Safari",InternetExplorer:"Internet Explorer",Edge:"Edge",Chromium:"Chromium",Ie:"IE",MobileSafari:"Mobile Safari",EdgeChromium:"Edge Chromium",MIUI:"MIUI Browser",SamsungBrowser:"Samsung Browser"},T={IOS:"iOS",Android:"Android",WindowsPhone:"Windows Phone",Windows:"Windows",MAC_OS:"Mac OS"},L={isMobile:!1,isTablet:!1,isBrowser:!1,isSmartTV:!1,isConsole:!1,isWearable:!1},I=function(e){switch(e){case x.Mobile:return{isMobile:!0};case x.Tablet:return{isTablet:!0};case x.SmartTv:return{isSmartTV:!0};case x.Console:return{isConsole:!0};case x.Wearable:return{isWearable:!0};case x.Browser:return{isBrowser:!0};case x.Embedded:return{isEmbedded:!0};default:return L}},P=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";return e||t},D=function(){return!!("u">typeof window&&(window.navigator||navigator))&&(window.navigator||navigator)},N=function(e){var t=D();return t&&t.platform&&(-1!==t.platform.indexOf(e)||"MacIntel"===t.platform&&t.maxTouchPoints>1&&!window.MSStream)},F=function(e){return e.type===x.Mobile},H=function(e){return e.type===x.Tablet},j=function(e){var t=e.type;return t===x.Mobile||t===x.Tablet},G=function(e){return e.type===x.SmartTv},U=function(e){return e.type===x.Browser},V=function(e){return e.type===x.Wearable},Y=function(e){return e.type===x.Console},B=function(e){return e.type===x.Embedded},q=function(e){return P(e.vendor)},z=function(e){return P(e.model)},W=function(e){return P(e.type,"browser")},J=function(e){return e.name===T.Android},K=function(e){return e.name===T.Windows},$=function(e){return e.name===T.MAC_OS},X=function(e){return e.name===T.WindowsPhone},Q=function(e){return e.name===T.IOS},Z=function(e){return P(e.version)},ee=function(e){return P(e.name)},et=function(e){return e.name===A.Chrome},en=function(e){return e.name===A.Firefox},ei=function(e){return e.name===A.Chromium},er=function(e){return e.name===A.Edge},eo=function(e){return e.name===A.Yandex},es=function(e){var t=e.name;return t===A.Safari||t===A.MobileSafari},ea=function(e){return e.name===A.MobileSafari},el=function(e){return e.name===A.Opera},ec=function(e){var t=e.name;return t===A.InternetExplorer||t===A.Ie},eu=function(e){return e.name===A.MIUI},ed=function(e){return e.name===A.SamsungBrowser},eh=function(e){return P(e.version)},eg=function(e){return P(e.major)},ef=function(e){return P(e.name)},ep=function(e){return P(e.name)},em=function(e){return P(e.version)},eb=function(){var e=D(),t=e&&e.userAgent&&e.userAgent.toLowerCase();return"string"==typeof t&&/electron/.test(t)},ey=function(e){return"string"==typeof e&&-1!==e.indexOf("Edg/")},ev=function(){var e=D();return e&&(/iPad|iPhone|iPod/.test(e.platform)||"MacIntel"===e.platform&&e.maxTouchPoints>1)&&!window.MSStream},ew=function(){return N("iPad")},e_=function(){return N("iPhone")},eS=function(){return N("iPod")},eC=function(e){return P(e)};function eM(e){var t=e||w,n=t.device,i=t.browser,r=t.os,o=t.engine,s=t.ua;return{isSmartTV:G(n),isConsole:Y(n),isWearable:V(n),isEmbedded:B(n),isMobileSafari:ea(i)||ew(),isChromium:ei(i),isMobile:j(n)||ew(),isMobileOnly:F(n),isTablet:H(n)||ew(),isBrowser:U(n),isDesktop:U(n),isAndroid:J(r),isWinPhone:X(r),isIOS:Q(r)||ew(),isChrome:et(i),isFirefox:en(i),isSafari:es(i),isOpera:el(i),isIE:ec(i),osVersion:Z(r),osName:ee(r),fullBrowserVersion:eh(i),browserVersion:eg(i),browserName:ef(i),mobileVendor:q(n),mobileModel:z(n),engineName:ep(o),engineVersion:em(o),getUA:eC(s),isEdge:er(i)||ey(s),isYandex:eo(i),deviceType:W(n),isIOS13:ev(),isIPad13:ew(),isIPhone13:e_(),isIPod13:eS(),isElectron:eb(),isEdgeChromium:ey(s),isLegacyEdge:er(i)&&!ey(s),isWindows:K(r),isMacOs:$(r),isMIUI:eu(i),isSamsungBrowser:ed(i)}}var eR=G(f),eE=Y(f),eO=V(f),ek=B(f),ex=ea(h)||ew(),eA=ei(h),eT=j(f)||ew(),eL=F(f),eI=H(f)||ew(),eP=U(f),eD=U(f),eN=J(m),eF=X(m),eH=Q(m)||ew(),ej=et(h),eG=en(h),eU=es(h),eV=el(h),eY=ec(h),eB=Z(m),eq=ee(m),ez=eh(h),eW=eg(h),eJ=ef(h),eK=q(f),e$=z(f),eX=ep(p),eQ=em(p),eZ=eC(b),e0=er(h)||ey(b),e1=eo(h),e2=W(f),e4=ev(),e8=ew(),e3=e_(),e6=eS(),e5=eb(),e9=ey(b),e7=er(h)&&!ey(b),te=K(m),tt=$(m),tn=eu(h),ti=ed(h);function tr(e){return v(e||window.navigator.userAgent)}a.AndroidView=function(e){var t=e.renderWithFragment,n=e.children,i=E(e,["renderWithFragment","children"]);return eN?t?u.createElement(o.Fragment,null,n):u.createElement("div",i,n):null},a.BrowserTypes=A,a.BrowserView=function(e){var t=e.renderWithFragment,n=e.children,i=E(e,["renderWithFragment","children"]);return eP?t?u.createElement(o.Fragment,null,n):u.createElement("div",i,n):null},a.ConsoleView=function(e){var t=e.renderWithFragment,n=e.children,i=E(e,["renderWithFragment","children"]);return eE?t?u.createElement(o.Fragment,null,n):u.createElement("div",i,n):null},a.CustomView=function(e){var t=e.renderWithFragment,n=e.children;e.viewClassName,e.style;var i=e.condition,r=E(e,["renderWithFragment","children","viewClassName","style","condition"]);return i?t?u.createElement(o.Fragment,null,n):u.createElement("div",r,n):null},a.IEView=function(e){var t=e.renderWithFragment,n=e.children,i=E(e,["renderWithFragment","children"]);return eY?t?u.createElement(o.Fragment,null,n):u.createElement("div",i,n):null},a.IOSView=function(e){var t=e.renderWithFragment,n=e.children,i=E(e,["renderWithFragment","children"]);return eH?t?u.createElement(o.Fragment,null,n):u.createElement("div",i,n):null},a.MobileOnlyView=function(e){var t=e.renderWithFragment,n=e.children;e.viewClassName,e.style;var i=E(e,["renderWithFragment","children","viewClassName","style"]);return eL?t?u.createElement(o.Fragment,null,n):u.createElement("div",i,n):null},a.MobileView=function(e){var t=e.renderWithFragment,n=e.children,i=E(e,["renderWithFragment","children"]);return eT?t?u.createElement(o.Fragment,null,n):u.createElement("div",i,n):null},a.OsTypes=T,a.SmartTVView=function(e){var t=e.renderWithFragment,n=e.children,i=E(e,["renderWithFragment","children"]);return eR?t?u.createElement(o.Fragment,null,n):u.createElement("div",i,n):null},a.TabletView=function(e){var t=e.renderWithFragment,n=e.children,i=E(e,["renderWithFragment","children"]);return eI?t?u.createElement(o.Fragment,null,n):u.createElement("div",i,n):null},a.WearableView=function(e){var t=e.renderWithFragment,n=e.children,i=E(e,["renderWithFragment","children"]);return eO?t?u.createElement(o.Fragment,null,n):u.createElement("div",i,n):null},a.WinPhoneView=function(e){var t=e.renderWithFragment,n=e.children,i=E(e,["renderWithFragment","children"]);return eF?t?u.createElement(o.Fragment,null,n):u.createElement("div",i,n):null},a.browserName=eJ,a.browserVersion=eW,a.deviceDetect=function(e){var t=e?v(e):w,n=t.device,i=t.browser,r=t.engine,o=t.os,s=t.ua,a=I(n.type),l=a.isBrowser,c=a.isMobile,u=a.isTablet,d=a.isSmartTV,h=a.isConsole,g=a.isWearable,f=a.isEmbedded;return l?{isBrowser:l,browserMajorVersion:P(i.major),browserFullVersion:P(i.version),browserName:P(i.name),engineName:P(r.name),engineVersion:P(r.version),osName:P(o.name),osVersion:P(o.version),userAgent:P(s)}:d?{isSmartTV:d,engineName:P(r.name),engineVersion:P(r.version),osName:P(o.name),osVersion:P(o.version),userAgent:P(s)}:h?{isConsole:h,engineName:P(r.name),engineVersion:P(r.version),osName:P(o.name),osVersion:P(o.version),userAgent:P(s)}:c||u?function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach(function(t){var i;i=n[t],t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},a,{vendor:P(n.vendor),model:P(n.model),os:P(o.name),osVersion:P(o.version),ua:P(s)}):g?{isWearable:g,engineName:P(r.name),engineVersion:P(r.version),osName:P(o.name),osVersion:P(o.version),userAgent:P(s)}:f?{isEmbedded:f,vendor:P(n.vendor),model:P(n.model),engineName:P(r.name),engineVersion:P(r.version),osName:P(o.name),osVersion:P(o.version),userAgent:P(s)}:void 0},a.deviceType=e2,a.engineName=eX,a.engineVersion=eQ,a.fullBrowserVersion=ez,a.getSelectorsByUserAgent=function(e){if(!e||"string"!=typeof e){console.error("No valid user agent string was provided");return}var t=v(e);return eM({device:t.device,browser:t.browser,os:t.os,engine:t.engine,ua:t.ua})},a.getUA=eZ,a.isAndroid=eN,a.isBrowser=eP,a.isChrome=ej,a.isChromium=eA,a.isConsole=eE,a.isDesktop=eD,a.isEdge=e0,a.isEdgeChromium=e9,a.isElectron=e5,a.isEmbedded=ek,a.isFirefox=eG,a.isIE=eY,a.isIOS=eH,a.isIOS13=e4,a.isIPad13=e8,a.isIPhone13=e3,a.isIPod13=e6,a.isLegacyEdge=e7,a.isMIUI=tn,a.isMacOs=tt;var to=a.isMobile=eT;a.isMobileOnly=eL,a.isMobileSafari=ex,a.isOpera=eV,a.isSafari=eU,a.isSamsungBrowser=ti,a.isSmartTV=eR,a.isTablet=eI,a.isWearable=eO,a.isWinPhone=eF,a.isWindows=te,a.isYandex=e1,a.mobileModel=e$,a.mobileVendor=eK,a.osName=eq,a.osVersion=eB,a.parseUserAgent=v,a.setUserAgent=function(e){return y(e)},a.useDeviceData=tr,a.useDeviceSelectors=function(e){var t=tr(e||window.navigator.userAgent);return[eM(t),t]},a.useMobileOrientation=function(){var e,t=function(e){if(Array.isArray(e))return e}(e=o.useState(function(){var e=window.innerWidth>window.innerHeight?90:0;return{isPortrait:0===e,isLandscape:90===e,orientation:0===e?"portrait":"landscape"}}))||function(e,t){var n=null==e?null:"u">typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,o=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(i=n.next()).done)&&(o.push(i.value),!(t&&o.length===t));s=!0);}catch(e){a=!0,r=e}finally{try{s||null==n.return||n.return()}finally{if(a)throw r}}return o}}(e,2)||function(e,t){if(e){if("string"==typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(e,t)}}(e,2)||function(){throw TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}(),n=t[0],i=t[1],r=o.useCallback(function(){var e=window.innerWidth>window.innerHeight?90:0,t={isPortrait:0===e,isLandscape:90===e,orientation:0===e?"portrait":"landscape"};n.orientation!==t.orientation&&i(t)},[n.orientation]);return o.useEffect(function(){return(typeof window>"u"?"undefined":S(window))!==void 0&&eT&&(r(),window.addEventListener("load",r,!1),window.addEventListener("resize",r,!1)),function(){window.removeEventListener("resize",r,!1),window.removeEventListener("load",r,!1)}},[r]),n},a.withOrientationChange=function(e){return function(t){var n;function i(e){var t;return function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,i),(t=function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return O(e)}(this,M(i).call(this,e))).isEventListenerAdded=!1,t.handleOrientationChange=t.handleOrientationChange.bind(O(t)),t.onOrientationChange=t.onOrientationChange.bind(O(t)),t.onPageLoad=t.onPageLoad.bind(O(t)),t.state={isLandscape:!1,isPortrait:!1},t}return function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&R(e,t)}(i,t),n=[{key:"handleOrientationChange",value:function(){this.isEventListenerAdded||(this.isEventListenerAdded=!0);var e=window.innerWidth>window.innerHeight?90:0;this.setState({isPortrait:0===e,isLandscape:90===e})}},{key:"onOrientationChange",value:function(){this.handleOrientationChange()}},{key:"onPageLoad",value:function(){this.handleOrientationChange()}},{key:"componentDidMount",value:function(){(typeof window>"u"?"undefined":S(window))!==void 0&&eT&&(this.isEventListenerAdded?window.removeEventListener("load",this.onPageLoad,!1):(this.handleOrientationChange(),window.addEventListener("load",this.onPageLoad,!1)),window.addEventListener("resize",this.onOrientationChange,!1))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onOrientationChange,!1)}},{key:"render",value:function(){return u.createElement(e,C({},this.props,{isLandscape:this.state.isLandscape,isPortrait:this.state.isPortrait}))}}],function(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(i.prototype,n),i}(u.Component)};var ts=n(28316),ta=!1;if("u">typeof window){var tl={get passive(){ta=!0}};window.addEventListener("testPassive",null,tl),window.removeEventListener("testPassive",null,tl)}var tc="u">typeof window&&window.navigator&&window.navigator.platform&&(/iP(ad|hone|od)/.test(window.navigator.platform)||"MacIntel"===window.navigator.platform&&window.navigator.maxTouchPoints>1),tu=[],td=!1,th=-1,tg=void 0,tf=void 0,tp=function(e){return tu.some(function(t){return!!(t.options.allowTouchMove&&t.options.allowTouchMove(e))})},tm=function(e){var t=e||window.event;return!!tp(t.target)||t.touches.length>1||(t.preventDefault&&t.preventDefault(),!1)},tb=function(e){if(void 0===tf){var t=!!e&&!0===e.reserveScrollBarGap,n=window.innerWidth-document.documentElement.clientWidth;t&&n>0&&(tf=document.body.style.paddingRight,document.body.style.paddingRight=n+"px")}void 0===tg&&(tg=document.body.style.overflow,document.body.style.overflow="hidden")},ty=function(){void 0!==tf&&(document.body.style.paddingRight=tf,tf=void 0),void 0!==tg&&(document.body.style.overflow=tg,tg=void 0)},tv=function(e,t){var n=e.targetTouches[0].clientY-th;return!tp(e.target)&&(t&&0===t.scrollTop&&n>0||t&&t.scrollHeight-t.scrollTop<=t.clientHeight&&n<0?tm(e):(e.stopPropagation(),!0))},tw=function(e,t){if(!e){console.error("disableBodyScroll unsuccessful - targetElement must be provided when calling disableBodyScroll on IOS devices.");return}!tu.some(function(t){return t.targetElement===e})&&(tu=[].concat(function(e){if(!Array.isArray(e))return Array.from(e);for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}(tu),[{targetElement:e,options:t||{}}]),tc?(e.ontouchstart=function(e){1===e.targetTouches.length&&(th=e.targetTouches[0].clientY)},e.ontouchmove=function(t){1===t.targetTouches.length&&tv(t,e)},td||(document.addEventListener("touchmove",tm,ta?{passive:!1}:void 0),td=!0)):tb(t))},t_=function(e){if(!e){console.error("enableBodyScroll unsuccessful - targetElement must be provided when calling enableBodyScroll on IOS devices.");return}tu=tu.filter(function(t){return t.targetElement!==e}),tc?(e.ontouchstart=null,e.ontouchmove=null,td&&0===tu.length&&(document.removeEventListener("touchmove",tm,ta?{passive:!1}:void 0),td=!1)):tu.length||ty()};let tS=()=>"u">typeof window&&null!==window,tC=e=>null===e,tM=e=>"object"==typeof e&&!tR(e)&&!tC(e),{isArray:tR}=Array,tE=(e,t,n,i)=>{let r=(0,o.useRef)(t);(0,o.useEffect)(()=>{r.current=t},[t]),(0,o.useEffect)(()=>{if(!n)return;if(!n.addEventListener){console.warn("The given element does not support `addEventListener`",n,e);return}let t=e=>{tM(i)&&i.singleHandler&&e._isHandled||(r.current(e),tM(i)&&i.singleHandler&&(e._isHandled=!0))};return n.addEventListener(e,t,i),()=>n.removeEventListener(e,t,i)},[e,n,i])},tO=(e,{childrenElementRef:t=null,isEnabled:n=!0}={},i=!0)=>{(0,o.useEffect)(()=>{let r=e.current;if(!(!n||!r||!i))return tw(r,{allowTouchMove:e=>{var n;let i=e;for(;i&&i!==document.body;){if(null!=(n=null==t?void 0:t.current)&&n.contains(i))return!0;i=i.parentElement}return!1}}),()=>t_(r)},[e,n,t,i])},tk=(e,{isEnabled:t=!0}={})=>{let n=tS()?document:null,i=(0,o.useCallback)(n=>{let i=n.key||n.keyCode;("Escape"===i||"Esc"===i||27===i)&&t&&e&&(n.preventDefault(),e())},[e,t]);tE("keydown",i,n)};n(14304);var tx=n(4507),tA=n(64729),tT=n(149);let tL=({ariaLabel:e,className:t,color:n,onClick:r,tabIndex:o=-1,testSelector:s})=>(0,i.jsx)(tx.z,{addon:(0,i.jsx)(tT.J,{icon:tA.f,size:"1.5x"}),"aria-label":e,className:t,color:n||"gray",onClick:r,"tab-index":o,testSelector:s,type:"button",variant:"plain"}),tI=300;function tP(){return(tP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(null,arguments)}function tD(e,t){if(null==e)return{};var n={};for(var i in e)if(({}).hasOwnProperty.call(e,i)){if(t.includes(i))continue;n[i]=e[i]}return n}function tN(e,t){return(tN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function tF(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,tN(e,t)}let tH={disabled:!1},tj=o.createContext(null);var tG=function(e){return e.scrollTop},tU="unmounted",tV="exited",tY="entering",tB="entered",tq="exiting",tz=function(e){function t(t,n){i=e.call(this,t,n)||this;var i,r,o=n&&!n.isMounting?t.enter:t.appear;return i.appearStatus=null,t.in?o?(r=tV,i.appearStatus=tY):r=tB:r=t.unmountOnExit||t.mountOnEnter?tU:tV,i.state={status:r},i.nextCallback=null,i}tF(t,e),t.getDerivedStateFromProps=function(e,t){return e.in&&t.status===tU?{status:tV}:null};var n=t.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(e){var t=null;if(e!==this.props){var n=this.state.status;this.props.in?n!==tY&&n!==tB&&(t=tY):(n===tY||n===tB)&&(t=tq)}this.updateStatus(!1,t)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var e,t,n,i=this.props.timeout;return e=t=n=i,null!=i&&"number"!=typeof i&&(e=i.exit,t=i.enter,n=void 0!==i.appear?i.appear:t),{exit:e,enter:t,appear:n}},n.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t){if(this.cancelNextCallback(),t===tY){if(this.props.unmountOnExit||this.props.mountOnEnter){var n=this.props.nodeRef?this.props.nodeRef.current:ts.findDOMNode(this);n&&tG(n)}this.performEnter(e)}else this.performExit()}else this.props.unmountOnExit&&this.state.status===tV&&this.setState({status:tU})},n.performEnter=function(e){var t=this,n=this.props.enter,i=this.context?this.context.isMounting:e,r=this.props.nodeRef?[i]:[ts.findDOMNode(this),i],o=r[0],s=r[1],a=this.getTimeouts(),l=i?a.appear:a.enter;if(!e&&!n||tH.disabled){this.safeSetState({status:tB},function(){t.props.onEntered(o)});return}this.props.onEnter(o,s),this.safeSetState({status:tY},function(){t.props.onEntering(o,s),t.onTransitionEnd(l,function(){t.safeSetState({status:tB},function(){t.props.onEntered(o,s)})})})},n.performExit=function(){var e=this,t=this.props.exit,n=this.getTimeouts(),i=this.props.nodeRef?void 0:ts.findDOMNode(this);if(!t||tH.disabled){this.safeSetState({status:tV},function(){e.props.onExited(i)});return}this.props.onExit(i),this.safeSetState({status:tq},function(){e.props.onExiting(i),e.onTransitionEnd(n.exit,function(){e.safeSetState({status:tV},function(){e.props.onExited(i)})})})},n.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},n.setNextCallback=function(e){var t=this,n=!0;return this.nextCallback=function(i){n&&(n=!1,t.nextCallback=null,e(i))},this.nextCallback.cancel=function(){n=!1},this.nextCallback},n.onTransitionEnd=function(e,t){this.setNextCallback(t);var n=this.props.nodeRef?this.props.nodeRef.current:ts.findDOMNode(this),i=null==e&&!this.props.addEndListener;if(!n||i){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var r=this.props.nodeRef?[this.nextCallback]:[n,this.nextCallback],o=r[0],s=r[1];this.props.addEndListener(o,s)}null!=e&&setTimeout(this.nextCallback,e)},n.render=function(){var e=this.state.status;if(e===tU)return null;var t=this.props,n=t.children;t.in,t.mountOnEnter,t.unmountOnExit,t.appear,t.enter,t.exit,t.timeout,t.addEndListener,t.onEnter,t.onEntering,t.onEntered,t.onExit,t.onExiting,t.onExited,t.nodeRef;var i=tD(t,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return o.createElement(tj.Provider,{value:null},"function"==typeof n?n(e,i):o.cloneElement(o.Children.only(n),i))},t}(o.Component);function tW(){}function tJ(e,t){return e.replace(RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}tz.contextType=tj,tz.propTypes={},tz.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:tW,onEntering:tW,onEntered:tW,onExit:tW,onExiting:tW,onExited:tW},tz.UNMOUNTED=tU,tz.EXITED=tV,tz.ENTERING=tY,tz.ENTERED=tB,tz.EXITING=tq;var tK=function(e,t){return e&&t&&t.split(" ").forEach(function(t){e.classList?e.classList.remove(t):"string"==typeof e.className?e.className=tJ(e.className,t):e.setAttribute("class",tJ(e.className&&e.className.baseVal||"",t))})},t$=function(e){function t(){for(var t,n=arguments.length,i=Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).appliedClasses={appear:{},enter:{},exit:{}},t.onEnter=function(e,n){var i=t.resolveArguments(e,n),r=i[0],o=i[1];t.removeClasses(r,"exit"),t.addClass(r,o?"appear":"enter","base"),t.props.onEnter&&t.props.onEnter(e,n)},t.onEntering=function(e,n){var i=t.resolveArguments(e,n),r=i[0],o=i[1];t.addClass(r,o?"appear":"enter","active"),t.props.onEntering&&t.props.onEntering(e,n)},t.onEntered=function(e,n){var i=t.resolveArguments(e,n),r=i[0],o=i[1]?"appear":"enter";t.removeClasses(r,o),t.addClass(r,o,"done"),t.props.onEntered&&t.props.onEntered(e,n)},t.onExit=function(e){var n=t.resolveArguments(e)[0];t.removeClasses(n,"appear"),t.removeClasses(n,"enter"),t.addClass(n,"exit","base"),t.props.onExit&&t.props.onExit(e)},t.onExiting=function(e){var n=t.resolveArguments(e)[0];t.addClass(n,"exit","active"),t.props.onExiting&&t.props.onExiting(e)},t.onExited=function(e){var n=t.resolveArguments(e)[0];t.removeClasses(n,"exit"),t.addClass(n,"exit","done"),t.props.onExited&&t.props.onExited(e)},t.resolveArguments=function(e,n){return t.props.nodeRef?[t.props.nodeRef.current,e]:[e,n]},t.getClassNames=function(e){var n=t.props.classNames,i="string"==typeof n,r=i?(i&&n?n+"-":"")+e:n[e],o=i?r+"-active":n[e+"Active"],s=i?r+"-done":n[e+"Done"];return{baseClassName:r,activeClassName:o,doneClassName:s}},t}tF(t,e);var n=t.prototype;return n.addClass=function(e,t,n){var i,r=this.getClassNames(t)[n+"ClassName"],o=this.getClassNames("enter").doneClassName;"appear"===t&&"done"===n&&o&&(r+=" "+o),"active"===n&&e&&tG(e),r&&(this.appliedClasses[t][n]=r,i=r,e&&i&&i.split(" ").forEach(function(t){e.classList?e.classList.add(t):(e.classList?!!t&&e.classList.contains(t):-1!==(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" "))||("string"==typeof e.className?e.className=e.className+" "+t:e.setAttribute("class",(e.className&&e.className.baseVal||"")+" "+t))}))},n.removeClasses=function(e,t){var n=this.appliedClasses[t],i=n.base,r=n.active,o=n.done;this.appliedClasses[t]={},i&&tK(e,i),r&&tK(e,r),o&&tK(e,o)},n.render=function(){var e=this.props;e.classNames;var t=tD(e,["classNames"]);return o.createElement(tz,tP({},t,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},t}(o.Component);t$.defaultProps={classNames:""},t$.propTypes={};let tX={},tQ=({children:e,timeout:t=tI,...n})=>{let r=(0,o.useRef)(null);return(0,i.jsx)(t$,{classNames:{enter:tX.fadeInEnter,enterActive:tX.fadeInEnterActive,exit:tX.fadeInExit,exitActive:tX.fadeInExitActive},nodeRef:r,timeout:t,...n,children:e})},tZ={overlay:"_overlay_1ngm8_1","full-screen":"_full-screen_1ngm8_8",centered:"_centered_1ngm8_11",header:"_header_1ngm8_17",title:"_title_1ngm8_20","extra-small":"_extra-small_1ngm8_23",small:"_small_1ngm8_26",medium:"_medium_1ngm8_29",large:"_large_1ngm8_37",modal:"_modal_1ngm8_46",fit:"_fit_1ngm8_57","close-button":"_close-button_1ngm8_76",hideable:"_hideable_1ngm8_92","no-padding":"_no-padding_1ngm8_95",body:"_body_1ngm8_111",footer:"_footer_1ngm8_118"};var t0=n(99279);function t1(e,t){var n=Object.create(null);return e&&o.Children.map(e,function(e){return e}).forEach(function(e){n[e.key]=t&&(0,o.isValidElement)(e)?t(e):e}),n}function t2(e,t,n){return null!=n[t]?n[t]:e.props[t]}var t4=Object.values||function(e){return Object.keys(e).map(function(t){return e[t]})},t8=function(e){function t(t,n){var i,r=(i=e.call(this,t,n)||this).handleExited.bind(function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(i));return i.state={contextValue:{isMounting:!0},handleExited:r,firstRender:!0},i}tF(t,e);var n=t.prototype;return n.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},n.componentWillUnmount=function(){this.mounted=!1},t.getDerivedStateFromProps=function(e,t){var n,i,r=t.children,s=t.handleExited;return{children:t.firstRender?t1(e.children,function(t){return(0,o.cloneElement)(t,{onExited:s.bind(null,t),in:!0,appear:t2(t,"appear",e),enter:t2(t,"enter",e),exit:t2(t,"exit",e)})}):(Object.keys(i=function(e,t){function n(n){return n in t?t[n]:e[n]}e=e||{},t=t||{};var i=Object.create(null),r=[];for(var o in e)o in t?r.length&&(i[o]=r,r=[]):r.push(o);var s,a={};for(var l in t){if(i[l])for(s=0;s<i[l].length;s++){var c=i[l][s];a[i[l][s]]=n(c)}a[l]=n(l)}for(s=0;s<r.length;s++)a[r[s]]=n(r[s]);return a}(r,n=t1(e.children))).forEach(function(t){var a=i[t];if((0,o.isValidElement)(a)){var l=t in r,c=t in n,u=r[t],d=(0,o.isValidElement)(u)&&!u.props.in;c&&(!l||d)?i[t]=(0,o.cloneElement)(a,{onExited:s.bind(null,a),in:!0,exit:t2(a,"exit",e),enter:t2(a,"enter",e)}):c||!l||d?c&&l&&(0,o.isValidElement)(u)&&(i[t]=(0,o.cloneElement)(a,{onExited:s.bind(null,a),in:u.props.in,exit:t2(a,"exit",e),enter:t2(a,"enter",e)})):i[t]=(0,o.cloneElement)(a,{in:!1})}}),i),firstRender:!1}},n.handleExited=function(e,t){var n=t1(this.props.children);e.key in n||(e.props.onExited&&e.props.onExited(t),this.mounted&&this.setState(function(t){var n=tP({},t.children);return delete n[e.key],{children:n}}))},n.render=function(){var e=this.props,t=e.component,n=e.childFactory,i=tD(e,["component","childFactory"]),r=this.state.contextValue,s=t4(this.state.children).map(n);return delete i.appear,delete i.enter,delete i.exit,null===t?o.createElement(tj.Provider,{value:r},s):o.createElement(tj.Provider,{value:r},o.createElement(t,i,s))},t}(o.Component);t8.propTypes={},t8.defaultProps={component:"div",childFactory:function(e){return e}};let t3=(0,o.createContext)({handleHide:()=>null,size:"medium"}),t6=Object.assign(({ariaLabel:e,ariaLabelledBy:t,children:n,className:s,isCentered:a=!1,isClosableOnCloseButtonClick:l=!0,isClosableOnEscapeDown:c=!0,isClosableOnOverlayClick:u=!0,isFullScreen:d=!0,noPadding:h=!1,onHidden:g,onHide:f,overlayClassName:p,show:m,size:b="medium",testSelector:y="modal-test-selector",...v})=>{let w=(0,o.useRef)(null),_=(0,o.useRef)(null),S=(0,o.useRef)(null),[C,M]=(0,o.useReducer)((e,t)=>t,!1);(0,o.useEffect)(()=>{M(!0)},[]),tO(w,{childrenElementRef:_,isEnabled:d&&m},C);let R=(0,o.useCallback)(()=>{m&&f&&f()},[m,f]),E=(0,o.useCallback)(e=>{var t;if(!u||e.target instanceof Node&&null!=(t=_.current)&&t.contains(e.target)){S.current=null;return}(to||S.current===e.target)&&(S.current=null,R())},[R,u]);if(tk(R,{isEnabled:c}),typeof document>"u"||!document)return(0,i.jsx)("div",{});let O=(0,i.jsx)(t8,{children:C&&m&&(0,i.jsx)(tQ,{onExited:g,children:(0,i.jsx)("div",{"aria-label":e,"aria-labelledby":t,className:(0,r.c)(tZ.overlay,{[tZ.centered]:a,[tZ.fullScreen]:d},p),id:"modal-overlay",ref:w,role:"dialog",suppressHydrationWarning:!0,...to?{onTouchStart:E}:{onClick:E,onMouseDown:e=>{S.current=e.target}},children:(0,i.jsx)("div",{className:(0,r.c)(tZ.modal,tZ[b],s,{[tZ.hideable]:!!f,[tZ.noPadding]:h}),"data-test-selector":y,ref:_,...v,children:(0,i.jsxs)(t3.Provider,{value:{handleHide:R,size:b},children:[l&&(0,i.jsx)(tL,{ariaLabel:"close",className:tZ.closeButton,onClick:R,testSelector:`${y}-close-button`}),n]})})})})});return d?(0,ts.createPortal)(O,document.getElementById("main-wrapper")||document.getElementsByClassName("main-wrapper")[0]):O},{Body:({children:e,className:t,id:n,testSelector:o})=>(0,i.jsx)("div",{className:(0,r.c)(tZ.body,t),"data-test-selector":o,id:n,children:e}),CancelButton:({children:e,disabled:t=!1,onClick:n,testSelector:r,variant:s="secondary"})=>{let{handleHide:a}=(0,o.useContext)(t3);return(0,i.jsx)(tx.z,{color:"blue",disabled:t,onClick:n||a,size:"medium",testSelector:r,type:"button",variant:s,children:e})},Footer:({children:e,className:t})=>(0,i.jsx)("div",{className:(0,r.c)(tZ.footer,t),children:e}),Header:({children:e,className:t,testSelector:n})=>{let{size:s}=(0,o.useContext)(t3);return(0,i.jsx)("div",{className:(0,r.c)(tZ.header,t),"data-test-selector":n,children:(0,i.jsx)(t0.X,{className:(0,r.c)(tZ.title,tZ[s]),level:1,children:e})})},SubmitButton:({children:e,component:t=tx.z,loading:n=!1,...r})=>(0,i.jsx)(t,{color:"blue",loading:n,size:"medium",...r,children:e})})},60176:function(e,t,n){/**
 * react-table
 *
 * Copyright (c) TanStack
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */!function(e,t){"use strict";var n=function(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(n){if("default"!==n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}}),t.default=e,Object.freeze(t)}(t);/**
   * table-core
   *
   * Copyright (c) TanStack
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   */function i(e,t){return"function"==typeof e?e(t):e}function r(e,t){return n=>{t.setState(t=>({...t,[e]:i(n,t[e])}))}}function o(e){return e instanceof Function}function s(e,t){let n=[],i=e=>{e.forEach(e=>{n.push(e);let r=t(e);null!=r&&r.length&&i(r)})};return i(e),n}function a(e,t,n){let i,r=[];return()=>{let o,s;n.key&&n.debug&&(o=Date.now());let a=e();if(!(a.length!==r.length||a.some((e,t)=>r[t]!==e)))return i;if(r=a,n.key&&n.debug&&(s=Date.now()),i=t(...a),null==n||null==n.onChange||n.onChange(i),n.key&&n.debug&&null!=n&&n.debug()){let e=Math.round(100*(Date.now()-o))/100,t=Math.round(100*(Date.now()-s))/100,i=t/16,r=(e,t)=>{for(e=String(e);e.length<t;)e=" "+e;return e};console.info(`%c⏱ ${r(t,5)} /${r(e,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*i,120))}deg 100% 31%);`,null==n?void 0:n.key)}return i}}function l(e,t,n,i){let r={...e._getDefaultColumnDef(),...t},o=r.accessorKey,s,l=r.id??(o?o.replace(".","_"):void 0)??("string"==typeof r.header?r.header:void 0);if(r.accessorFn?s=r.accessorFn:o&&(s=o.includes(".")?e=>{let t=e;for(let e of o.split("."))t=t[e];return t}:e=>e[r.accessorKey]),!l)throw Error();let c={id:`${String(l)}`,accessorFn:s,parent:i,depth:n,columnDef:r,columns:[],getFlatColumns:a(()=>[!0],()=>{var e;return[c,...null==(e=c.columns)?void 0:e.flatMap(e=>e.getFlatColumns())]},{key:"column.getFlatColumns",debug:()=>e.options.debugAll??e.options.debugColumns}),getLeafColumns:a(()=>[e._getOrderColumnsFn()],e=>{var t;return null!=(t=c.columns)&&t.length?e(c.columns.flatMap(e=>e.getLeafColumns())):[c]},{key:"column.getLeafColumns",debug:()=>e.options.debugAll??e.options.debugColumns})};return c=e._features.reduce((t,n)=>Object.assign(t,null==n.createColumn?void 0:n.createColumn(c,e)),c)}function c(e,t,n){let i={id:n.id??t.id,column:t,index:n.index,isPlaceholder:!!n.isPlaceholder,placeholderId:n.placeholderId,depth:n.depth,subHeaders:[],colSpan:0,rowSpan:0,headerGroup:null,getLeafHeaders:()=>{let e=[],t=n=>{n.subHeaders&&n.subHeaders.length&&n.subHeaders.map(t),e.push(n)};return t(i),e},getContext:()=>({table:e,header:i,column:t})};return e._features.forEach(t=>{Object.assign(i,null==t.createHeader?void 0:t.createHeader(i,e))}),i}let u={createTable:e=>({getHeaderGroups:a(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(t,n,i,r)=>{let o=(null==i?void 0:i.map(e=>n.find(t=>t.id===e)).filter(Boolean))??[],s=(null==r?void 0:r.map(e=>n.find(t=>t.id===e)).filter(Boolean))??[];return d(t,[...o,...n.filter(e=>!(null!=i&&i.includes(e.id)||null!=r&&r.includes(e.id))),...s],e)},{key:!1,debug:()=>e.options.debugAll??e.options.debugHeaders}),getCenterHeaderGroups:a(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(t,n,i,r)=>d(t,n=n.filter(e=>!(null!=i&&i.includes(e.id)||null!=r&&r.includes(e.id))),e,"center"),{key:!1,debug:()=>e.options.debugAll??e.options.debugHeaders}),getLeftHeaderGroups:a(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left],(t,n,i)=>d(t,(null==i?void 0:i.map(e=>n.find(t=>t.id===e)).filter(Boolean))??[],e,"left"),{key:!1,debug:()=>e.options.debugAll??e.options.debugHeaders}),getRightHeaderGroups:a(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.right],(t,n,i)=>d(t,(null==i?void 0:i.map(e=>n.find(t=>t.id===e)).filter(Boolean))??[],e,"right"),{key:!1,debug:()=>e.options.debugAll??e.options.debugHeaders}),getFooterGroups:a(()=>[e.getHeaderGroups()],e=>[...e].reverse(),{key:!1,debug:()=>e.options.debugAll??e.options.debugHeaders}),getLeftFooterGroups:a(()=>[e.getLeftHeaderGroups()],e=>[...e].reverse(),{key:!1,debug:()=>e.options.debugAll??e.options.debugHeaders}),getCenterFooterGroups:a(()=>[e.getCenterHeaderGroups()],e=>[...e].reverse(),{key:!1,debug:()=>e.options.debugAll??e.options.debugHeaders}),getRightFooterGroups:a(()=>[e.getRightHeaderGroups()],e=>[...e].reverse(),{key:!1,debug:()=>e.options.debugAll??e.options.debugHeaders}),getFlatHeaders:a(()=>[e.getHeaderGroups()],e=>e.map(e=>e.headers).flat(),{key:!1,debug:()=>e.options.debugAll??e.options.debugHeaders}),getLeftFlatHeaders:a(()=>[e.getLeftHeaderGroups()],e=>e.map(e=>e.headers).flat(),{key:!1,debug:()=>e.options.debugAll??e.options.debugHeaders}),getCenterFlatHeaders:a(()=>[e.getCenterHeaderGroups()],e=>e.map(e=>e.headers).flat(),{key:!1,debug:()=>e.options.debugAll??e.options.debugHeaders}),getRightFlatHeaders:a(()=>[e.getRightHeaderGroups()],e=>e.map(e=>e.headers).flat(),{key:!1,debug:()=>e.options.debugAll??e.options.debugHeaders}),getCenterLeafHeaders:a(()=>[e.getCenterFlatHeaders()],e=>e.filter(e=>{var t;return!(null!=(t=e.subHeaders)&&t.length)}),{key:!1,debug:()=>e.options.debugAll??e.options.debugHeaders}),getLeftLeafHeaders:a(()=>[e.getLeftFlatHeaders()],e=>e.filter(e=>{var t;return!(null!=(t=e.subHeaders)&&t.length)}),{key:!1,debug:()=>e.options.debugAll??e.options.debugHeaders}),getRightLeafHeaders:a(()=>[e.getRightFlatHeaders()],e=>e.filter(e=>{var t;return!(null!=(t=e.subHeaders)&&t.length)}),{key:!1,debug:()=>e.options.debugAll??e.options.debugHeaders}),getLeafHeaders:a(()=>[e.getLeftHeaderGroups(),e.getCenterHeaderGroups(),e.getRightHeaderGroups()],(e,t,n)=>{var i,r,o;return[...(null==(i=e[0])?void 0:i.headers)??[],...(null==(r=t[0])?void 0:r.headers)??[],...(null==(o=n[0])?void 0:o.headers)??[]].map(e=>e.getLeafHeaders()).flat()},{key:!1,debug:()=>e.options.debugAll??e.options.debugHeaders})})};function d(e,t,n,i){var r;let o=0,s=function(e,t){void 0===t&&(t=1),o=Math.max(o,t),e.filter(e=>e.getIsVisible()).forEach(e=>{var n;null!=(n=e.columns)&&n.length&&s(e.columns,t+1)},0)};s(e);let a=[],l=(e,t)=>{let r={depth:t,id:[i,`${t}`].filter(Boolean).join("_"),headers:[]},o=[];e.forEach(e=>{let s=[...o].reverse()[0],a,l=!1;if(e.column.depth===r.depth&&e.column.parent?a=e.column.parent:(a=e.column,l=!0),s&&(null==s?void 0:s.column)===a)s.subHeaders.push(e);else{let r=c(n,a,{id:[i,t,a.id,null==e?void 0:e.id].filter(Boolean).join("_"),isPlaceholder:l,placeholderId:l?`${o.filter(e=>e.column===a).length}`:void 0,depth:t,index:o.length});r.subHeaders.push(e),o.push(r)}r.headers.push(e),e.headerGroup=r}),a.push(r),t>0&&l(o,t-1)},u=t.map((e,t)=>c(n,e,{depth:o,index:t}));l(u,o-1),a.reverse();let d=e=>e.filter(e=>e.column.getIsVisible()).map(e=>{let t=0,n=0,i=[0];return e.subHeaders&&e.subHeaders.length?(i=[],d(e.subHeaders).forEach(e=>{let{colSpan:n,rowSpan:r}=e;t+=n,i.push(r)})):t=1,n+=Math.min(...i),e.colSpan=t,e.rowSpan=n,{colSpan:t,rowSpan:n}});return d((null==(r=a[0])?void 0:r.headers)??[]),a}let h={size:150,minSize:20,maxSize:Number.MAX_SAFE_INTEGER},g={getDefaultColumnDef:()=>h,getInitialState:e=>({columnSizing:{},columnSizingInfo:{startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,isResizingColumn:!1,columnSizingStart:[]},...e}),getDefaultOptions:e=>({columnResizeMode:"onEnd",onColumnSizingChange:r("columnSizing",e),onColumnSizingInfoChange:r("columnSizingInfo",e)}),createColumn:(e,t)=>({getSize:()=>{let n=t.getState().columnSizing[e.id];return Math.min(Math.max(e.columnDef.minSize??h.minSize,n??e.columnDef.size??h.size),e.columnDef.maxSize??h.maxSize)},getStart:n=>{let i=n?"left"===n?t.getLeftVisibleLeafColumns():t.getRightVisibleLeafColumns():t.getVisibleLeafColumns(),r=i.findIndex(t=>t.id===e.id);if(r>0){let e=i[r-1];return e.getStart(n)+e.getSize()}return 0},resetSize:()=>{t.setColumnSizing(t=>{let{[e.id]:n,...i}=t;return i})},getCanResize:()=>(e.columnDef.enableResizing??!0)&&(t.options.enableColumnResizing??!0),getIsResizing:()=>t.getState().columnSizingInfo.isResizingColumn===e.id}),createHeader:(e,t)=>({getSize:()=>{let t=0,n=e=>{e.subHeaders.length?e.subHeaders.forEach(n):t+=e.column.getSize()??0};return n(e),t},getStart:()=>{if(e.index>0){let t=e.headerGroup.headers[e.index-1];return t.getStart()+t.getSize()}return 0},getResizeHandler:()=>{let n=t.getColumn(e.column.id),i=n.getCanResize();return r=>{if(!i||(null==r.persist||r.persist(),m(r)&&r.touches&&r.touches.length>1))return;let o=e.getSize(),s=e?e.getLeafHeaders().map(e=>[e.column.id,e.column.getSize()]):[[n.id,n.getSize()]],a=m(r)?Math.round(r.touches[0].clientX):r.clientX,l=(e,n)=>{if("number"!=typeof n)return;let i={};t.setColumnSizingInfo(e=>{let t=n-((null==e?void 0:e.startOffset)??0),r=Math.max(t/((null==e?void 0:e.startSize)??0),-.999999);return e.columnSizingStart.forEach(e=>{let[t,n]=e;i[t]=Math.round(100*Math.max(n+n*r,0))/100}),{...e,deltaOffset:t,deltaPercentage:r}}),"onChange"!==t.options.columnResizeMode&&"end"!==e||t.setColumnSizing(e=>({...e,...i}))},c=e=>l("move",e),u=e=>{l("end",e),t.setColumnSizingInfo(e=>({...e,isResizingColumn:!1,startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,columnSizingStart:[]}))},d={moveHandler:e=>c(e.clientX),upHandler:e=>{document.removeEventListener("mousemove",d.moveHandler),document.removeEventListener("mouseup",d.upHandler),u(e.clientX)}},h={moveHandler:e=>(e.cancelable&&(e.preventDefault(),e.stopPropagation()),c(e.touches[0].clientX),!1),upHandler:e=>{var t;document.removeEventListener("touchmove",h.moveHandler),document.removeEventListener("touchend",h.upHandler),e.cancelable&&(e.preventDefault(),e.stopPropagation()),u(null==(t=e.touches[0])?void 0:t.clientX)}},g=!!p()&&{passive:!1};m(r)?(document.addEventListener("touchmove",h.moveHandler,g),document.addEventListener("touchend",h.upHandler,g)):(document.addEventListener("mousemove",d.moveHandler,g),document.addEventListener("mouseup",d.upHandler,g)),t.setColumnSizingInfo(e=>({...e,startOffset:a,startSize:o,deltaOffset:0,deltaPercentage:0,columnSizingStart:s,isResizingColumn:n.id}))}}}),createTable:e=>({setColumnSizing:t=>null==e.options.onColumnSizingChange?void 0:e.options.onColumnSizingChange(t),setColumnSizingInfo:t=>null==e.options.onColumnSizingInfoChange?void 0:e.options.onColumnSizingInfoChange(t),resetColumnSizing:t=>{e.setColumnSizing(t?{}:e.initialState.columnSizing??{})},resetHeaderSizeInfo:t=>{e.setColumnSizingInfo(t?{startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,isResizingColumn:!1,columnSizingStart:[]}:e.initialState.columnSizingInfo??{startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,isResizingColumn:!1,columnSizingStart:[]})},getTotalSize:()=>{var t;return(null==(t=e.getHeaderGroups()[0])?void 0:t.headers.reduce((e,t)=>e+t.getSize(),0))??0},getLeftTotalSize:()=>{var t;return(null==(t=e.getLeftHeaderGroups()[0])?void 0:t.headers.reduce((e,t)=>e+t.getSize(),0))??0},getCenterTotalSize:()=>{var t;return(null==(t=e.getCenterHeaderGroups()[0])?void 0:t.headers.reduce((e,t)=>e+t.getSize(),0))??0},getRightTotalSize:()=>{var t;return(null==(t=e.getRightHeaderGroups()[0])?void 0:t.headers.reduce((e,t)=>e+t.getSize(),0))??0}})},f=null;function p(){if("boolean"==typeof f)return f;let e=!1;try{let t=()=>{};window.addEventListener("test",t,{get passive(){return e=!0,!1}}),window.removeEventListener("test",t)}catch(t){e=!1}return f=e}function m(e){return"touchstart"===e.type}let b={getInitialState:e=>({expanded:{},...e}),getDefaultOptions:e=>({onExpandedChange:r("expanded",e),paginateExpandedRows:!0}),createTable:e=>{let t=!1,n=!1;return{_autoResetExpanded:()=>{t?(e.options.autoResetAll??e.options.autoResetExpanded??!e.options.manualExpanding)&&!n&&(n=!0,e._queue(()=>{e.resetExpanded(),n=!1})):e._queue(()=>{t=!0})},setExpanded:t=>null==e.options.onExpandedChange?void 0:e.options.onExpandedChange(t),toggleAllRowsExpanded:t=>{t??!e.getIsAllRowsExpanded()?e.setExpanded(!0):e.setExpanded({})},resetExpanded:t=>{var n;e.setExpanded(t?{}:(null==(n=e.initialState)?void 0:n.expanded)??{})},getCanSomeRowsExpand:()=>e.getRowModel().flatRows.some(e=>e.getCanExpand()),getToggleAllRowsExpandedHandler:()=>t=>{null==t.persist||t.persist(),e.toggleAllRowsExpanded()},getIsSomeRowsExpanded:()=>{let t=e.getState().expanded;return!0===t||Object.values(t).some(Boolean)},getIsAllRowsExpanded:()=>{let t=e.getState().expanded;return"boolean"==typeof t?!0===t:!!Object.keys(t).length&&!e.getRowModel().flatRows.some(e=>!e.getIsExpanded())},getExpandedDepth:()=>{let t=0;return(!0===e.getState().expanded?Object.keys(e.getRowModel().rowsById):Object.keys(e.getState().expanded)).forEach(e=>{let n=e.split(".");t=Math.max(t,n.length)}),t},getPreExpandedRowModel:()=>e.getSortedRowModel(),getExpandedRowModel:()=>(!e._getExpandedRowModel&&e.options.getExpandedRowModel&&(e._getExpandedRowModel=e.options.getExpandedRowModel(e)),e.options.manualExpanding||!e._getExpandedRowModel?e.getPreExpandedRowModel():e._getExpandedRowModel())}},createRow:(e,t)=>({toggleExpanded:n=>{t.setExpanded(i=>{let r=!0===i||!(null==i||!i[e.id]),o={};if(!0===i?Object.keys(t.getRowModel().rowsById).forEach(e=>{o[e]=!0}):o=i,n=n??!r,!r&&n)return{...o,[e.id]:!0};if(r&&!n){let{[e.id]:t,...n}=o;return n}return i})},getIsExpanded:()=>{let n=t.getState().expanded;return!!((null==t.options.getIsRowExpanded?void 0:t.options.getIsRowExpanded(e))??(!0===n||null!=n&&n[e.id]))},getCanExpand:()=>{var n;return(null==t.options.getRowCanExpand?void 0:t.options.getRowCanExpand(e))??((t.options.enableExpanding??!0)&&!(null==(n=e.subRows)||!n.length))},getToggleExpandedHandler:()=>{let t=e.getCanExpand();return()=>{t&&e.toggleExpanded()}}})},y=(e,t,n)=>{var i;let r=n.toLowerCase();return!!(null==(i=e.getValue(t))?void 0:i.toLowerCase().includes(r))};y.autoRemove=e=>k(e);let v=(e,t,n)=>{var i;return!!(null==(i=e.getValue(t))?void 0:i.includes(n))};v.autoRemove=e=>k(e);let w=(e,t,n)=>{var i;return(null==(i=e.getValue(t))?void 0:i.toLowerCase())===n.toLowerCase()};w.autoRemove=e=>k(e);let _=(e,t,n)=>{var i;return null==(i=e.getValue(t))?void 0:i.includes(n)};_.autoRemove=e=>k(e)||!(null!=e&&e.length);let S=(e,t,n)=>!n.some(n=>{var i;return!(null!=(i=e.getValue(t))&&i.includes(n))});S.autoRemove=e=>k(e)||!(null!=e&&e.length);let C=(e,t,n)=>n.some(n=>{var i;return null==(i=e.getValue(t))?void 0:i.includes(n)});C.autoRemove=e=>k(e)||!(null!=e&&e.length);let M=(e,t,n)=>e.getValue(t)===n;M.autoRemove=e=>k(e);let R=(e,t,n)=>e.getValue(t)==n;R.autoRemove=e=>k(e);let E=(e,t,n)=>{let[i,r]=n,o=e.getValue(t);return o>=i&&o<=r};E.resolveFilterValue=e=>{let[t,n]=e,i="number"!=typeof t?parseFloat(t):t,r="number"!=typeof n?parseFloat(n):n,o=null===t||Number.isNaN(i)?-1/0:i,s=null===n||Number.isNaN(r)?1/0:r;if(o>s){let e=o;o=s,s=e}return[o,s]},E.autoRemove=e=>k(e)||k(e[0])&&k(e[1]);let O={includesString:y,includesStringSensitive:v,equalsString:w,arrIncludes:_,arrIncludesAll:S,arrIncludesSome:C,equals:M,weakEquals:R,inNumberRange:E};function k(e){return null==e||""===e}let x={getDefaultColumnDef:()=>({filterFn:"auto"}),getInitialState:e=>({columnFilters:[],globalFilter:void 0,...e}),getDefaultOptions:e=>({onColumnFiltersChange:r("columnFilters",e),onGlobalFilterChange:r("globalFilter",e),filterFromLeafRows:!1,globalFilterFn:"auto",getColumnCanGlobalFilter:t=>{var n,i;let r=null==(n=e.getCoreRowModel().flatRows[0])||null==(i=n._getAllCellsByColumnId()[t.id])?void 0:i.getValue();return"string"==typeof r||"number"==typeof r}}),createColumn:(e,t)=>({getAutoFilterFn:()=>{let n=t.getCoreRowModel().flatRows[0],i=null==n?void 0:n.getValue(e.id);return"string"==typeof i?O.includesString:"number"==typeof i?O.inNumberRange:"boolean"==typeof i||null!==i&&"object"==typeof i?O.equals:Array.isArray(i)?O.arrIncludes:O.weakEquals},getFilterFn:()=>{var n;return o(e.columnDef.filterFn)?e.columnDef.filterFn:"auto"===e.columnDef.filterFn?e.getAutoFilterFn():(null==(n=t.options.filterFns)?void 0:n[e.columnDef.filterFn])??O[e.columnDef.filterFn]},getCanFilter:()=>(e.columnDef.enableColumnFilter??!0)&&(t.options.enableColumnFilters??!0)&&(t.options.enableFilters??!0)&&!!e.accessorFn,getCanGlobalFilter:()=>(e.columnDef.enableGlobalFilter??!0)&&(t.options.enableGlobalFilter??!0)&&(t.options.enableFilters??!0)&&((null==t.options.getColumnCanGlobalFilter?void 0:t.options.getColumnCanGlobalFilter(e))??!0)&&!!e.accessorFn,getIsFiltered:()=>e.getFilterIndex()>-1,getFilterValue:()=>{var n,i;return null==(n=t.getState().columnFilters)||null==(i=n.find(t=>t.id===e.id))?void 0:i.value},getFilterIndex:()=>{var n;return(null==(n=t.getState().columnFilters)?void 0:n.findIndex(t=>t.id===e.id))??-1},setFilterValue:n=>{t.setColumnFilters(t=>{let r=e.getFilterFn(),o=null==t?void 0:t.find(t=>t.id===e.id),s=i(n,o?o.value:void 0);if(A(r,s,e))return(null==t?void 0:t.filter(t=>t.id!==e.id))??[];let a={id:e.id,value:s};return o?(null==t?void 0:t.map(t=>t.id===e.id?a:t))??[]:null!=t&&t.length?[...t,a]:[a]})},_getFacetedRowModel:t.options.getFacetedRowModel&&t.options.getFacetedRowModel(t,e.id),getFacetedRowModel:()=>e._getFacetedRowModel?e._getFacetedRowModel():t.getPreFilteredRowModel(),_getFacetedUniqueValues:t.options.getFacetedUniqueValues&&t.options.getFacetedUniqueValues(t,e.id),getFacetedUniqueValues:()=>e._getFacetedUniqueValues?e._getFacetedUniqueValues():new Map,_getFacetedMinMaxValues:t.options.getFacetedMinMaxValues&&t.options.getFacetedMinMaxValues(t,e.id),getFacetedMinMaxValues:()=>{if(e._getFacetedMinMaxValues)return e._getFacetedMinMaxValues()}}),createRow:(e,t)=>({columnFilters:{},columnFiltersMeta:{}}),createTable:e=>({getGlobalAutoFilterFn:()=>O.includesString,getGlobalFilterFn:()=>{var t;let{globalFilterFn:n}=e.options;return o(n)?n:"auto"===n?e.getGlobalAutoFilterFn():(null==(t=e.options.filterFns)?void 0:t[n])??O[n]},setColumnFilters:t=>{let n=e.getAllLeafColumns();null==e.options.onColumnFiltersChange||e.options.onColumnFiltersChange(e=>{var r;return null==(r=i(t,e))?void 0:r.filter(e=>{let t=n.find(t=>t.id===e.id);return!(t&&A(t.getFilterFn(),e.value,t))})})},setGlobalFilter:t=>{null==e.options.onGlobalFilterChange||e.options.onGlobalFilterChange(t)},resetGlobalFilter:t=>{e.setGlobalFilter(t?void 0:e.initialState.globalFilter)},resetColumnFilters:t=>{var n;e.setColumnFilters(t?[]:(null==(n=e.initialState)?void 0:n.columnFilters)??[])},getPreFilteredRowModel:()=>e.getCoreRowModel(),getFilteredRowModel:()=>(!e._getFilteredRowModel&&e.options.getFilteredRowModel&&(e._getFilteredRowModel=e.options.getFilteredRowModel(e)),e.options.manualFiltering||!e._getFilteredRowModel?e.getPreFilteredRowModel():e._getFilteredRowModel()),_getGlobalFacetedRowModel:e.options.getFacetedRowModel&&e.options.getFacetedRowModel(e,"__global__"),getGlobalFacetedRowModel:()=>e.options.manualFiltering||!e._getGlobalFacetedRowModel?e.getPreFilteredRowModel():e._getGlobalFacetedRowModel(),_getGlobalFacetedUniqueValues:e.options.getFacetedUniqueValues&&e.options.getFacetedUniqueValues(e,"__global__"),getGlobalFacetedUniqueValues:()=>e._getGlobalFacetedUniqueValues?e._getGlobalFacetedUniqueValues():new Map,_getGlobalFacetedMinMaxValues:e.options.getFacetedMinMaxValues&&e.options.getFacetedMinMaxValues(e,"__global__"),getGlobalFacetedMinMaxValues:()=>{if(e._getGlobalFacetedMinMaxValues)return e._getGlobalFacetedMinMaxValues()}})};function A(e,t,n){return!(!e||!e.autoRemove)&&e.autoRemove(t,n)||void 0===t||"string"==typeof t&&!t}let T={sum:(e,t,n)=>n.reduce((t,n)=>{let i=n.getValue(e);return t+("number"==typeof i?i:0)},0),min:(e,t,n)=>{let i;return n.forEach(t=>{let n=t.getValue(e);null!=n&&(i>n||void 0===i&&n>=n)&&(i=n)}),i},max:(e,t,n)=>{let i;return n.forEach(t=>{let n=t.getValue(e);null!=n&&(i<n||void 0===i&&n>=n)&&(i=n)}),i},extent:(e,t,n)=>{let i,r;return n.forEach(t=>{let n=t.getValue(e);null!=n&&(void 0===i?n>=n&&(i=r=n):(i>n&&(i=n),r<n&&(r=n)))}),[i,r]},mean:(e,t)=>{let n=0,i=0;if(t.forEach(t=>{let r=t.getValue(e);null!=r&&(r=+r)>=r&&(++n,i+=r)}),n)return i/n},median:(e,t)=>{if(!t.length)return;let n=0,i=0;return t.forEach(t=>{let r=t.getValue(e);"number"==typeof r&&(n=Math.min(n,r),i=Math.max(i,r))}),(n+i)/2},unique:(e,t)=>Array.from(new Set(t.map(t=>t.getValue(e))).values()),uniqueCount:(e,t)=>new Set(t.map(t=>t.getValue(e))).size,count:(e,t)=>t.length},L={getDefaultColumnDef:()=>({aggregatedCell:e=>{var t;return(null==(t=e.getValue())||null==t.toString?void 0:t.toString())??null},aggregationFn:"auto"}),getInitialState:e=>({grouping:[],...e}),getDefaultOptions:e=>({onGroupingChange:r("grouping",e),groupedColumnMode:"reorder"}),createColumn:(e,t)=>({toggleGrouping:()=>{t.setGrouping(t=>null!=t&&t.includes(e.id)?t.filter(t=>t!==e.id):[...t??[],e.id])},getCanGroup:()=>e.columnDef.enableGrouping??!0??t.options.enableGrouping??!0??!!e.accessorFn,getIsGrouped:()=>{var n;return null==(n=t.getState().grouping)?void 0:n.includes(e.id)},getGroupedIndex:()=>{var n;return null==(n=t.getState().grouping)?void 0:n.indexOf(e.id)},getToggleGroupingHandler:()=>{let t=e.getCanGroup();return()=>{t&&e.toggleGrouping()}},getAutoAggregationFn:()=>{let n=t.getCoreRowModel().flatRows[0],i=null==n?void 0:n.getValue(e.id);return"number"==typeof i?T.sum:"[object Date]"===Object.prototype.toString.call(i)?T.extent:void 0},getAggregationFn:()=>{var n;if(!e)throw Error();return o(e.columnDef.aggregationFn)?e.columnDef.aggregationFn:"auto"===e.columnDef.aggregationFn?e.getAutoAggregationFn():(null==(n=t.options.aggregationFns)?void 0:n[e.columnDef.aggregationFn])??T[e.columnDef.aggregationFn]}}),createTable:e=>({setGrouping:t=>null==e.options.onGroupingChange?void 0:e.options.onGroupingChange(t),resetGrouping:t=>{var n;e.setGrouping(t?[]:(null==(n=e.initialState)?void 0:n.grouping)??[])},getPreGroupedRowModel:()=>e.getFilteredRowModel(),getGroupedRowModel:()=>(!e._getGroupedRowModel&&e.options.getGroupedRowModel&&(e._getGroupedRowModel=e.options.getGroupedRowModel(e)),e.options.manualGrouping||!e._getGroupedRowModel?e.getPreGroupedRowModel():e._getGroupedRowModel())}),createRow:e=>({getIsGrouped:()=>!!e.groupingColumnId,_groupingValuesCache:{}}),createCell:(e,t,n,i)=>({getIsGrouped:()=>t.getIsGrouped()&&t.id===n.groupingColumnId,getIsPlaceholder:()=>!e.getIsGrouped()&&t.getIsGrouped(),getIsAggregated:()=>{var t;return!e.getIsGrouped()&&!e.getIsPlaceholder()&&!(null==(t=n.subRows)||!t.length)}})};function I(e,t,n){if(null==t||!t.length||!n)return e;let i=e.filter(e=>!t.includes(e.id));return"remove"===n?i:[...t.map(t=>e.find(e=>e.id===t)).filter(Boolean),...i]}let P={getInitialState:e=>({columnOrder:[],...e}),getDefaultOptions:e=>({onColumnOrderChange:r("columnOrder",e)}),createTable:e=>({setColumnOrder:t=>null==e.options.onColumnOrderChange?void 0:e.options.onColumnOrderChange(t),resetColumnOrder:t=>{e.setColumnOrder(t?[]:e.initialState.columnOrder??[])},_getOrderColumnsFn:a(()=>[e.getState().columnOrder,e.getState().grouping,e.options.groupedColumnMode],(e,t,n)=>i=>{let r=[];if(null!=e&&e.length){let t=[...e],n=[...i];for(;n.length&&t.length;){let e=t.shift(),i=n.findIndex(t=>t.id===e);i>-1&&r.push(n.splice(i,1)[0])}r=[...r,...n]}else r=i;return I(r,t,n)},{key:!1})})},D={getInitialState:e=>({...e,pagination:{pageIndex:0,pageSize:10,...null==e?void 0:e.pagination}}),getDefaultOptions:e=>({onPaginationChange:r("pagination",e)}),createTable:e=>{let t=!1,n=!1;return{_autoResetPageIndex:()=>{t?(e.options.autoResetAll??e.options.autoResetPageIndex??!e.options.manualPagination)&&!n&&(n=!0,e._queue(()=>{e.resetPageIndex(),n=!1})):e._queue(()=>{t=!0})},setPagination:t=>null==e.options.onPaginationChange?void 0:e.options.onPaginationChange(e=>i(t,e)),resetPagination:t=>{e.setPagination(t?{pageIndex:0,pageSize:10}:e.initialState.pagination??{pageIndex:0,pageSize:10})},setPageIndex:t=>{e.setPagination(n=>{let r=i(t,n.pageIndex),o=void 0===e.options.pageCount||-1===e.options.pageCount?Number.MAX_SAFE_INTEGER:e.options.pageCount-1;return r=Math.max(0,Math.min(r,o)),{...n,pageIndex:r}})},resetPageIndex:t=>{var n,i;e.setPageIndex(t?0:(null==(n=e.initialState)||null==(i=n.pagination)?void 0:i.pageIndex)??0)},resetPageSize:t=>{var n,i;e.setPageSize(t?10:(null==(n=e.initialState)||null==(i=n.pagination)?void 0:i.pageSize)??10)},setPageSize:t=>{e.setPagination(e=>{let n=Math.max(1,i(t,e.pageSize)),r=e.pageSize*e.pageIndex;return{...e,pageIndex:Math.floor(r/n),pageSize:n}})},setPageCount:t=>e.setPagination(n=>{let r=i(t,e.options.pageCount??-1);return"number"==typeof r&&(r=Math.max(-1,r)),{...n,pageCount:r}}),getPageOptions:a(()=>[e.getPageCount()],e=>{let t=[];return e&&e>0&&(t=[...Array(e)].fill(null).map((e,t)=>t)),t},{key:!1,debug:()=>e.options.debugAll??e.options.debugTable}),getCanPreviousPage:()=>e.getState().pagination.pageIndex>0,getCanNextPage:()=>{let{pageIndex:t}=e.getState().pagination,n=e.getPageCount();return -1===n||0!==n&&t<n-1},previousPage:()=>e.setPageIndex(e=>e-1),nextPage:()=>e.setPageIndex(e=>e+1),getPrePaginationRowModel:()=>e.getExpandedRowModel(),getPaginationRowModel:()=>(!e._getPaginationRowModel&&e.options.getPaginationRowModel&&(e._getPaginationRowModel=e.options.getPaginationRowModel(e)),e.options.manualPagination||!e._getPaginationRowModel?e.getPrePaginationRowModel():e._getPaginationRowModel()),getPageCount:()=>e.options.pageCount??Math.ceil(e.getPrePaginationRowModel().rows.length/e.getState().pagination.pageSize)}}},N={getInitialState:e=>({columnPinning:{left:[],right:[]},...e}),getDefaultOptions:e=>({onColumnPinningChange:r("columnPinning",e)}),createColumn:(e,t)=>({pin:n=>{let i=e.getLeafColumns().map(e=>e.id).filter(Boolean);t.setColumnPinning(e=>"right"===n?{left:((null==e?void 0:e.left)??[]).filter(e=>!(null!=i&&i.includes(e))),right:[...((null==e?void 0:e.right)??[]).filter(e=>!(null!=i&&i.includes(e))),...i]}:"left"===n?{left:[...((null==e?void 0:e.left)??[]).filter(e=>!(null!=i&&i.includes(e))),...i],right:((null==e?void 0:e.right)??[]).filter(e=>!(null!=i&&i.includes(e)))}:{left:((null==e?void 0:e.left)??[]).filter(e=>!(null!=i&&i.includes(e))),right:((null==e?void 0:e.right)??[]).filter(e=>!(null!=i&&i.includes(e)))})},getCanPin:()=>e.getLeafColumns().some(e=>(e.columnDef.enablePinning??!0)&&(t.options.enablePinning??!0)),getIsPinned:()=>{let n=e.getLeafColumns().map(e=>e.id),{left:i,right:r}=t.getState().columnPinning,o=n.some(e=>null==i?void 0:i.includes(e)),s=n.some(e=>null==r?void 0:r.includes(e));return o?"left":!!s&&"right"},getPinnedIndex:()=>{var n,i;let r=e.getIsPinned();return r?(null==(n=t.getState().columnPinning)||null==(i=n[r])?void 0:i.indexOf(e.id))??-1:0}}),createRow:(e,t)=>({getCenterVisibleCells:a(()=>[e._getAllVisibleCells(),t.getState().columnPinning.left,t.getState().columnPinning.right],(e,t,n)=>{let i=[...t??[],...n??[]];return e.filter(e=>!i.includes(e.column.id))},{key:"row.getCenterVisibleCells",debug:()=>t.options.debugAll??t.options.debugRows}),getLeftVisibleCells:a(()=>[e._getAllVisibleCells(),t.getState().columnPinning.left,,],(e,t)=>(t??[]).map(t=>e.find(e=>e.column.id===t)).filter(Boolean).map(e=>({...e,position:"left"})),{key:"row.getLeftVisibleCells",debug:()=>t.options.debugAll??t.options.debugRows}),getRightVisibleCells:a(()=>[e._getAllVisibleCells(),t.getState().columnPinning.right],(e,t)=>(t??[]).map(t=>e.find(e=>e.column.id===t)).filter(Boolean).map(e=>({...e,position:"right"})),{key:"row.getRightVisibleCells",debug:()=>t.options.debugAll??t.options.debugRows})}),createTable:e=>({setColumnPinning:t=>null==e.options.onColumnPinningChange?void 0:e.options.onColumnPinningChange(t),resetColumnPinning:t=>{var n;return e.setColumnPinning(t?{left:[],right:[]}:(null==(n=e.initialState)?void 0:n.columnPinning)??{left:[],right:[]})},getIsSomeColumnsPinned:t=>{var n,i,r;let o=e.getState().columnPinning;return t?!!(null==(n=o[t])?void 0:n.length):!!((null==(i=o.left)?void 0:i.length)||(null==(r=o.right)?void 0:r.length))},getLeftLeafColumns:a(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left],(e,t)=>(t??[]).map(t=>e.find(e=>e.id===t)).filter(Boolean),{key:!1,debug:()=>e.options.debugAll??e.options.debugColumns}),getRightLeafColumns:a(()=>[e.getAllLeafColumns(),e.getState().columnPinning.right],(e,t)=>(t??[]).map(t=>e.find(e=>e.id===t)).filter(Boolean),{key:!1,debug:()=>e.options.debugAll??e.options.debugColumns}),getCenterLeafColumns:a(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(e,t,n)=>{let i=[...t??[],...n??[]];return e.filter(e=>!i.includes(e.id))},{key:!1,debug:()=>e.options.debugAll??e.options.debugColumns})})},F={getInitialState:e=>({rowSelection:{},...e}),getDefaultOptions:e=>({onRowSelectionChange:r("rowSelection",e),enableRowSelection:!0,enableMultiRowSelection:!0,enableSubRowSelection:!0}),createTable:e=>({setRowSelection:t=>null==e.options.onRowSelectionChange?void 0:e.options.onRowSelectionChange(t),resetRowSelection:t=>e.setRowSelection(t?{}:e.initialState.rowSelection??{}),toggleAllRowsSelected:t=>{e.setRowSelection(n=>{t=void 0!==t?t:!e.getIsAllRowsSelected();let i={...n},r=e.getPreGroupedRowModel().flatRows;return t?r.forEach(e=>{e.getCanSelect()&&(i[e.id]=!0)}):r.forEach(e=>{delete i[e.id]}),i})},toggleAllPageRowsSelected:t=>e.setRowSelection(n=>{let i=void 0!==t?t:!e.getIsAllPageRowsSelected(),r={...n};return e.getRowModel().rows.forEach(t=>{H(r,t.id,i,e)}),r}),getPreSelectedRowModel:()=>e.getCoreRowModel(),getSelectedRowModel:a(()=>[e.getState().rowSelection,e.getCoreRowModel()],(t,n)=>Object.keys(t).length?j(e,n):{rows:[],flatRows:[],rowsById:{}},{key:!1,debug:()=>e.options.debugAll??e.options.debugTable}),getFilteredSelectedRowModel:a(()=>[e.getState().rowSelection,e.getFilteredRowModel()],(t,n)=>Object.keys(t).length?j(e,n):{rows:[],flatRows:[],rowsById:{}},{key:"getFilteredSelectedRowModel",debug:()=>e.options.debugAll??e.options.debugTable}),getGroupedSelectedRowModel:a(()=>[e.getState().rowSelection,e.getSortedRowModel()],(t,n)=>Object.keys(t).length?j(e,n):{rows:[],flatRows:[],rowsById:{}},{key:"getGroupedSelectedRowModel",debug:()=>e.options.debugAll??e.options.debugTable}),getIsAllRowsSelected:()=>{let t=e.getFilteredRowModel().flatRows,{rowSelection:n}=e.getState(),i=!!(t.length&&Object.keys(n).length);return i&&t.some(e=>e.getCanSelect()&&!n[e.id])&&(i=!1),i},getIsAllPageRowsSelected:()=>{let t=e.getPaginationRowModel().flatRows,{rowSelection:n}=e.getState(),i=!!t.length;return i&&t.some(e=>!n[e.id])&&(i=!1),i},getIsSomeRowsSelected:()=>{let t=Object.keys(e.getState().rowSelection??{}).length;return t>0&&t<e.getFilteredRowModel().flatRows.length},getIsSomePageRowsSelected:()=>{let t=e.getPaginationRowModel().flatRows;return!e.getIsAllPageRowsSelected()&&t.some(e=>e.getIsSelected()||e.getIsSomeSelected())},getToggleAllRowsSelectedHandler:()=>t=>{e.toggleAllRowsSelected(t.target.checked)},getToggleAllPageRowsSelectedHandler:()=>t=>{e.toggleAllPageRowsSelected(t.target.checked)}}),createRow:(e,t)=>({toggleSelected:n=>{let i=e.getIsSelected();t.setRowSelection(r=>{if(i===(n=void 0!==n?n:!i))return r;let o={...r};return H(o,e.id,n,t),o})},getIsSelected:()=>{let{rowSelection:n}=t.getState();return G(e,n)},getIsSomeSelected:()=>{let{rowSelection:n}=t.getState();return"some"===U(e,n)},getIsAllSubRowsSelected:()=>{let{rowSelection:n}=t.getState();return"all"===U(e,n)},getCanSelect:()=>"function"==typeof t.options.enableRowSelection?t.options.enableRowSelection(e):t.options.enableRowSelection??!0,getCanSelectSubRows:()=>"function"==typeof t.options.enableSubRowSelection?t.options.enableSubRowSelection(e):t.options.enableSubRowSelection??!0,getCanMultiSelect:()=>"function"==typeof t.options.enableMultiRowSelection?t.options.enableMultiRowSelection(e):t.options.enableMultiRowSelection??!0,getToggleSelectedHandler:()=>{let t=e.getCanSelect();return n=>{var i;t&&e.toggleSelected(null==(i=n.target)?void 0:i.checked)}}})},H=(e,t,n,i)=>{var r;let o=i.getRow(t);n?(o.getCanMultiSelect()||Object.keys(e).forEach(t=>delete e[t]),o.getCanSelect()&&(e[t]=!0)):delete e[t],null!=(r=o.subRows)&&r.length&&o.getCanSelectSubRows()&&o.subRows.forEach(t=>H(e,t.id,n,i))};function j(e,t){let n=e.getState().rowSelection,i=[],r={},o=function(e,t){return e.map(e=>{var t;let s=G(e,n);if(s&&(i.push(e),r[e.id]=e),null!=(t=e.subRows)&&t.length&&(e={...e,subRows:o(e.subRows)}),s)return e}).filter(Boolean)};return{rows:o(t.rows),flatRows:i,rowsById:r}}function G(e,t){return t[e.id]??!1}function U(e,t,n){if(e.subRows&&e.subRows.length){let n=!0,i=!1;return e.subRows.forEach(e=>{i&&!n||(G(e,t)?i=!0:n=!1)}),n?"all":!!i&&"some"}return!1}let V=/([0-9]+)/gm;function Y(e,t){return e===t?0:e>t?1:-1}function B(e){return"number"==typeof e?isNaN(e)||e===1/0||e===-1/0?"":String(e):"string"==typeof e?e:""}function q(e,t){let n=e.split(V).filter(Boolean),i=t.split(V).filter(Boolean);for(;n.length&&i.length;){let e=n.shift(),t=i.shift(),r=parseInt(e,10),o=parseInt(t,10),s=[r,o].sort();if(isNaN(s[0])){if(e>t)return 1;if(t>e)return -1}else{if(isNaN(s[1]))return isNaN(r)?-1:1;if(r>o)return 1;if(o>r)return -1}}return n.length-i.length}let z={alphanumeric:(e,t,n)=>q(B(e.getValue(n)).toLowerCase(),B(t.getValue(n)).toLowerCase()),alphanumericCaseSensitive:(e,t,n)=>q(B(e.getValue(n)),B(t.getValue(n))),text:(e,t,n)=>Y(B(e.getValue(n)).toLowerCase(),B(t.getValue(n)).toLowerCase()),textCaseSensitive:(e,t,n)=>Y(B(e.getValue(n)),B(t.getValue(n))),datetime:(e,t,n)=>{let i=e.getValue(n),r=t.getValue(n);return i>r?1:i<r?-1:0},basic:(e,t,n)=>Y(e.getValue(n),t.getValue(n))},W={getInitialState:e=>({sorting:[],...e}),getDefaultColumnDef:()=>({sortingFn:"auto"}),getDefaultOptions:e=>({onSortingChange:r("sorting",e),isMultiSortEvent:e=>e.shiftKey}),createColumn:(e,t)=>({getAutoSortingFn:()=>{let n=t.getFilteredRowModel().flatRows.slice(10),i=!1;for(let t of n){let n=null==t?void 0:t.getValue(e.id);if("[object Date]"===Object.prototype.toString.call(n))return z.datetime;if("string"==typeof n&&(i=!0,n.split(V).length>1))return z.alphanumeric}return i?z.text:z.basic},getAutoSortDir:()=>{let n=t.getFilteredRowModel().flatRows[0];return"string"==typeof(null==n?void 0:n.getValue(e.id))?"asc":"desc"},getSortingFn:()=>{var n;if(!e)throw Error();return o(e.columnDef.sortingFn)?e.columnDef.sortingFn:"auto"===e.columnDef.sortingFn?e.getAutoSortingFn():(null==(n=t.options.sortingFns)?void 0:n[e.columnDef.sortingFn])??z[e.columnDef.sortingFn]},toggleSorting:(n,i)=>{let r=e.getNextSortingOrder(),o=null!=n;t.setSorting(s=>{let a=null==s?void 0:s.find(t=>t.id===e.id),l=null==s?void 0:s.findIndex(t=>t.id===e.id),c,u=[],d=o?n:"desc"===r;return"toggle"==(c=null!=s&&s.length&&e.getCanMultiSort()&&i?a?"toggle":"add":null!=s&&s.length&&l!==s.length-1?"replace":a?"toggle":"replace")&&(o||r||(c="remove")),"add"===c?(u=[...s,{id:e.id,desc:d}]).splice(0,u.length-(t.options.maxMultiSortColCount??Number.MAX_SAFE_INTEGER)):u="toggle"===c?s.map(t=>t.id===e.id?{...t,desc:d}:t):"remove"===c?s.filter(t=>t.id!==e.id):[{id:e.id,desc:d}],u})},getFirstSortDir:()=>e.columnDef.sortDescFirst??t.options.sortDescFirst??"desc"===e.getAutoSortDir()?"desc":"asc",getNextSortingOrder:n=>{let i=e.getFirstSortDir(),r=e.getIsSorted();return r?!(r!==i&&(t.options.enableSortingRemoval??1)&&(!n||(t.options.enableMultiRemove??1)))&&("desc"===r?"asc":"desc"):i},getCanSort:()=>(e.columnDef.enableSorting??!0)&&(t.options.enableSorting??!0)&&!!e.accessorFn,getCanMultiSort:()=>e.columnDef.enableMultiSort??t.options.enableMultiSort??!!e.accessorFn,getIsSorted:()=>{var n;let i=null==(n=t.getState().sorting)?void 0:n.find(t=>t.id===e.id);return!!i&&(i.desc?"desc":"asc")},getSortIndex:()=>{var n;return(null==(n=t.getState().sorting)?void 0:n.findIndex(t=>t.id===e.id))??-1},clearSorting:()=>{t.setSorting(t=>null!=t&&t.length?t.filter(t=>t.id!==e.id):[])},getToggleSortingHandler:()=>{let n=e.getCanSort();return i=>{n&&(null==i.persist||i.persist(),null==e.toggleSorting||e.toggleSorting(void 0,!!e.getCanMultiSort()&&(null==t.options.isMultiSortEvent?void 0:t.options.isMultiSortEvent(i))))}}}),createTable:e=>({setSorting:t=>null==e.options.onSortingChange?void 0:e.options.onSortingChange(t),resetSorting:t=>{var n;e.setSorting(t?[]:(null==(n=e.initialState)?void 0:n.sorting)??[])},getPreSortedRowModel:()=>e.getGroupedRowModel(),getSortedRowModel:()=>(!e._getSortedRowModel&&e.options.getSortedRowModel&&(e._getSortedRowModel=e.options.getSortedRowModel(e)),e.options.manualSorting||!e._getSortedRowModel?e.getPreSortedRowModel():e._getSortedRowModel())})},J={getInitialState:e=>({columnVisibility:{},...e}),getDefaultOptions:e=>({onColumnVisibilityChange:r("columnVisibility",e)}),createColumn:(e,t)=>({toggleVisibility:n=>{e.getCanHide()&&t.setColumnVisibility(t=>({...t,[e.id]:n??!e.getIsVisible()}))},getIsVisible:()=>{var n;return(null==(n=t.getState().columnVisibility)?void 0:n[e.id])??!0},getCanHide:()=>(e.columnDef.enableHiding??!0)&&(t.options.enableHiding??!0),getToggleVisibilityHandler:()=>t=>{null==e.toggleVisibility||e.toggleVisibility(t.target.checked)}}),createRow:(e,t)=>({_getAllVisibleCells:a(()=>[e.getAllCells(),t.getState().columnVisibility],e=>e.filter(e=>e.column.getIsVisible()),{key:"row._getAllVisibleCells",debug:()=>t.options.debugAll??t.options.debugRows}),getVisibleCells:a(()=>[e.getLeftVisibleCells(),e.getCenterVisibleCells(),e.getRightVisibleCells()],(e,t,n)=>[...e,...t,...n],{key:!1,debug:()=>t.options.debugAll??t.options.debugRows})}),createTable:e=>{let t=(t,n)=>a(()=>[n(),n().filter(e=>e.getIsVisible()).map(e=>e.id).join("_")],e=>e.filter(e=>null==e.getIsVisible?void 0:e.getIsVisible()),{key:t,debug:()=>e.options.debugAll??e.options.debugColumns});return{getVisibleFlatColumns:t("getVisibleFlatColumns",()=>e.getAllFlatColumns()),getVisibleLeafColumns:t("getVisibleLeafColumns",()=>e.getAllLeafColumns()),getLeftVisibleLeafColumns:t("getLeftVisibleLeafColumns",()=>e.getLeftLeafColumns()),getRightVisibleLeafColumns:t("getRightVisibleLeafColumns",()=>e.getRightLeafColumns()),getCenterVisibleLeafColumns:t("getCenterVisibleLeafColumns",()=>e.getCenterLeafColumns()),setColumnVisibility:t=>null==e.options.onColumnVisibilityChange?void 0:e.options.onColumnVisibilityChange(t),resetColumnVisibility:t=>{e.setColumnVisibility(t?{}:e.initialState.columnVisibility??{})},toggleAllColumnsVisible:t=>{t=t??!e.getIsAllColumnsVisible(),e.setColumnVisibility(e.getAllLeafColumns().reduce((e,n)=>({...e,[n.id]:t||!(null!=n.getCanHide&&n.getCanHide())}),{}))},getIsAllColumnsVisible:()=>!e.getAllLeafColumns().some(e=>!(null!=e.getIsVisible&&e.getIsVisible())),getIsSomeColumnsVisible:()=>e.getAllLeafColumns().some(e=>null==e.getIsVisible?void 0:e.getIsVisible()),getToggleAllColumnsVisibilityHandler:()=>t=>{var n;e.toggleAllColumnsVisible(null==(n=t.target)?void 0:n.checked)}}}},K=[u,J,P,N,x,W,L,b,D,F,g];function $(e){(e.debugAll||e.debugTable)&&console.info("Creating Table Instance...");let t={_features:K},n=t._features.reduce((e,n)=>Object.assign(e,null==n.getDefaultOptions?void 0:n.getDefaultOptions(t)),{}),r={...e.initialState??{}};t._features.forEach(e=>{r=(null==e.getInitialState?void 0:e.getInitialState(r))??r});let o=[],s=!1,c={_features:K,options:{...n,...e},initialState:r,_queue:e=>{o.push(e),s||(s=!0,Promise.resolve().then(()=>{for(;o.length;)o.shift()();s=!1}).catch(e=>setTimeout(()=>{throw e})))},reset:()=>{t.setState(t.initialState)},setOptions:e=>{let r=i(e,t.options);t.options=t.options.mergeOptions?t.options.mergeOptions(n,r):{...n,...r}},getState:()=>t.options.state,setState:e=>{null==t.options.onStateChange||t.options.onStateChange(e)},_getRowId:(e,n,i)=>(null==t.options.getRowId?void 0:t.options.getRowId(e,n,i))??`${i?[i.id,n].join("."):n}`,getCoreRowModel:()=>(t._getCoreRowModel||(t._getCoreRowModel=t.options.getCoreRowModel(t)),t._getCoreRowModel()),getRowModel:()=>t.getPaginationRowModel(),getRow:e=>{let n=t.getRowModel().rowsById[e];if(!n)throw Error();return n},_getDefaultColumnDef:a(()=>[t.options.defaultColumn],e=>(e=e??{},{header:e=>{let t=e.header.column.columnDef;return t.accessorKey?t.accessorKey:t.accessorFn?t.id:null},cell:e=>{var t;return(null==(t=e.renderValue())||null==t.toString?void 0:t.toString())??null},...t._features.reduce((e,t)=>Object.assign(e,null==t.getDefaultColumnDef?void 0:t.getDefaultColumnDef()),{}),...e}),{debug:()=>t.options.debugAll??t.options.debugColumns,key:!1}),_getColumnDefs:()=>t.options.columns,getAllColumns:a(()=>[t._getColumnDefs()],e=>{let n=function(e,i,r){return void 0===r&&(r=0),e.map(e=>{let o=l(t,e,r,i);return o.columns=e.columns?n(e.columns,o,r+1):[],o})};return n(e)},{key:!1,debug:()=>t.options.debugAll??t.options.debugColumns}),getAllFlatColumns:a(()=>[t.getAllColumns()],e=>e.flatMap(e=>e.getFlatColumns()),{key:!1,debug:()=>t.options.debugAll??t.options.debugColumns}),_getAllFlatColumnsById:a(()=>[t.getAllFlatColumns()],e=>e.reduce((e,t)=>(e[t.id]=t,e),{}),{key:!1,debug:()=>t.options.debugAll??t.options.debugColumns}),getAllLeafColumns:a(()=>[t.getAllColumns(),t._getOrderColumnsFn()],(e,t)=>t(e.flatMap(e=>e.getLeafColumns())),{key:!1,debug:()=>t.options.debugAll??t.options.debugColumns}),getColumn:e=>{let n=t._getAllFlatColumnsById()[e];if(!n)throw Error();return n}};return Object.assign(t,c),t._features.forEach(e=>Object.assign(t,null==e.createTable?void 0:e.createTable(t))),t}function X(e,t,n,i){let r={id:`${t.id}_${n.id}`,row:t,column:n,getValue:()=>t.getValue(i),renderValue:()=>r.getValue()??e.options.renderFallbackValue,getContext:a(()=>[e,n,t,r],(e,t,n,i)=>({table:e,column:t,row:n,cell:i,getValue:i.getValue,renderValue:i.renderValue}),{key:!1,debug:()=>e.options.debugAll})};return e._features.forEach(i=>{Object.assign(r,null==i.createCell?void 0:i.createCell(r,n,t,e))},{}),r}let Q=(e,t,n,i,r,o)=>{let l={id:t,index:i,original:n,depth:r,_valuesCache:{},_uniqueValuesCache:{},getValue:t=>{if(l._valuesCache.hasOwnProperty(t))return l._valuesCache[t];let n=e.getColumn(t);return n.accessorFn?(l._valuesCache[t]=n.accessorFn(l.original,i),l._valuesCache[t]):void 0},getUniqueValues:t=>{if(l._uniqueValuesCache.hasOwnProperty(t))return l._uniqueValuesCache[t];let n=e.getColumn(t);return n.accessorFn?(n.columnDef.getUniqueValues?l._uniqueValuesCache[t]=n.columnDef.getUniqueValues(l.original,i):l._uniqueValuesCache[t]=[l.getValue(t)],l._uniqueValuesCache[t]):void 0},renderValue:t=>l.getValue(t)??e.options.renderFallbackValue,subRows:o??[],getLeafRows:()=>s(l.subRows,e=>e.subRows),getAllCells:a(()=>[e.getAllLeafColumns()],t=>t.map(t=>X(e,l,t,t.id)),{key:!1,debug:()=>e.options.debugAll??e.options.debugRows}),_getAllCellsByColumnId:a(()=>[l.getAllCells()],e=>e.reduce((e,t)=>(e[t.column.id]=t,e),{}),{key:"row.getAllCellsByColumnId",debug:()=>e.options.debugAll??e.options.debugRows})};for(let t=0;t<e._features.length;t++){let n=e._features[t];Object.assign(l,null==n||null==n.createRow?void 0:n.createRow(l,e))}return l};function Z(e,t,n){return n.options.filterFromLeafRows?function(e,t,n){let i={},r=function(e,o){let s=[];for(let o=0;o<e.length;o++){var a;let l=e[o],c=Q(n,l.id,l.original,l.index,l.depth);if(c.columnFilters=l.columnFilters,null!=(a=l.subRows)&&a.length){if(c.subRows=r(l.subRows),t(l=c)&&!c.subRows.length||t(l)||c.subRows.length){s.push(l),i[l.id]=l,i[o]=l;continue}}else t(l=c)&&(s.push(l),i[l.id]=l,i[o]=l)}return s};return{rows:r(e),flatRows:[],rowsById:i}}(e,t,n):function(e,t,n){let i=[],r={},o=function(e,s){let a=[];for(let s=0;s<e.length;s++){let c=e[s];if(t(c)){var l;if(null!=(l=c.subRows)&&l.length){let e=Q(n,c.id,c.original,c.index,c.depth);e.subRows=o(c.subRows),c=e}a.push(c),i.push(c),r[c.id]=c}}return a};return{rows:o(e),flatRows:i,rowsById:r}}(e,t,n)}function ee(e){let t=[],n=e=>{var i;t.push(e),null!=(i=e.subRows)&&i.length&&e.getIsExpanded()&&e.subRows.forEach(n)};return e.rows.forEach(n),{rows:t,flatRows:e.flatRows,rowsById:e.rowsById}}e.ColumnSizing=g,e.Expanding=b,e.Filters=x,e.Grouping=L,e.Headers=u,e.Ordering=P,e.Pagination=D,e.Pinning=N,e.RowSelection=F,e.Sorting=W,e.Visibility=J,e.aggregationFns=T,e.buildHeaderGroups=d,e.createCell=X,e.createColumn=l,e.createColumnHelper=function(){return{accessor:(e,t)=>"function"==typeof e?{...t,accessorFn:e}:{...t,accessorKey:e},display:e=>e,group:e=>e}},e.createRow=Q,e.createTable=$,e.defaultColumnSizing=h,e.expandRows=ee,e.filterFns=O,e.flattenBy=s,e.flexRender=function(e,t){return e?"function"==typeof e&&(()=>{let t=Object.getPrototypeOf(e);return t.prototype&&t.prototype.isReactComponent})()||"function"==typeof e||"object"==typeof e&&"symbol"==typeof e.$$typeof&&["react.memo","react.forward_ref"].includes(e.$$typeof.description)?n.createElement(e,t):e:null},e.functionalUpdate=i,e.getCoreRowModel=function(){return e=>a(()=>[e.options.data],t=>{let n={rows:[],flatRows:[],rowsById:{}},i=function(t,r,o){void 0===r&&(r=0);let s=[];for(let l=0;l<t.length;l++){var a;let c=Q(e,e._getRowId(t[l],l,o),t[l],l,r);n.flatRows.push(c),n.rowsById[c.id]=c,s.push(c),e.options.getSubRows&&(c.originalSubRows=e.options.getSubRows(t[l],l),null!=(a=c.originalSubRows)&&a.length&&(c.subRows=i(c.originalSubRows,r+1,c)))}return s};return n.rows=i(t),n},{key:!1,debug:()=>e.options.debugAll??e.options.debugTable,onChange:()=>{e._autoResetPageIndex()}})},e.getExpandedRowModel=function(){return e=>a(()=>[e.getState().expanded,e.getPreExpandedRowModel(),e.options.paginateExpandedRows],(e,t,n)=>t.rows.length&&(!0===e||Object.keys(e??{}).length)&&n?ee(t):t,{key:!1,debug:()=>e.options.debugAll??e.options.debugTable})},e.getFacetedMinMaxValues=function(){return(e,t)=>a(()=>[e.getColumn(t).getFacetedRowModel()],e=>{var n;let i=null==(n=e.flatRows[0])?void 0:n.getUniqueValues(t);if(void 0===i)return;let r=[i,i];for(let n=0;n<e.flatRows.length;n++){let i=e.flatRows[n].getUniqueValues(t);for(let e=0;e<i.length;e++){let t=i[e];t<r[0]?r[0]=t:t>r[1]&&(r[1]=t)}}return r},{key:!1,debug:()=>e.options.debugAll??e.options.debugTable,onChange:()=>{}})},e.getFacetedRowModel=function(){return(e,t)=>a(()=>[e.getPreFilteredRowModel(),e.getState().columnFilters,e.getState().globalFilter,e.getFilteredRowModel()],(n,i,r)=>{if(!n.rows.length||(null==i||!i.length)&&!r)return n;let o=[...i.map(e=>e.id).filter(e=>e!==t),r?"__global__":void 0].filter(Boolean);return Z(n.rows,e=>{for(let t=0;t<o.length;t++)if(!1===e.columnFilters[o[t]])return!1;return!0},e)},{key:!1,debug:()=>e.options.debugAll??e.options.debugTable,onChange:()=>{}})},e.getFacetedUniqueValues=function(){return(e,t)=>a(()=>[e.getColumn(t).getFacetedRowModel()],e=>{let n=new Map;for(let i=0;i<e.flatRows.length;i++){let r=e.flatRows[i].getUniqueValues(t);for(let e=0;e<r.length;e++){let t=r[e];n.has(t)?n.set(t,(n.get(t)??0)+1):n.set(t,1)}}return n},{key:!1,debug:()=>e.options.debugAll??e.options.debugTable,onChange:()=>{}})},e.getFilteredRowModel=function(){return e=>a(()=>[e.getPreFilteredRowModel(),e.getState().columnFilters,e.getState().globalFilter],(t,n,i)=>{let r,o;if(!t.rows.length||(null==n||!n.length)&&!i){for(let e=0;e<t.flatRows.length;e++)t.flatRows[e].columnFilters={},t.flatRows[e].columnFiltersMeta={};return t}let s=[],a=[];(n??[]).forEach(t=>{let n=e.getColumn(t.id).getFilterFn();n&&s.push({id:t.id,filterFn:n,resolvedValue:(null==n.resolveFilterValue?void 0:n.resolveFilterValue(t.value))??t.value})});let l=n.map(e=>e.id),c=e.getGlobalFilterFn(),u=e.getAllLeafColumns().filter(e=>e.getCanGlobalFilter());i&&c&&u.length&&(l.push("__global__"),u.forEach(e=>{a.push({id:e.id,filterFn:c,resolvedValue:(null==c.resolveFilterValue?void 0:c.resolveFilterValue(i))??i})}));for(let e=0;e<t.flatRows.length;e++){let n=t.flatRows[e];if(n.columnFilters={},s.length)for(let e=0;e<s.length;e++){r=s[e];let t=r.id;n.columnFilters[t]=r.filterFn(n,t,r.resolvedValue,e=>{n.columnFiltersMeta[t]=e})}if(a.length){for(let e=0;e<a.length;e++){o=a[e];let t=o.id;if(o.filterFn(n,t,o.resolvedValue,e=>{n.columnFiltersMeta[t]=e})){n.columnFilters.__global__=!0;break}}!0!==n.columnFilters.__global__&&(n.columnFilters.__global__=!1)}}return Z(t.rows,e=>{for(let t=0;t<l.length;t++)if(!1===e.columnFilters[l[t]])return!1;return!0},e)},{key:!1,debug:()=>e.options.debugAll??e.options.debugTable,onChange:()=>{e._autoResetPageIndex()}})},e.getGroupedRowModel=function(){return e=>a(()=>[e.getState().grouping,e.getPreGroupedRowModel()],(t,n)=>{if(!n.rows.length||!t.length)return n;let i=t.filter(t=>e.getColumn(t)),r=[],o={},a=function(t,n,l){if(void 0===n&&(n=0),n>=i.length)return t.map(e=>(e.depth=n,r.push(e),o[e.id]=e,e.subRows&&(e.subRows=a(e.subRows,n+1)),e));let c=i[n],u=function(e,t){let n=new Map;return e.reduce((e,n)=>{let i=`${n.getValue(t)}`,r=e.get(i);return r?r.push(n):e.set(i,[n]),e},n)}(t,c),d=Array.from(u.entries()).map((t,u)=>{let[d,h]=t,g=`${c}:${d}`;g=l?`${l}>${g}`:g;let f=a(h,n+1,g),p=n?s(h,e=>e.subRows):h,m=Q(e,g,p[0].original,u,n);return Object.assign(m,{groupingColumnId:c,groupingValue:d,subRows:f,leafRows:p,getValue:t=>{if(i.includes(t))return m._valuesCache.hasOwnProperty(t)||h[0]&&(m._valuesCache[t]=h[0].getValue(t)??void 0),m._valuesCache[t];if(m._groupingValuesCache.hasOwnProperty(t))return m._groupingValuesCache[t];let n=e.getColumn(t).getAggregationFn();return n?(m._groupingValuesCache[t]=n(t,p,h),m._groupingValuesCache[t]):void 0}}),f.forEach(e=>{r.push(e),o[e.id]=e}),m});return d},l=a(n.rows,0,"");return l.forEach(e=>{r.push(e),o[e.id]=e}),{rows:l,flatRows:r,rowsById:o}},{key:!1,debug:()=>e.options.debugAll??e.options.debugTable,onChange:()=>{e._queue(()=>{e._autoResetExpanded(),e._autoResetPageIndex()})}})},e.getPaginationRowModel=function(e){return e=>a(()=>[e.getState().pagination,e.getPrePaginationRowModel(),e.options.paginateExpandedRows?void 0:e.getState().expanded],(t,n)=>{let i;if(!n.rows.length)return n;let{pageSize:r,pageIndex:o}=t,{rows:s,flatRows:a,rowsById:l}=n,c=r*o,u=c+r;s=s.slice(c,u),(i=e.options.paginateExpandedRows?{rows:s,flatRows:a,rowsById:l}:ee({rows:s,flatRows:a,rowsById:l})).flatRows=[];let d=e=>{i.flatRows.push(e),e.subRows.length&&e.subRows.forEach(d)};return i.rows.forEach(d),i},{key:!1,debug:()=>e.options.debugAll??e.options.debugTable})},e.getSortedRowModel=function(){return e=>a(()=>[e.getState().sorting,e.getPreSortedRowModel()],(t,n)=>{if(!n.rows.length||null==t||!t.length)return n;let i=e.getState().sorting,r=[],o=i.filter(t=>e.getColumn(t.id).getCanSort()),s={};o.forEach(t=>{let n=e.getColumn(t.id);s[t.id]={sortUndefined:n.columnDef.sortUndefined,invertSorting:n.columnDef.invertSorting,sortingFn:n.getSortingFn()}});let a=e=>{let t=[...e];return t.sort((e,t)=>{for(let n=0;n<o.length;n+=1){let i=o[n],r=s[i.id],a=(null==i?void 0:i.desc)??!1;if(r.sortUndefined){let n=void 0===e.getValue(i.id),o=void 0===t.getValue(i.id);if(n||o)return n&&o?0:n?r.sortUndefined:-r.sortUndefined}let l=r.sortingFn(e,t,i.id);if(0!==l)return a&&(l*=-1),r.invertSorting&&(l*=-1),l}return e.index-t.index}),t.forEach(e=>{var t;r.push(e),null!=(t=e.subRows)&&t.length&&(e.subRows=a(e.subRows))}),t};return{rows:a(n.rows),flatRows:r,rowsById:n.rowsById}},{key:!1,debug:()=>e.options.debugAll??e.options.debugTable,onChange:()=>{e._autoResetPageIndex()}})},e.isFunction=o,e.isRowSelected=G,e.isSubRowSelected=U,e.makeStateUpdater=r,e.memo=a,e.noop=function(){},e.orderColumns=I,e.passiveEventSupported=p,e.reSplitAlphaNumeric=V,e.selectRowsFn=j,e.shouldAutoRemoveFilter=A,e.sortingFns=z,e.useReactTable=function(e){let t={state:{},onStateChange:()=>{},renderFallbackValue:null,...e},[i]=n.useState(()=>({current:$(t)})),[r,o]=n.useState(()=>i.current.initialState);return i.current.setOptions(t=>({...t,...e,state:{...r,...e.state},onStateChange:t=>{o(t),null==e.onStateChange||e.onStateChange(t)}})),i.current},Object.defineProperty(e,"__esModule",{value:!0})}(t,n(2784))},52876:function(e,t,n){/*@license Copyright 2015-2022 Ably Real-time Ltd (ably.com)

Ably JavaScript Library v2.3.0
https://github.com/ably/ably-js

Released under the Apache Licence v2.0*/e.exports=(()=>{"use strict";var e,t,i,r,o,s,a,l,c,u={},d={exports:u},h=Object.defineProperty,g=Object.defineProperties,f=Object.getOwnPropertyDescriptor,p=Object.getOwnPropertyDescriptors,m=Object.getOwnPropertyNames,b=Object.getOwnPropertySymbols,y=Object.prototype.hasOwnProperty,v=Object.prototype.propertyIsEnumerable,w=(e,t,n)=>t in e?h(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,_=(e,t)=>{for(var n in t||(t={}))y.call(t,n)&&w(e,n,t[n]);if(b)for(var n of b(t))v.call(t,n)&&w(e,n,t[n]);return e},S=(e,t)=>g(e,p(t)),C=(e,t)=>{var n={};for(var i in e)y.call(e,i)&&0>t.indexOf(i)&&(n[i]=e[i]);if(null!=e&&b)for(var i of b(e))0>t.indexOf(i)&&v.call(e,i)&&(n[i]=e[i]);return n},M=(e,t)=>{for(var n in t)h(e,n,{get:t[n],enumerable:!0})},R={};M(R,{ErrorInfo:()=>P,Realtime:()=>ny,Rest:()=>tD,default:()=>n3,msgpack:()=>n2,protocolMessageFromDeserialized:()=>tq}),d.exports=((e,t,n,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of m(t))y.call(e,n)||void 0===n||h(e,n,{get:()=>t[n],enumerable:!(i=f(t,n))||i.enumerable});return e})(h({},"__esModule",{value:!0}),R);var E=class{},O=void 0!==n.g?n.g:"undefined"!=typeof window?window:self;function k(e,t){return`${e}`.padStart(t?3:2,"0")}function x(e){return E.Config.logTimestamps?function(t){let n=new Date;e(k(n.getHours())+":"+k(n.getMinutes())+":"+k(n.getSeconds())+"."+k(n.getMilliseconds(),1)+" "+t)}:function(t){e(t)}}var A=()=>{var e;let t,n;return"function"==typeof(null==(e=null==O?void 0:O.console)?void 0:e.log)?(t=function(...e){console.log.apply(console,e)},n=console.warn?function(...e){console.warn.apply(console,e)}:t):t=n=function(){},[t,n].map(x)},T=class e{constructor(){this.deprecated=(e,t)=>{this.deprecationWarning(`${e} is deprecated and will be removed in a future version. ${t}`)},this.shouldLog=e=>e<=this.logLevel,this.setLog=(e,t)=>{void 0!==e&&(this.logLevel=e),void 0!==t&&(this.logHandler=this.logErrorHandler=t)},this.logLevel=e.defaultLogLevel,this.logHandler=e.defaultLogHandler,this.logErrorHandler=e.defaultLogErrorHandler}static initLogHandlers(){let[t,n]=A();this.defaultLogHandler=t,this.defaultLogErrorHandler=n,this.defaultLogger=new e}static logActionNoStrip(e,t,n,i){e.logAction(t,n,i)}logAction(e,t,n){this.shouldLog(e)&&(1===e?this.logErrorHandler:this.logHandler)("Ably: "+t+": "+n,e)}renamedClientOption(e,t){this.deprecationWarning(`The \`${e}\` client option has been renamed to \`${t}\`. Please update your code to use \`${t}\` instead. \`${e}\` will be removed in a future version.`)}renamedMethod(e,t,n){this.deprecationWarning(`\`${e}\`\u2019s \`${t}\` method has been renamed to \`${n}\`. Please update your code to use \`${n}\` instead. \`${t}\` will be removed in a future version.`)}deprecationWarning(e){this.shouldLog(1)&&this.logErrorHandler(`Ably: Deprecation warning - ${e}`,1)}};T.defaultLogLevel=1,T.LOG_NONE=0,T.LOG_ERROR=1,T.LOG_MAJOR=2,T.LOG_MINOR=3,T.LOG_MICRO=4,T.logAction=(e,t,n,i)=>{T.logActionNoStrip(e,t,n,i)};var L={};function I(e){let t="["+e.constructor.name;return e.message&&(t+=": "+e.message),e.statusCode&&(t+="; statusCode="+e.statusCode),e.code&&(t+="; code="+e.code),e.cause&&(t+="; cause="+ea(e.cause)),e.href&&!(e.message&&e.message.indexOf("help.ably.io")>-1)&&(t+="; see "+e.href+" "),t+="]"}M(L,{Format:()=>en,allSame:()=>et,allToLowerCase:()=>em,allToUpperCase:()=>eb,arrChooseN:()=>eh,arrDeleteValue:()=>$,arrEquals:()=>eR,arrIntersect:()=>W,arrIntersectOb:()=>J,arrPopRandomElement:()=>ei,arrSubtract:()=>K,arrWithoutValue:()=>X,cheapRandStr:()=>eu,containsValue:()=>q,copy:()=>F,createMissingPluginError:()=>eE,dataSizeBytes:()=>ec,decodeBody:()=>ef,encodeBody:()=>ep,ensureArray:()=>H,forInOwnNonNullProperties:()=>ee,getBackoffCoefficient:()=>ey,getGlobalObject:()=>e_,getJitterCoefficient:()=>ev,getRetryTime:()=>ew,inherits:()=>B,inspectBody:()=>el,inspectError:()=>ea,intersect:()=>z,isEmpty:()=>G,isErrorInfoOrPartialErrorInfo:()=>es,isNil:()=>U,isObject:()=>j,keysArray:()=>Q,matchDerivedChannel:()=>eC,mixin:()=>N,parseQueryString:()=>eo,prototypicalClone:()=>Y,randomString:()=>ed,shallowClone:()=>V,shallowEquals:()=>eS,throwMissingPluginError:()=>eO,toBase64:()=>eM,toQueryString:()=>er,valuesArray:()=>Z,whenPromiseSettles:()=>eg,withTimeoutAsync:()=>ek});var P=class e extends Error{constructor(t,n,i,r){super(t),void 0!==Object.setPrototypeOf&&Object.setPrototypeOf(this,e.prototype),this.code=n,this.statusCode=i,this.cause=r}toString(){return I(this)}static fromValues(t){let{message:n,code:i,statusCode:r}=t;if("string"!=typeof n||"number"!=typeof i||"number"!=typeof r)throw Error("ErrorInfo.fromValues(): invalid values: "+E.Config.inspect(t));let o=Object.assign(new e(n,i,r),t);return o.code&&!o.href&&(o.href="https://help.ably.io/error/"+o.code),o}},D=class e extends Error{constructor(t,n,i,r){super(t),void 0!==Object.setPrototypeOf&&Object.setPrototypeOf(this,e.prototype),this.code=n,this.statusCode=i,this.cause=r}toString(){return I(this)}static fromValues(t){let{message:n,code:i,statusCode:r}=t;if("string"!=typeof n||!U(i)&&"number"!=typeof i||!U(r)&&"number"!=typeof r)throw Error("PartialErrorInfo.fromValues(): invalid values: "+E.Config.inspect(t));let o=Object.assign(new e(n,i,r),t);return o.code&&!o.href&&(o.href="https://help.ably.io/error/"+o.code),o}};function N(e,...t){for(let n=0;n<t.length;n++){let i=t[n];if(!i)break;for(let t in i)Object.prototype.hasOwnProperty.call(i,t)&&(e[t]=i[t])}return e}function F(e){return N({},e)}function H(e){return U(e)?[]:Array.isArray(e)?e:[e]}function j(e){return"[object Object]"==Object.prototype.toString.call(e)}function G(e){for(let t in e)return!1;return!0}function U(e){return null==e}function V(e){let t={};for(let n in e)t[n]=e[n];return t}function Y(e,t){class n{}n.prototype=e;let i=new n;return t&&N(i,t),i}var B=function(e,t){if(E.Config.inherits){E.Config.inherits(e,t);return}e.super_=t,e.prototype=Y(t.prototype,{constructor:e})};function q(e,t){for(let n in e)if(e[n]==t)return!0;return!1}function z(e,t){return Array.isArray(t)?W(e,t):J(e,t)}function W(e,t){let n=[];for(let i=0;i<e.length;i++){let r=e[i];-1!=t.indexOf(r)&&n.push(r)}return n}function J(e,t){let n=[];for(let i=0;i<e.length;i++){let r=e[i];r in t&&n.push(r)}return n}function K(e,t){let n=[];for(let i=0;i<e.length;i++){let r=e[i];-1==t.indexOf(r)&&n.push(r)}return n}function $(e,t){let n=e.indexOf(t),i=-1!=n;return i&&e.splice(n,1),i}function X(e,t){let n=e.slice();return $(n,t),n}function Q(e,t){let n=[];for(let i in e)(!t||Object.prototype.hasOwnProperty.call(e,i))&&n.push(i);return n}function Z(e,t){let n=[];for(let i in e)(!t||Object.prototype.hasOwnProperty.call(e,i))&&n.push(e[i]);return n}function ee(e,t){for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&e[n]&&t(n)}function et(e,t){if(0===e.length)return!0;let n=e[0][t];return e.every(function(e){return e[t]===n})}var en=((e=en||{}).msgpack="msgpack",e.json="json",e);function ei(e){return e.splice(Math.floor(Math.random()*e.length),1)[0]}function er(e){let t=[];if(e)for(let n in e)t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.length?"?"+t.join("&"):""}function eo(e){let t;let n=/([^?&=]+)=?([^&]*)/g,i={};for(;t=n.exec(e);)i[decodeURIComponent(t[1])]=decodeURIComponent(t[2]);return i}function es(e){return"object"==typeof e&&null!==e&&(e instanceof P||e instanceof D)}function ea(e){var t,n;return e instanceof Error||(null==(t=null==e?void 0:e.constructor)?void 0:t.name)==="ErrorInfo"||(null==(n=null==e?void 0:e.constructor)?void 0:n.name)==="PartialErrorInfo"?e.toString():E.Config.inspect(e)}function el(e){return E.BufferUtils.isBuffer(e)?e.toString():"string"==typeof e?e:E.Config.inspect(e)}function ec(e){if(E.BufferUtils.isBuffer(e))return E.BufferUtils.byteLength(e);if("string"==typeof e)return E.Config.stringByteSize(e);throw Error("Expected input of Utils.dataSizeBytes to be a buffer or string, but was: "+typeof e)}function eu(){return String(Math.random()).substr(2)}var ed=async e=>{let t=await E.Config.getRandomArrayBuffer(e);return E.BufferUtils.base64Encode(t)};function eh(e,t){let n=Math.min(t,e.length),i=e.slice(),r=[];for(let e=0;e<n;e++)r.push(ei(i));return r}function eg(e,t){e.then(e=>{null==t||t(null,e)}).catch(e=>{null==t||t(e)})}function ef(e,t,n){return"msgpack"==n?(t||eO("MsgPack"),t.decode(e)):JSON.parse(String(e))}function ep(e,t,n){return"msgpack"==n?(t||eO("MsgPack"),t.encode(e,!0)):JSON.stringify(e)}function em(e){return e.map(function(e){return e&&e.toLowerCase()})}function eb(e){return e.map(function(e){return e&&e.toUpperCase()})}function ey(e){return Math.min((e+2)/3,2)}function ev(){return 1-.2*Math.random()}function ew(e,t){return e*ey(t)*ev()}function e_(){return void 0!==n.g?n.g:"undefined"!=typeof window?window:self}function eS(e,t){return Object.keys(e).every(n=>e[n]===t[n])&&Object.keys(t).every(n=>t[n]===e[n])}function eC(e){let t=e.match(/^(\[([^?]*)(?:(.*))\])?(.+)$/);if(!t||!t.length||t.length<5)throw new P("regex match failed",400,40010);if(t[2])throw new P(`cannot use a derived option with a ${t[2]} channel`,400,40010);return{qualifierParam:t[3]||"",channelName:t[4]}}function eM(e){let t=E.BufferUtils,n=t.utf8Encode(e);return t.base64Encode(n)}function eR(e,t){return e.length===t.length&&e.every(function(e,n){return e===t[n]})}function eE(e){return new P(`${e} plugin not provided`,40019,400)}function eO(e){throw eE(e)}async function ek(e,t=5e3,n="Timeout expired"){let i=new P(n,5e4,500);return Promise.race([e,new Promise((e,n)=>setTimeout(()=>n(i),t))])}var ex="2.3.0",eA={ENVIRONMENT:"",REST_HOST:"rest.ably.io",REALTIME_HOST:"realtime.ably.io",FALLBACK_HOSTS:["A.ably-realtime.com","B.ably-realtime.com","C.ably-realtime.com","D.ably-realtime.com","E.ably-realtime.com"],PORT:80,TLS_PORT:443,TIMEOUTS:{disconnectedRetryTimeout:15e3,suspendedRetryTimeout:3e4,httpRequestTimeout:1e4,httpMaxRetryDuration:15e3,channelRetryTimeout:15e3,fallbackRetryTimeout:6e5,connectionStateTtl:12e4,realtimeRequestTimeout:1e4,recvTimeout:9e4,webSocketConnectTimeout:1e4,webSocketSlowTimeout:4e3},httpMaxRetryCount:3,maxMessageSize:65536,version:ex,protocolVersion:3,agent:"ably-js/"+ex,getHost:eT,getPort:function(e,t){return t||e.tls?e.tlsPort:e.port},getHttpScheme:function(e){return e.tls?"https://":"http://"},environmentFallbackHosts:eL,getFallbackHosts:eI,getHosts:function(e,t){let n=[e.restHost].concat(eI(e));return t?n.map(t=>eT(e,t,!0)):n},checkHost:eP,objectifyOptions:function(e,t,n,i,r){let o;if(void 0===e){let e=t?`${n} must be initialized with either a client options object, an Ably API key, or an Ably Token`:`${n} must be initialized with a client options object`;throw T.logAction(i,T.LOG_ERROR,`${n}()`,e),Error(e)}if("string"==typeof e){if(-1==e.indexOf(":")){if(!t){let e=`${n} cannot be initialized with just an Ably Token; you must provide a client options object with a \`plugins\` property. (Set this Ably Token as the object\u2019s \`token\` property.)`;throw T.logAction(i,T.LOG_ERROR,`${n}()`,e),Error(e)}o={token:e}}else{if(!t){let e=`${n} cannot be initialized with just an Ably API key; you must provide a client options object with a \`plugins\` property. (Set this Ably API key as the object\u2019s \`key\` property.)`;throw T.logAction(i,T.LOG_ERROR,`${n}()`,e),Error(e)}o={key:e}}}else o=e;return r&&(o=S(_({},o),{plugins:_(_({},r),o.plugins)})),o},normaliseOptions:function(e,t,n){let i=null!=n?n:T.defaultLogger;"function"==typeof e.recover&&!0===e.closeOnUnload&&(T.logAction(i,T.LOG_ERROR,"Defaults.normaliseOptions","closeOnUnload was true and a session recovery function was set - these are mutually exclusive, so unsetting the latter"),e.recover=void 0),"closeOnUnload"in e||(e.closeOnUnload=!e.recover),"queueMessages"in e||(e.queueMessages=!0);let r=e.environment&&String(e.environment).toLowerCase()||eA.ENVIRONMENT,o=!r||"production"===r;e.fallbackHosts||e.restHost||e.realtimeHost||e.port||e.tlsPort||(e.fallbackHosts=o?eA.FALLBACK_HOSTS:eL(r));let s=e.restHost||(o?eA.REST_HOST:r+"-"+eA.REST_HOST),a=e.realtimeHost?e.realtimeHost:e.restHost?(T.logAction(i,T.LOG_MINOR,"Defaults.normaliseOptions",'restHost is set to "'+e.restHost+'" but realtimeHost is not set, so setting realtimeHost to "'+e.restHost+'" too. If this is not what you want, please set realtimeHost explicitly.'),e.restHost):o?eA.REALTIME_HOST:r+"-"+eA.REALTIME_HOST;(e.fallbackHosts||[]).concat(s,a).forEach(eP),e.port=e.port||eA.PORT,e.tlsPort=e.tlsPort||eA.TLS_PORT,"tls"in e||(e.tls=!0);let l=function(e){let t={};for(let n in eA.TIMEOUTS)t[n]=e[n]||eA.TIMEOUTS[n];return t}(e);t?"useBinaryProtocol"in e?e.useBinaryProtocol=E.Config.supportsBinary&&e.useBinaryProtocol:e.useBinaryProtocol=E.Config.preferBinary:e.useBinaryProtocol=!1;let c={};e.clientId&&(c["X-Ably-ClientId"]=E.BufferUtils.base64Encode(E.BufferUtils.utf8Encode(e.clientId))),"idempotentRestPublishing"in e||(e.idempotentRestPublishing=!0);let u=null,d=e.connectivityCheckUrl;if(e.connectivityCheckUrl){let[t,n]=e.connectivityCheckUrl.split("?");u=n?eo(n):{},-1===t.indexOf("://")&&(t="https://"+t),d=t}return S(_({},e),{realtimeHost:a,restHost:s,maxMessageSize:e.maxMessageSize||eA.maxMessageSize,timeouts:l,connectivityCheckParams:u,connectivityCheckUrl:d,headers:c})},defaultGetHeaders:function(e,{format:t=eH.format,protocolVersion:n=eH.protocolVersion}={}){let i=eF[t];return{accept:i,"X-Ably-Version":n.toString(),"Ably-Agent":eD(e)}},defaultPostHeaders:function(e,{format:t=eH.format,protocolVersion:n=eH.protocolVersion}={}){let i;let r=i=eF[t];return{accept:r,"content-type":i,"X-Ably-Version":n.toString(),"Ably-Agent":eD(e)}}};function eT(e,t,n){return t=n?t==e.restHost&&e.realtimeHost||t||e.realtimeHost:t||e.restHost}function eL(e){return[e+"-a-fallback.ably-realtime.com",e+"-b-fallback.ably-realtime.com",e+"-c-fallback.ably-realtime.com",e+"-d-fallback.ably-realtime.com",e+"-e-fallback.ably-realtime.com"]}function eI(e){let t=e.fallbackHosts,n=void 0!==e.httpMaxRetryCount?e.httpMaxRetryCount:eA.httpMaxRetryCount;return t?eh(t,n):[]}function eP(e){if("string"!=typeof e)throw new P("host must be a string; was a "+typeof e,4e4,400);if(!e.length)throw new P("host must not be zero-length",4e4,400)}function eD(e){let t=eA.agent;if(e.agents)for(var n in e.agents)t+=" "+n+"/"+e.agents[n];return t}function eN(e,t,n){let i=n||{};if(i.cipher){e||eO("Crypto");let n=e.getCipher(i.cipher,t);i.cipher=n.cipherParams,i.channelCipher=n.cipher}else"cipher"in i&&(i.cipher=void 0,i.channelCipher=null);return i}var eF={json:"application/json",xml:"application/xml",html:"text/html",msgpack:"application/x-msgpack",text:"text/plain"},eH={format:"json",protocolVersion:eA.protocolVersion},ej=class e{constructor(e,t){this.logger=e,this.members=t||[]}call(e,t){for(let n of this.members)if(n)try{n(e,t)}catch(e){T.logAction(this.logger,T.LOG_ERROR,"Multicaster multiple callback handler","Unexpected exception: "+e+"; stack = "+e.stack)}}push(...e){this.members.push(...e)}createPromise(){return new Promise((e,t)=>{this.push((n,i)=>{n?t(n):e(i)})})}resolveAll(e){this.call(null,e)}rejectAll(e){this.call(e)}static create(t,n){let i=new e(t,n);return Object.assign((e,t)=>i.call(e,t),{push:e=>i.push(e),createPromise:()=>i.createPromise(),resolveAll:e=>i.resolveAll(e),rejectAll:e=>i.rejectAll(e)})}},eG=((t=eG||{}).Get="get",t.Delete="delete",t.Post="post",t.Put="put",t.Patch="patch",t),eU=((i=eU||{})[i.Success=200]="Success",i[i.NoContent=204]="NoContent",i[i.BadRequest=400]="BadRequest",i[i.Unauthorized=401]="Unauthorized",i[i.Forbidden=403]="Forbidden",i[i.RequestTimeout=408]="RequestTimeout",i[i.InternalServerError=500]="InternalServerError",i);function eV(e){return es(e)?(e.code||(403===e.statusCode?e.code=40300:(e.code=40170,e.statusCode=401)),e):new P(ea(e),e.code||40170,e.statusCode||401)}var eY=(e,t)=>{let n=E.BufferUtils,i=n.utf8Encode(e),r=n.utf8Encode(t),o=n.hmacSha256(i,r);return n.base64Encode(o)};function eB(e){if(!e)return"";"string"==typeof e&&(e=JSON.parse(e));let t=Object.create(null),n=Q(e,!0);if(!n)return"";n.sort();for(let i=0;i<n.length;i++)t[n[i]]=e[n[i]].sort();return JSON.stringify(t)}function eq(e,t){if(e.authCallback)T.logAction(t,T.LOG_MINOR,"Auth()","using token auth with authCallback");else if(e.authUrl)T.logAction(t,T.LOG_MINOR,"Auth()","using token auth with authUrl");else if(e.key)T.logAction(t,T.LOG_MINOR,"Auth()","using token auth with client-side signing");else if(e.tokenDetails)T.logAction(t,T.LOG_MINOR,"Auth()","using token auth with supplied token only");else{let e="authOptions must include valid authentication parameters";throw T.logAction(t,T.LOG_ERROR,"Auth()",e),Error(e)}}function ez(e){return e.useTokenAuth||!("useTokenAuth"in e&&!e.useTokenAuth)&&(e.authCallback||e.authUrl||e.token||e.tokenDetails)}var eW=0,eJ=class{constructor(e,t){if(this.authOptions={},this.client=e,this.tokenParams=t.defaultTokenParams||{},this.currentTokenRequestId=null,this.waitingForTokenRequest=null,ez(t))t.key||t.authCallback||t.authUrl||T.logAction(this.logger,T.LOG_ERROR,"Auth()","Warning: library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),this._saveTokenOptions(t.defaultTokenParams,t),eq(this.authOptions,this.logger);else{if(!t.key){let e="No authentication options provided; need one of: key, authUrl, or authCallback (or for testing only, token or tokenDetails)";throw T.logAction(this.logger,T.LOG_ERROR,"Auth()",e),new P(e,40160,401)}T.logAction(this.logger,T.LOG_MINOR,"Auth()","anonymous, using basic auth"),this._saveBasicOptions(t)}}get logger(){return this.client.logger}async authorize(e,t){if(t&&t.key&&this.authOptions.key!==t.key)throw new P("Unable to update auth options with incompatible key",40102,401);try{let n=await this._forceNewToken(null!=e?e:null,null!=t?t:null);if(this.client.connection)return new Promise((e,t)=>{this.client.connection.connectionManager.onAuthUpdated(n,(n,i)=>n?t(n):e(i))});return n}catch(e){throw this.client.connection&&e.statusCode===eU.Forbidden&&this.client.connection.connectionManager.actOnErrorFromAuthorize(e),e}}async _forceNewToken(e,t){this.tokenDetails=null,this._saveTokenOptions(e,t),eq(this.authOptions,this.logger);try{return this._ensureValidAuthCredentials(!0)}finally{delete this.tokenParams.timestamp,delete this.authOptions.queryTime}}async requestToken(e,t){let n=t||this.authOptions,i=e||F(this.tokenParams),r,o=this.client;if(n.authCallback)T.logAction(this.logger,T.LOG_MINOR,"Auth.requestToken()","using token auth with authCallback"),r=n.authCallback;else if(n.authUrl)T.logAction(this.logger,T.LOG_MINOR,"Auth.requestToken()","using token auth with authUrl"),r=(e,t)=>{let i;let r=N({accept:"application/json, text/plain"},n.authHeaders),o=n.authMethod&&"post"===n.authMethod.toLowerCase(),s=n.authUrl.indexOf("?");s>-1&&(i=eo(n.authUrl.slice(s)),n.authUrl=n.authUrl.slice(0,s),o||(n.authParams=N(i,n.authParams)));let a=N({},n.authParams||{},e),l=e=>{var n,i;let r=null!=(n=e.body)?n:null,o=null;if(e.error)T.logAction(this.logger,T.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received Error: "+ea(e.error));else{let t=null!=(i=e.headers["content-type"])?i:null;o=Array.isArray(t)?t.join(", "):t,T.logAction(this.logger,T.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received; content-type: "+o+"; body: "+el(r))}if(e.error){t(e.error,null);return}if(e.unpacked){t(null,r);return}if(E.BufferUtils.isBuffer(r)&&(r=r.toString()),!o){t(new P("authUrl response is missing a content-type header",40170,401),null);return}let s=o.indexOf("application/json")>-1,a=o.indexOf("text/plain")>-1||o.indexOf("application/jwt")>-1;if(!s&&!a){t(new P("authUrl responded with unacceptable content-type "+o+", should be either text/plain, application/jwt or application/json",40170,401),null);return}if(s){if(r.length>131072){t(new P("authUrl response exceeded max permitted length",40170,401),null);return}try{r=JSON.parse(r)}catch(e){t(new P("Unexpected error processing authURL response; err = "+e.message,40170,401),null);return}}t(null,r,o)};if(T.logAction(this.logger,T.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Requesting token from "+n.authUrl+"; Params: "+JSON.stringify(a)+"; method: "+(o?"POST":"GET")),o){let e=r||{};e["content-type"]="application/x-www-form-urlencoded";let t=er(a).slice(1);eg(this.client.http.doUri(eG.Post,n.authUrl,e,t,i),(e,t)=>e?l(e):l(t))}else eg(this.client.http.doUri(eG.Get,n.authUrl,r||{},null,a),(e,t)=>e?l(e):l(t))};else if(n.key)T.logAction(this.logger,T.LOG_MINOR,"Auth.requestToken()","using token auth with client-side signing"),r=(e,t)=>{eg(this.createTokenRequest(e,n),(e,n)=>t(e,null!=n?n:null))};else throw T.logAction(this.logger,T.LOG_ERROR,"Auth()","library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),new P("Need a new token, but authOptions does not include any way to request one (no authUrl, authCallback, or key)",40171,403);"capability"in i&&(i.capability=eB(i.capability));let s=(e,t)=>{let i=e.keyName,r="/keys/"+i+"/requestToken",s=eA.defaultPostHeaders(this.client.options);n.requestHeaders&&N(s,n.requestHeaders),T.logAction(this.logger,T.LOG_MICRO,"Auth.requestToken().requestToken","Sending POST to "+r+"; Token params: "+JSON.stringify(e)),eg(this.client.http.do(eG.Post,function(e){return o.baseUri(e)+r},s,JSON.stringify(e),null),(e,n)=>e?t(e):t(n.error,n.body,n.unpacked))};return new Promise((e,t)=>{let o=!1,a=this.client.options.timeouts.realtimeRequestTimeout,l=setTimeout(()=>{o=!0;let e="Token request callback timed out after "+a/1e3+" seconds";T.logAction(this.logger,T.LOG_ERROR,"Auth.requestToken()",e),t(new P(e,40170,401))},a);r(i,(i,r,a)=>{if(o)return;if(clearTimeout(l),i){T.logAction(this.logger,T.LOG_ERROR,"Auth.requestToken()","token request signing call returned error; err = "+ea(i)),t(eV(i));return}if("string"==typeof r){0===r.length?t(new P("Token string is empty",40170,401)):r.length>131072?t(new P("Token string exceeded max permitted length (was "+r.length+" bytes)",40170,401)):"undefined"===r||"null"===r?t(new P("Token string was literal null/undefined",40170,401)):"{"!==r[0]||a&&a.indexOf("application/jwt")>-1?e({token:r}):t(new P("Token was double-encoded; make sure you're not JSON-encoding an already encoded token request or details",40170,401));return}if("object"!=typeof r||null===r){let e="Expected token request callback to call back with a token string or token request/details object, but got a "+typeof r;T.logAction(this.logger,T.LOG_ERROR,"Auth.requestToken()",e),t(new P(e,40170,401));return}let c=JSON.stringify(r).length;if(c>131072&&!n.suppressMaxLengthCheck){t(new P("Token request/details object exceeded max permitted stringified size (was "+c+" bytes)",40170,401));return}if("issued"in r){e(r);return}if(!("keyName"in r)){let e="Expected token request callback to call back with a token string, token request object, or token details object";T.logAction(this.logger,T.LOG_ERROR,"Auth.requestToken()",e),t(new P(e,40170,401));return}s(r,(n,i,r)=>{if(n){T.logAction(this.logger,T.LOG_ERROR,"Auth.requestToken()","token request API call returned error; err = "+ea(n)),t(eV(n));return}r||(i=JSON.parse(i)),T.logAction(this.logger,T.LOG_MINOR,"Auth.getToken()","token received"),e(i)})})})}async createTokenRequest(e,t){t=t||this.authOptions,e=e||F(this.tokenParams);let n=t.key;if(!n)throw new P("No key specified",40101,403);let i=n.split(":"),r=i[0],o=i[1];if(!o)throw new P("Invalid key specified",40101,403);if(""===e.clientId)throw new P("clientId can’t be an empty string",40012,400);"capability"in e&&(e.capability=eB(e.capability));let s=N({keyName:r},e),a=e.clientId||"",l=e.ttl||"",c=e.capability||"";s.timestamp||(s.timestamp=await this.getTimestamp(t&&t.queryTime));let u=s.nonce||(s.nonce=("000000"+Math.floor(1e16*Math.random())).slice(-16)),d=s.timestamp,h=s.keyName+"\n"+l+"\n"+c+"\n"+a+"\n"+d+"\n"+u+"\n";return s.mac=s.mac||eY(h,o),T.logAction(this.logger,T.LOG_MINOR,"Auth.getTokenRequest()","generated signed request"),s}async getAuthParams(){if("basic"==this.method)return{key:this.key};{let e=await this._ensureValidAuthCredentials(!1);if(!e)throw Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");return{access_token:e.token}}}async getAuthHeaders(){if("basic"==this.method)return{authorization:"Basic "+this.basicKey};{let e=await this._ensureValidAuthCredentials(!1);if(!e)throw Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");return{authorization:"Bearer "+eM(e.token)}}}async getTimestamp(e){return!this.isTimeOffsetSet()&&(e||this.authOptions.queryTime)?this.client.time():this.getTimestampUsingOffset()}getTimestampUsingOffset(){return Date.now()+(this.client.serverTimeOffset||0)}isTimeOffsetSet(){return null!==this.client.serverTimeOffset}_saveBasicOptions(e){this.method="basic",this.key=e.key,this.basicKey=eM(e.key),this.authOptions=e||{},"clientId"in e&&this._userSetClientId(e.clientId)}_saveTokenOptions(e,t){this.method="token",e&&(this.tokenParams=e),t&&(t.token&&(t.tokenDetails="string"==typeof t.token?{token:t.token}:t.token),t.tokenDetails&&(this.tokenDetails=t.tokenDetails),"clientId"in t&&this._userSetClientId(t.clientId),this.authOptions=t)}async _ensureValidAuthCredentials(e){let t=this.tokenDetails;if(t){if(this._tokenClientIdMismatch(t.clientId))throw new P("Mismatch between clientId in token ("+t.clientId+") and current clientId ("+this.clientId+")",40102,403);if(!this.isTimeOffsetSet()||!t.expires||t.expires>=this.getTimestampUsingOffset())return T.logAction(this.logger,T.LOG_MINOR,"Auth.getToken()","using cached token; expires = "+t.expires),t;T.logAction(this.logger,T.LOG_MINOR,"Auth.getToken()","deleting expired token"),this.tokenDetails=null}let n=(this.waitingForTokenRequest||(this.waitingForTokenRequest=ej.create(this.logger))).createPromise();if(null!==this.currentTokenRequestId&&!e)return n;let i=this.currentTokenRequestId=eW++,r,o=null;try{r=await this.requestToken(this.tokenParams,this.authOptions)}catch(e){o=e}if(this.currentTokenRequestId>i)return T.logAction(this.logger,T.LOG_MINOR,"Auth._ensureValidAuthCredentials()","Discarding token request response; overtaken by newer one"),n;this.currentTokenRequestId=null;let s=this.waitingForTokenRequest;return(this.waitingForTokenRequest=null,o)?null==s||s.rejectAll(o):null==s||s.resolveAll(this.tokenDetails=r),n}_userSetClientId(e){if("string"==typeof e||null===e){if("*"===e)throw new P('Can’t use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, instantiate the library with {defaultTokenParams: {clientId: "*"}}), or if calling authorize(), pass it in as a tokenParam: authorize({clientId: "*"}, authOptions)',40012,400);{let t=this._uncheckedSetClientId(e);if(t)throw t}}else throw new P("clientId must be either a string or null",40012,400)}_uncheckedSetClientId(e){if(!this._tokenClientIdMismatch(e))return this.clientId=this.tokenParams.clientId=e,null;{let t="Unexpected clientId mismatch: client has "+this.clientId+", requested "+e,n=new P(t,40102,401);return T.logAction(this.logger,T.LOG_ERROR,"Auth._uncheckedSetClientId()",t),n}}_tokenClientIdMismatch(e){return!!(this.clientId&&"*"!==this.clientId&&e&&"*"!==e&&this.clientId!==e)}static isTokenErr(e){return e.code&&e.code>=40140&&e.code<40150}revokeTokens(e,t){return this.client.rest.revokeTokens(e,t)}};function eK(e){let t=[];if(e)for(let n in e)t.push(n+"="+e[n]);return t.join("&")}function e$(e,t){return e+(t?"?":"")+eK(t)}var eX=class{constructor(e){this.client=e,this.platformHttp=new E.Http(e),this.checkConnectivity=this.platformHttp.checkConnectivity?()=>this.platformHttp.checkConnectivity():void 0}get logger(){var e,t;return null!=(t=null==(e=this.client)?void 0:e.logger)?t:T.defaultLogger}get supportsAuthHeaders(){return this.platformHttp.supportsAuthHeaders}get supportsLinkHeaders(){return this.platformHttp.supportsLinkHeaders}_getHosts(e){let t=e.connection,n=t&&t.connectionManager.host;return n?[n].concat(eA.getFallbackHosts(e.options)):eA.getHosts(e.options)}async do(e,t,n,i,r){try{let o=this.client;if(!o)return{error:new P("http.do called without client",5e4,500)};let s="function"==typeof t?t:function(e){return o.baseUri(e)+t},a=o._currentFallback;if(a){if(a.validUntil>Date.now()){let l=await this.doUri(e,s(a.host),n,i,r);if(l.error&&this.platformHttp.shouldFallback(l.error))return o._currentFallback=null,this.do(e,t,n,i,r);return l}o._currentFallback=null}let l=this._getHosts(o);if(1===l.length)return this.doUri(e,s(l[0]),n,i,r);let c=null,u=async(t,a)=>{let l=t.shift();c=null!=c?c:new Date;let d=await this.doUri(e,s(l),n,i,r);if(d.error&&this.platformHttp.shouldFallback(d.error)&&t.length){let e=Date.now()-c.getTime();return e>o.options.timeouts.httpMaxRetryDuration?{error:new P(`Timeout for trying fallback hosts retries. Total elapsed time exceeded the ${o.options.timeouts.httpMaxRetryDuration}ms limit`,50003,500)}:u(t,!0)}return a&&(o._currentFallback={host:l,validUntil:Date.now()+o.options.timeouts.fallbackRetryTimeout}),d};return u(l)}catch(e){return{error:new P(`Unexpected error in Http.do: ${ea(e)}`,500,5e4)}}}async doUri(e,t,n,i,r){try{var o,s;(o=this.logger).shouldLog(T.LOG_MICRO)&&T.logActionNoStrip(o,T.LOG_MICRO,"Http."+e+"()","Sending; "+e$(t,r)+"; Body"+(E.BufferUtils.isBuffer(i)?" (Base64): "+E.BufferUtils.base64Encode(i):": "+i));let a=await this.platformHttp.doUri(e,t,n,i,r);return this.logger.shouldLog(T.LOG_MICRO)&&(s=this.logger,a.error?T.logActionNoStrip(s,T.LOG_MICRO,"Http."+e+"()","Received Error; "+e$(t,r)+"; Error: "+ea(a.error)):T.logActionNoStrip(s,T.LOG_MICRO,"Http."+e+"()","Received; "+e$(t,r)+"; Headers: "+eK(a.headers)+"; StatusCode: "+a.statusCode+"; Body"+(E.BufferUtils.isBuffer(a.body)?" (Base64): "+E.BufferUtils.base64Encode(a.body):": "+a.body))),a}catch(e){return{error:new P(`Unexpected error in Http.doUri: ${ea(e)}`,500,5e4)}}}},eQ=class{constructor(e){var t,n,i,r,o,s,a,l;this.Platform=E,this.ErrorInfo=P,this.Logger=T,this.Defaults=eA,this.Utils=L,this._additionalHTTPRequestImplementations=null!=(t=e.plugins)?t:null,this.logger=new T,this.logger.setLog(e.logLevel,e.logHandler),T.logAction(this.logger,T.LOG_MICRO,"BaseClient()","initialized with clientOptions "+E.Config.inspect(e)),this._MsgPack=null!=(i=null==(n=e.plugins)?void 0:n.MsgPack)?i:null;let c=this.options=eA.normaliseOptions(e,this._MsgPack,this.logger);if(c.key){let e=c.key.match(/^([^:\s]+):([^:.\s]+)$/);if(!e){let e="invalid key parameter";throw T.logAction(this.logger,T.LOG_ERROR,"BaseClient()",e),new P(e,40400,404)}c.keyName=e[1],c.keySecret=e[2]}if("clientId"in c){if("string"==typeof c.clientId||null===c.clientId){if("*"===c.clientId)throw new P('Can’t use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, use {defaultTokenParams: {clientId: "*"}})',40012,400)}else throw new P("clientId must be either a string or null",40012,400)}T.logAction(this.logger,T.LOG_MINOR,"BaseClient()","started; version = "+eA.version),this._currentFallback=null,this.serverTimeOffset=null,this.http=new eX(this),this.auth=new eJ(this,c),this._rest=(null==(r=e.plugins)?void 0:r.Rest)?new e.plugins.Rest(this):null,this._Crypto=null!=(s=null==(o=e.plugins)?void 0:o.Crypto)?s:null,this.__FilteredSubscriptions=null!=(l=null==(a=e.plugins)?void 0:a.MessageInteractions)?l:null}get rest(){return this._rest||eO("Rest"),this._rest}get _FilteredSubscriptions(){return this.__FilteredSubscriptions||eO("MessageInteractions"),this.__FilteredSubscriptions}get channels(){return this.rest.channels}get push(){return this.rest.push}get device(){var e;return(null==(e=this.options.plugins)?void 0:e.Push)&&this.push.LocalDevice||eO("Push"),this._device||(this._device=this.push.LocalDevice.load(this)),this._device}baseUri(e){return eA.getHttpScheme(this.options)+e+":"+eA.getPort(this.options,!1)}async stats(e){return this.rest.stats(e)}async time(e){return this.rest.time(e)}async request(e,t,n,i,r,o){return this.rest.request(e,t,n,i,r,o)}batchPublish(e){return this.rest.batchPublish(e)}batchPresence(e){return this.rest.batchPresence(e)}setLog(e){this.logger.setLog(e.level,e.handler)}};eQ.Platform=E;var eZ=eQ,e0=class e{toJSON(){var e,t,n;return{id:this.id,deviceSecret:this.deviceSecret,platform:this.platform,formFactor:this.formFactor,clientId:this.clientId,metadata:this.metadata,deviceIdentityToken:this.deviceIdentityToken,push:{recipient:null==(e=this.push)?void 0:e.recipient,state:null==(t=this.push)?void 0:t.state,error:null==(n=this.push)?void 0:n.error}}}toString(){var e,t,n,i;let r="[DeviceDetails";return this.id&&(r+="; id="+this.id),this.platform&&(r+="; platform="+this.platform),this.formFactor&&(r+="; formFactor="+this.formFactor),this.clientId&&(r+="; clientId="+this.clientId),this.metadata&&(r+="; metadata="+this.metadata),this.deviceIdentityToken&&(r+="; deviceIdentityToken="+JSON.stringify(this.deviceIdentityToken)),(null==(e=this.push)?void 0:e.recipient)&&(r+="; push.recipient="+JSON.stringify(this.push.recipient)),(null==(t=this.push)?void 0:t.state)&&(r+="; push.state="+this.push.state),(null==(n=this.push)?void 0:n.error)&&(r+="; push.error="+JSON.stringify(this.push.error)),(null==(i=this.push)?void 0:i.metadata)&&(r+="; push.metadata="+this.push.metadata),r+="]"}static toRequestBody(e,t,n){return ep(e,t,n)}static fromResponseBody(t,n,i){return(i&&(t=ef(t,n,i)),Array.isArray(t))?e.fromValuesArray(t):e.fromValues(t)}static fromValues(t){return t.error=t.error&&P.fromValues(t.error),Object.assign(new e,t)}static fromLocalDevice(t){return Object.assign(new e,t)}static fromValuesArray(t){let n=t.length,i=Array(n);for(let r=0;r<n;r++)i[r]=e.fromValues(t[r]);return i}};async function e1(e,t,n,i){if(e.http.supportsAuthHeaders){let r=await e.auth.getAuthHeaders();return i(N(r,t),n)}{let r=await e.auth.getAuthParams();return i(t,N(r,n))}}var e2=class e{static async get(t,n,i,r,o,s){return e.do(eG.Get,t,n,null,i,r,o,null!=s&&s)}static async delete(t,n,i,r,o,s){return e.do(eG.Delete,t,n,null,i,r,o,s)}static async post(t,n,i,r,o,s,a){return e.do(eG.Post,t,n,i,r,o,s,a)}static async patch(t,n,i,r,o,s,a){return e.do(eG.Patch,t,n,i,r,o,s,a)}static async put(t,n,i,r,o,s,a){return e.do(eG.Put,t,n,i,r,o,s,a)}static async do(e,t,n,i,r,o,s,a){s&&((o=o||{}).envelope=s);let l=t.logger;async function c(r,o){var s;if(l.shouldLog(T.LOG_MICRO)){let a=i;if((null==(s=r["content-type"])?void 0:s.indexOf("msgpack"))>0)try{t._MsgPack||eO("MsgPack"),a=t._MsgPack.decode(i)}catch(t){T.logAction(l,T.LOG_MICRO,"Resource."+e+"()","Sending MsgPack Decoding Error: "+ea(t))}T.logAction(l,T.LOG_MICRO,"Resource."+e+"()","Sending; "+e$(n,o)+"; Body: "+a)}let a=await t.http.do(e,n,r,i,o);return a.error&&eJ.isTokenErr(a.error)?(await t.auth.authorize(null,null),e1(t,r,o,c)):{err:a.error,body:a.body,headers:a.headers,unpacked:a.unpacked,statusCode:a.statusCode}}let u=await e1(t,r,o,c);if(s&&(u=function(e,t,n){if(e.err&&!e.body)return{err:e.err};if(e.statusCode===eU.NoContent)return S(_({},e),{body:[],unpacked:!0});let i=e.body;if(!e.unpacked)try{i=ef(i,t,n)}catch(e){if(es(e))return{err:e};return{err:new D(ea(e),null)}}if(!i)return{err:new D("unenvelope(): Response body is missing",null)};let{statusCode:r,response:o,headers:s}=i;if(void 0===r)return S(_({},e),{body:i,unpacked:!0});if(r<200||r>=300){let t=o&&o.error||e.err;return t||((t=Error("Error in unenveloping "+i)).statusCode=r),{err:t,body:o,headers:s,unpacked:!0,statusCode:r}}return{err:e.err,body:o,headers:s,unpacked:!0,statusCode:r}}(u,t._MsgPack,s)),l.shouldLog(T.LOG_MICRO)){var d,h;d=u,h=o,d.err?T.logAction(l,T.LOG_MICRO,"Resource."+e+"()","Received Error; "+e$(n,h)+"; Error: "+ea(d.err)):T.logAction(l,T.LOG_MICRO,"Resource."+e+"()","Received; "+e$(n,h)+"; Headers: "+eK(d.headers)+"; StatusCode: "+d.statusCode+"; Body: "+(E.BufferUtils.isBuffer(d.body)?" (Base64): "+E.BufferUtils.base64Encode(d.body):": "+E.Config.inspect(d.body)))}if(a){if(u.err)throw u.err;{let e=_({},u);return delete e.err,e}}return u}},e4=class{constructor(e,t,n,i,r,o){this.client=e,this.path=t,this.headers=n,this.envelope=null!=i?i:null,this.bodyHandler=r,this.useHttpPaginatedResponse=o||!1}get logger(){return this.client.logger}async get(e){let t=await e2.get(this.client,this.path,this.headers,e,this.envelope,!1);return this.handlePage(t)}async delete(e){let t=await e2.delete(this.client,this.path,this.headers,e,this.envelope,!1);return this.handlePage(t)}async post(e,t){let n=await e2.post(this.client,this.path,t,this.headers,e,this.envelope,!1);return this.handlePage(n)}async put(e,t){let n=await e2.put(this.client,this.path,t,this.headers,e,this.envelope,!1);return this.handlePage(n)}async patch(e,t){let n=await e2.patch(this.client,this.path,t,this.headers,e,this.envelope,!1);return this.handlePage(n)}async handlePage(e){var t,n;let i,r,o;if(e.err&&(t=e.err,n=e.body,!(this.useHttpPaginatedResponse&&(n||"number"==typeof t.code))))throw T.logAction(this.logger,T.LOG_ERROR,"PaginatedResource.handlePage()","Unexpected error getting resource: err = "+ea(e.err)),e.err;try{i=e.statusCode==eU.NoContent?[]:await this.bodyHandler(e.body,e.headers||{},e.unpacked)}catch(t){throw e.err||t}return(e.headers&&(r=e.headers.Link||e.headers.link)&&(o=function(e){"string"==typeof e&&(e=e.split(","));let t={};for(let n=0;n<e.length;n++){let i=e[n].match(/^\s*<(.+)>;\s*rel="(\w+)"$/);if(i){let e=function(e){let t=e.match(/^\.\/(\w+)\?(.*)$/);return t&&t[2]&&eo(t[2])}(i[1]);e&&(t[i[2]]=e)}}return t}(r)),this.useHttpPaginatedResponse)?new e3(this,i,e.headers||{},e.statusCode,o,e.err):new e8(this,i,o)}},e8=class{constructor(e,t,n){this.resource=e,this.items=t;let i=this;n&&("first"in n&&(this.first=async function(){return i.get(n.first)}),"current"in n&&(this.current=async function(){return i.get(n.current)}),this.next=async function(){return"next"in n?i.get(n.next):null},this.hasNext=function(){return"next"in n},this.isLast=()=>{var e;return!(null==(e=this.hasNext)?void 0:e.call(this))})}async get(e){let t=this.resource,n=await e2.get(t.client,t.path,t.headers,e,t.envelope,!1);return t.handlePage(n)}},e3=class extends e8{constructor(e,t,n,i,r,o){super(e,t,r),this.statusCode=i,this.success=i<300&&i>=200,this.headers=n,this.errorCode=o&&o.code,this.errorMessage=o&&o.message}toJSON(){return{items:this.items,statusCode:this.statusCode,success:this.success,headers:this.headers,errorCode:this.errorCode,errorMessage:this.errorMessage}}},e6=class e{toJSON(){return{channel:this.channel,deviceId:this.deviceId,clientId:this.clientId}}toString(){let e="[PushChannelSubscription";return this.channel&&(e+="; channel="+this.channel),this.deviceId&&(e+="; deviceId="+this.deviceId),this.clientId&&(e+="; clientId="+this.clientId),e+="]"}static fromResponseBody(t,n,i){return(i&&(t=ef(t,n,i)),Array.isArray(t))?e.fromValuesArray(t):e.fromValues(t)}static fromValues(t){return Object.assign(new e,t)}static fromValuesArray(t){let n=t.length,i=Array(n);for(let r=0;r<n;r++)i[r]=e.fromValues(t[r]);return i}};e6.toRequestBody=ep;var e5=class{constructor(e){var t;this.client=e,this.admin=new e9(e),E.Config.push&&(null==(t=e.options.plugins)?void 0:t.Push)&&(this.stateMachine=new e.options.plugins.Push.ActivationStateMachine(e),this.LocalDevice=e.options.plugins.Push.localDeviceFactory(e0))}async activate(e,t){await new Promise((n,i)=>{var r;if(!(null==(r=this.client.options.plugins)?void 0:r.Push)){i(eE("Push"));return}if(!this.stateMachine){i(new P("This platform is not supported as a target of push notifications",4e4,400));return}if(this.stateMachine.activatedCallback){i(new P("Activation already in progress",4e4,400));return}this.stateMachine.activatedCallback=e=>{if(e){i(e);return}n()},this.stateMachine.updateFailedCallback=t,this.stateMachine.handleEvent(new this.client.options.plugins.Push.CalledActivate(this.stateMachine,e))})}async deactivate(e){await new Promise((t,n)=>{var i;if(!(null==(i=this.client.options.plugins)?void 0:i.Push)){n(eE("Push"));return}if(!this.stateMachine){n(new P("This platform is not supported as a target of push notifications",4e4,400));return}if(this.stateMachine.deactivatedCallback){n(new P("Deactivation already in progress",4e4,400));return}this.stateMachine.deactivatedCallback=e=>{if(e){n(e);return}t()},this.stateMachine.handleEvent(new this.client.options.plugins.Push.CalledDeactivate(this.stateMachine,e))})}},e9=class{constructor(e){this.client=e,this.deviceRegistrations=new e7(e),this.channelSubscriptions=new te(e)}async publish(e,t){let n=this.client,i=n.options.useBinaryProtocol?"msgpack":"json",r=eA.defaultPostHeaders(n.options,{format:i}),o={},s=N({recipient:e},t);N(r,n.options.headers),n.options.pushFullWait&&N(o,{fullWait:"true"});let a=ep(s,n._MsgPack,i);await e2.post(n,"/push/publish",a,r,o,null,!0)}},e7=class{constructor(e){this.client=e}async save(e){let t=this.client,n=e0.fromValues(e),i=t.options.useBinaryProtocol?"msgpack":"json",r=eA.defaultPostHeaders(t.options,{format:i}),o={};N(r,t.options.headers),t.options.pushFullWait&&N(o,{fullWait:"true"});let s=ep(n,t._MsgPack,i),a=await e2.put(t,"/push/deviceRegistrations/"+encodeURIComponent(e.id),s,r,o,null,!0);return e0.fromResponseBody(a.body,t._MsgPack,a.unpacked?void 0:i)}async get(e){let t=this.client,n=t.options.useBinaryProtocol?"msgpack":"json",i=eA.defaultGetHeaders(t.options,{format:n}),r=e.id||e;if("string"!=typeof r||!r.length)throw new P("First argument to DeviceRegistrations#get must be a deviceId string or DeviceDetails",4e4,400);N(i,t.options.headers);let o=await e2.get(t,"/push/deviceRegistrations/"+encodeURIComponent(r),i,{},null,!0);return e0.fromResponseBody(o.body,t._MsgPack,o.unpacked?void 0:n)}async list(e){let t=this.client,n=t.options.useBinaryProtocol?"msgpack":"json",i=this.client.http.supportsLinkHeaders?void 0:n,r=eA.defaultGetHeaders(t.options,{format:n});return N(r,t.options.headers),new e4(t,"/push/deviceRegistrations",r,i,async function(e,i,r){return e0.fromResponseBody(e,t._MsgPack,r?void 0:n)}).get(e)}async remove(e){let t=this.client,n=t.options.useBinaryProtocol?"msgpack":"json",i=eA.defaultGetHeaders(t.options,{format:n}),r={},o=e.id||e;if("string"!=typeof o||!o.length)throw new P("First argument to DeviceRegistrations#remove must be a deviceId string or DeviceDetails",4e4,400);N(i,t.options.headers),t.options.pushFullWait&&N(r,{fullWait:"true"}),await e2.delete(t,"/push/deviceRegistrations/"+encodeURIComponent(o),i,r,null,!0)}async removeWhere(e){let t=this.client,n=t.options.useBinaryProtocol?"msgpack":"json",i=eA.defaultGetHeaders(t.options,{format:n});N(i,t.options.headers),t.options.pushFullWait&&N(e,{fullWait:"true"}),await e2.delete(t,"/push/deviceRegistrations",i,e,null,!0)}},te=class e{constructor(t){this.remove=e.prototype.removeWhere,this.client=t}async save(e){let t=this.client,n=e6.fromValues(e),i=t.options.useBinaryProtocol?"msgpack":"json",r=eA.defaultPostHeaders(t.options,{format:i}),o={};N(r,t.options.headers),t.options.pushFullWait&&N(o,{fullWait:"true"});let s=ep(n,t._MsgPack,i),a=await e2.post(t,"/push/channelSubscriptions",s,r,o,null,!0);return e6.fromResponseBody(a.body,t._MsgPack,a.unpacked?void 0:i)}async list(e){let t=this.client,n=t.options.useBinaryProtocol?"msgpack":"json",i=this.client.http.supportsLinkHeaders?void 0:n,r=eA.defaultGetHeaders(t.options,{format:n});return N(r,t.options.headers),new e4(t,"/push/channelSubscriptions",r,i,async function(e,i,r){return e6.fromResponseBody(e,t._MsgPack,r?void 0:n)}).get(e)}async removeWhere(e){let t=this.client,n=t.options.useBinaryProtocol?"msgpack":"json",i=eA.defaultGetHeaders(t.options,{format:n});N(i,t.options.headers),t.options.pushFullWait&&N(e,{fullWait:"true"}),await e2.delete(t,"/push/channelSubscriptions",i,e,null,!0)}async listChannels(e){let t=this.client,n=t.options.useBinaryProtocol?"msgpack":"json",i=this.client.http.supportsLinkHeaders?void 0:n,r=eA.defaultGetHeaders(t.options,{format:n});return N(r,t.options.headers),t.options.pushFullWait&&N(e,{fullWait:"true"}),new e4(t,"/push/channels",r,i,async function(e,i,r){let o=!r&&n?ef(e,t._MsgPack,n):e;for(let e=0;e<o.length;e++)o[e]=String(o[e]);return o}).get(e)}};async function tt(e,t,n,i){let r=tl(n),o=function(e,t,n){if(n&&n.cipher){e||eO("Crypto");let i=e.getCipher(n.cipher,t);return{cipher:i.cipherParams,channelCipher:i.cipher}}return null!=n?n:{}}(t,e,null!=i?i:null);try{await ts(r,o)}catch(t){T.logAction(e,T.LOG_ERROR,"Message.fromEncoded()",t.toString())}return r}async function tn(e,t,n,i){return Promise.all(n.map(function(n){return tt(e,t,n,i)}))}async function ti(e,t){let n=e.data,i=e.encoding,r=t.channelCipher;i=i?i+"/":"",E.BufferUtils.isBuffer(n)||(n=E.BufferUtils.utf8Encode(String(n)),i+="utf-8/");let o=await r.encrypt(n);return e.data=o,e.encoding=i+"cipher+"+r.algorithm,e}async function tr(e,t){let n=e.data,i="string"==typeof n||E.BufferUtils.isBuffer(n)||null==n;if(!i){if(j(n)||Array.isArray(n))e.data=JSON.stringify(n),e.encoding=e.encoding?e.encoding+"/json":"json";else throw new P("Data type is unsupported",40013,400)}return null!=t&&t.cipher?ti(e,t):e}async function to(e,t){return Promise.all(e.map(e=>tr(e,t)))}async function ts(e,t){let n=t&&t.channelOptions?t:{channelOptions:t,plugins:{},baseEncodedPreviousPayload:void 0},i=e.data,r=e.encoding;if(r){let t=r.split("/"),o,s=t.length,a=e.data,l="";try{for(;(o=s)>0;){let e=t[--s].match(/([-\w]+)(\+([\w-]+))?/);if(!e)break;switch(l=e[1]){case"base64":a=E.BufferUtils.base64Decode(String(a)),o==t.length&&(i=a);continue;case"utf-8":a=E.BufferUtils.utf8Decode(a);continue;case"json":a=JSON.parse(a);continue;case"cipher":if(null!=n.channelOptions&&n.channelOptions.cipher&&n.channelOptions.channelCipher){let t=e[3],i=n.channelOptions.channelCipher;if(t!=i.algorithm)throw Error("Unable to decrypt message with given cipher; incompatible cipher params");a=await i.decrypt(a);continue}throw Error("Unable to decrypt message; not an encrypted channel");case"vcdiff":if(!n.plugins||!n.plugins.vcdiff)throw new P("Missing Vcdiff decoder (https://github.com/ably-forks/vcdiff-decoder)",40019,400);if("undefined"==typeof Uint8Array)throw new P("Delta decoding not supported on this browser (need ArrayBuffer & Uint8Array)",40020,400);try{let e=n.baseEncodedPreviousPayload;"string"==typeof e&&(e=E.BufferUtils.utf8Encode(e));let t=E.BufferUtils.toBuffer(e);a=E.BufferUtils.toBuffer(a),i=a=E.BufferUtils.arrayBufferViewToBuffer(n.plugins.vcdiff.decode(a,t))}catch(e){throw new P("Vcdiff delta decode failed with "+e,40018,400)}continue;default:throw Error("Unknown encoding")}}}catch(e){throw new P("Error processing the "+l+" encoding, decoder returned ‘"+e.message+"’",e.code||40013,400)}finally{e.encoding=o<=0?null:t.slice(0,o).join("/"),e.data=a}}n.baseEncodedPreviousPayload=i}async function ta(e,t,n,i,r){r&&(e=ef(e,i,r));for(let i=0;i<e.length;i++){let r=e[i]=tl(e[i]);try{await ts(r,t)}catch(e){T.logAction(n,T.LOG_ERROR,"Message.fromResponseBody()",e.toString())}}return e}function tl(e){return Object.assign(new td,e)}function tc(e){let t=e.length,n=Array(t);for(let i=0;i<t;i++)n[i]=tl(e[i]);return n}function tu(e){let t,n=0;for(let i=0;i<e.length;i++)n+=(t=e[i]).size||(t.size=function(e){let t=0;return e.name&&(t+=e.name.length),e.clientId&&(t+=e.clientId.length),e.extras&&(t+=JSON.stringify(e.extras).length),e.data&&(t+=ec(e.data)),t}(t));return n}var td=class{toJSON(){let e=this.encoding,t=this.data;return t&&E.BufferUtils.isBuffer(t)&&(arguments.length>0?(e=e?e+"/base64":"base64",t=E.BufferUtils.base64Encode(t)):t=E.BufferUtils.toBuffer(t)),{name:this.name,id:this.id,clientId:this.clientId,connectionId:this.connectionId,connectionKey:this.connectionKey,extras:this.extras,encoding:e,data:t}}toString(){let e="[Message";return this.name&&(e+="; name="+this.name),this.id&&(e+="; id="+this.id),this.timestamp&&(e+="; timestamp="+this.timestamp),this.clientId&&(e+="; clientId="+this.clientId),this.connectionId&&(e+="; connectionId="+this.connectionId),this.encoding&&(e+="; encoding="+this.encoding),this.extras&&(e+="; extras ="+JSON.stringify(this.extras)),this.data&&("string"==typeof this.data?e+="; data="+this.data:E.BufferUtils.isBuffer(this.data)?e+="; data (buffer)="+E.BufferUtils.base64Encode(this.data):e+="; data (json)="+JSON.stringify(this.data)),this.extras&&(e+="; extras="+JSON.stringify(this.extras)),e+="]"}},th=td,tg=["absent","present","enter","leave","update"];async function tf(e,t,n){let i=tm(t,!0);try{await tb(i,null!=n?n:{})}catch(t){T.logAction(e,T.LOG_ERROR,"PresenceMessage.fromEncoded()",t.toString())}return i}async function tp(e,t,n){return Promise.all(t.map(function(t){return tf(e,t,n)}))}function tm(e,t){return t&&(e.action=tg[e.action]),Object.assign(new t_,e)}var tb=ts;async function ty(e,t,n,i,r){let o=[];r&&(e=ef(e,i,r));for(let i=0;i<e.length;i++){let r=o[i]=tm(e[i],!0);try{await tb(r,t)}catch(e){T.logAction(n,T.LOG_ERROR,"PresenceMessage.fromResponseBody()",e.toString())}}return o}function tv(e){let t=e.length,n=Array(t);for(let i=0;i<t;i++)n[i]=tm(e[i]);return n}function tw(e){return e instanceof t_?e:tm({data:e})}var t_=class{isSynthesized(){return!this.id||!this.connectionId||this.id.substring(this.connectionId.length,0)!==this.connectionId}parseId(){if(!this.id)throw Error("parseId(): Presence message does not contain an id");let e=this.id.split(":");return{connectionId:e[0],msgSerial:parseInt(e[1],10),index:parseInt(e[2],10)}}toJSON(){var e;let t=this.data,n=this.encoding;return t&&E.BufferUtils.isBuffer(t)&&(arguments.length>0?(n=n?n+"/base64":"base64",t=E.BufferUtils.base64Encode(t)):t=E.BufferUtils.toBuffer(t)),{id:this.id,clientId:this.clientId,action:(e=this.action,tg.indexOf(e)),data:t,encoding:n,extras:this.extras}}toString(){let e="[PresenceMessage";return e+="; action="+this.action,this.id&&(e+="; id="+this.id),this.timestamp&&(e+="; timestamp="+this.timestamp),this.clientId&&(e+="; clientId="+this.clientId),this.connectionId&&(e+="; connectionId="+this.connectionId),this.encoding&&(e+="; encoding="+this.encoding),this.data&&("string"==typeof this.data?e+="; data="+this.data:E.BufferUtils.isBuffer(this.data)?e+="; data (buffer)="+E.BufferUtils.base64Encode(this.data):e+="; data (json)="+JSON.stringify(this.data)),this.extras&&(e+="; extras="+JSON.stringify(this.extras)),e+="]"}},tS=t_,tC=class{constructor(e){this.channel=e}get logger(){return this.channel.logger}async get(e){T.logAction(this.logger,T.LOG_MICRO,"RestPresence.get()","channel = "+this.channel.name);let t=this.channel.client,n=t.options.useBinaryProtocol?"msgpack":"json",i=this.channel.client.http.supportsLinkHeaders?void 0:n,r=eA.defaultGetHeaders(t.options,{format:n});N(r,t.options.headers);let o=this.channel.channelOptions;return new e4(t,this.channel.client.rest.presenceMixin.basePath(this),r,i,async(e,i,r)=>await ty(e,o,this.logger,t._MsgPack,r?void 0:n)).get(e)}async history(e){return T.logAction(this.logger,T.LOG_MICRO,"RestPresence.history()","channel = "+this.channel.name),this.channel.client.rest.presenceMixin.history(this,e)}},tM=class{constructor(e,t,n){var i,r;T.logAction(e.logger,T.LOG_MINOR,"RestChannel()","started; name = "+t),this.name=t,this.client=e,this.presence=new tC(this),this.channelOptions=eN(null!=(i=e._Crypto)?i:null,this.logger,n),(null==(r=e.options.plugins)?void 0:r.Push)&&(this._push=new e.options.plugins.Push.PushChannel(this))}get push(){return this._push||eO("Push"),this._push}get logger(){return this.client.logger}setOptions(e){var t;this.channelOptions=eN(null!=(t=this.client._Crypto)?t:null,this.logger,e)}async history(e){return T.logAction(this.logger,T.LOG_MICRO,"RestChannel.history()","channel = "+this.name),this.client.rest.channelMixin.history(this,e)}async publish(...e){let t,n;let i=e[0],r=e[1];if("string"==typeof i||null===i)t=[tl({name:i,data:r})],n=e[2];else if(j(i))t=[tl(i)],n=e[1];else if(Array.isArray(i))t=tc(i),n=e[1];else throw new P("The single-argument form of publish() expects a message object or an array of message objects",40013,400);n||(n={});let o=this.client,s=o.options,a=s.useBinaryProtocol?"msgpack":"json",l=o.options.idempotentRestPublishing,c=eA.defaultPostHeaders(o.options,{format:a});if(N(c,s.headers),l&&t.every(function(e){return!e.id})){let e=await ed(9);t.forEach(function(t,n){t.id=e+":"+n.toString()})}await to(t,this.channelOptions);let u=tu(t),d=s.maxMessageSize;if(u>d)throw new P("Maximum size of messages that can be published at once exceeded ( was "+u+" bytes; limit is "+d+" bytes)",40009,400);await this._publish(ep(t,o._MsgPack,a),c,n)}async _publish(e,t,n){await e2.post(this.client,this.client.rest.channelMixin.basePath(this)+"/messages",e,t,n,null,!0)}async status(){return this.client.rest.channelMixin.status(this)}},tR=class e{constructor(e){this.entries=e&&e.entries||void 0,this.schema=e&&e.schema||void 0,this.appId=e&&e.appId||void 0,this.inProgress=e&&e.inProgress||void 0,this.unit=e&&e.unit||void 0,this.intervalId=e&&e.intervalId||void 0}static fromValues(t){return new e(t)}},tE=class{static basePath(e){return"/channels/"+encodeURIComponent(e.name)}static history(e,t){let n=e.client,i=n.options.useBinaryProtocol?"msgpack":"json",r=e.client.http.supportsLinkHeaders?void 0:i,o=eA.defaultGetHeaders(n.options,{format:i});N(o,n.options.headers);let s=e.channelOptions;return new e4(n,this.basePath(e)+"/messages",o,r,async function(t,r,o){return await ta(t,s,e.logger,n._MsgPack,o?void 0:i)}).get(t)}static async status(e){let t=e.client.options.useBinaryProtocol?"msgpack":"json",n=eA.defaultPostHeaders(e.client.options,{format:t}),i=await e2.get(e.client,this.basePath(e),n,{},t,!0);return i.body}},tO=class{static basePath(e){return tE.basePath(e.channel)+"/presence"}static async history(e,t){let n=e.channel.client,i=n.options.useBinaryProtocol?"msgpack":"json",r=e.channel.client.http.supportsLinkHeaders?void 0:i,o=eA.defaultGetHeaders(n.options,{format:i});N(o,n.options.headers);let s=e.channel.channelOptions;return new e4(n,this.basePath(e)+"/history",o,r,async function(t,r,o){return await ty(t,s,e.logger,n._MsgPack,o?void 0:i)}).get(t)}},tk=class{constructor(e){this.channelMixin=tE,this.presenceMixin=tO,this.Resource=e2,this.DeviceDetails=e0,this.client=e,this.channels=new tx(this.client),this.push=new e5(this.client)}async stats(e){let t=eA.defaultGetHeaders(this.client.options),n=this.client.options.useBinaryProtocol?"msgpack":"json",i=this.client.http.supportsLinkHeaders?void 0:n;return N(t,this.client.options.headers),new e4(this.client,"/stats",t,i,function(e,t,n){let i=n?e:JSON.parse(e);for(let e=0;e<i.length;e++)i[e]=tR.fromValues(i[e]);return i}).get(e)}async time(e){let t=eA.defaultGetHeaders(this.client.options);this.client.options.headers&&N(t,this.client.options.headers);let{error:n,body:i,unpacked:r}=await this.client.http.do(eG.Get,e=>this.client.baseUri(e)+"/time",t,null,e);if(n)throw n;r||(i=JSON.parse(i));let o=i[0];if(!o)throw new P("Internal error (unexpected result type from GET /time)",5e4,500);return this.client.serverTimeOffset=o-Date.now(),o}async request(e,t,n,i,r,o){var s;let[a,l,c]=this.client.options.useBinaryProtocol?(this.client._MsgPack||eO("MsgPack"),[this.client._MsgPack.encode,this.client._MsgPack.decode,"msgpack"]):[JSON.stringify,JSON.parse,"json"],u=this.client.http.supportsLinkHeaders?void 0:c;i=i||{};let d=e.toLowerCase(),h="get"==d?eA.defaultGetHeaders(this.client.options,{format:c,protocolVersion:n}):eA.defaultPostHeaders(this.client.options,{format:c,protocolVersion:n});"string"!=typeof r&&(r=null!=(s=a(r))?s:null),N(h,this.client.options.headers),o&&N(h,o);let g=new e4(this.client,t,h,u,async function(e,t,n){return H(n?e:l(e))},!0);if(!E.Http.methods.includes(d))throw new P("Unsupported method "+d,40500,405);return E.Http.methodsWithBody.includes(d)?g[d](i,r):g[d](i)}async batchPublish(e){let t,n;Array.isArray(e)?(t=e,n=!1):(t=[e],n=!0);let i=this.client.options.useBinaryProtocol?"msgpack":"json",r=eA.defaultPostHeaders(this.client.options,{format:i});this.client.options.headers&&N(r,this.client.options.headers);let o=ep(t,this.client._MsgPack,i),s=await e2.post(this.client,"/messages",o,r,{},null,!0),a=s.unpacked?s.body:ef(s.body,this.client._MsgPack,i);return n?a[0]:a}async batchPresence(e){let t=this.client.options.useBinaryProtocol?"msgpack":"json",n=eA.defaultPostHeaders(this.client.options,{format:t});this.client.options.headers&&N(n,this.client.options.headers);let i=e.join(","),r=await e2.get(this.client,"/presence",n,{channels:i},null,!0);return r.unpacked?r.body:ef(r.body,this.client._MsgPack,t)}async revokeTokens(e,t){if(ez(this.client.options))throw new P("Cannot revoke tokens when using token auth",40162,401);let n=this.client.options.keyName,i=null!=t?t:{},r=_({targets:e.map(e=>`${e.type}:${e.value}`)},i),o=this.client.options.useBinaryProtocol?"msgpack":"json",s=eA.defaultPostHeaders(this.client.options,{format:o});this.client.options.headers&&N(s,this.client.options.headers);let a=ep(r,this.client._MsgPack,o),l=await e2.post(this.client,`/keys/${n}/revokeTokens`,a,s,{},null,!0);return l.unpacked?l.body:ef(l.body,this.client._MsgPack,o)}},tx=class{constructor(e){this.client=e,this.all=Object.create(null)}get(e,t){e=String(e);let n=this.all[e];return n?t&&n.setOptions(t):this.all[e]=n=new tM(this.client,e,t),n}release(e){delete this.all[String(e)]}},tA=class extends eZ{constructor(e){super(eA.objectifyOptions(e,!1,"BaseRest",T.defaultLogger,{Rest:tk}))}},tT={Rest:tk},tL=class extends th{static async fromEncoded(e,t){return tt(T.defaultLogger,E.Crypto,e,t)}static async fromEncodedArray(e,t){return tn(T.defaultLogger,E.Crypto,e,t)}static fromValues(e){return Object.assign(new th,e)}static async encode(e,t){return tr(e,t)}static async decode(e,t){return ts(e,t)}},tI=class extends tS{static async fromEncoded(e,t){return tf(T.defaultLogger,e,t)}static async fromEncodedArray(e,t){return tp(T.defaultLogger,e,t)}static fromValues(e,t){return tm(e,t)}},tP=class e extends tA{constructor(t){var n,i;let r=e._MsgPack;if(!r)throw Error("Expected DefaultRest._MsgPack to have been set");super(eA.objectifyOptions(t,!0,"Rest",T.defaultLogger,S(_({},tT),{Crypto:null!=(n=e.Crypto)?n:void 0,MsgPack:null!=(i=e._MsgPack)?i:void 0})))}static get Crypto(){if(null===this._Crypto)throw Error("Encryption not enabled; use ably.encryption.js instead");return this._Crypto}static set Crypto(e){this._Crypto=e}};tP._Crypto=null,tP.Message=tL,tP.PresenceMessage=tI,tP._MsgPack=null,tP._Http=eX;var tD=tP;function tN(e,t,n){let i,r,o;for(let s=0;s<e.length;s++)if(i=e[s],n&&(i=i[n]),Array.isArray(i)){for(;-1!==(r=i.indexOf(t));)i.splice(r,1);n&&0===i.length&&delete e[s][n]}else if(j(i))for(o in i)Object.prototype.hasOwnProperty.call(i,o)&&Array.isArray(i[o])&&tN([i],t,o)}var tF=class{constructor(e){this.logger=e,this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null)}on(...e){if(1===e.length){let t=e[0];if("function"==typeof t)this.any.push(t);else throw Error("EventListener.on(): Invalid arguments: "+E.Config.inspect(e))}if(2===e.length){let[t,n]=e;if("function"!=typeof n)throw Error("EventListener.on(): Invalid arguments: "+E.Config.inspect(e));if(U(t))this.any.push(n);else if(Array.isArray(t))t.forEach(e=>{this.on(e,n)});else{if("string"!=typeof t)throw Error("EventListener.on(): Invalid arguments: "+E.Config.inspect(e));let i=this.events[t]||(this.events[t]=[]);i.push(n)}}}off(...e){if(0==e.length||U(e[0])&&U(e[1])){this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null);return}let[t,n]=e,i=null,r=null;if(1!==e.length&&n){if("function"!=typeof n)throw Error("EventEmitter.off(): invalid arguments:"+E.Config.inspect(e));[r,i]=[t,n]}else"function"==typeof t?i=t:r=t;if(i&&U(r)){tN([this.any,this.events,this.anyOnce,this.eventsOnce],i);return}if(Array.isArray(r)){r.forEach(e=>{this.off(e,i)});return}if("string"!=typeof r)throw Error("EventEmitter.off(): invalid arguments:"+E.Config.inspect(e));i?tN([this.events,this.eventsOnce],i,r):(delete this.events[r],delete this.eventsOnce[r])}listeners(e){if(e){let t=this.events[e]||[];return this.eventsOnce[e]&&Array.prototype.push.apply(t,this.eventsOnce[e]),t.length?t:null}return this.any.length?this.any:null}emit(e,...t){let n={event:e},i=[];this.anyOnce.length&&(Array.prototype.push.apply(i,this.anyOnce),this.anyOnce=[]),this.any.length&&Array.prototype.push.apply(i,this.any);let r=this.eventsOnce[e];r&&(Array.prototype.push.apply(i,r),delete this.eventsOnce[e]);let o=this.events[e];o&&Array.prototype.push.apply(i,o),i.forEach(e=>{!function(e,t,n,i){try{n.apply(t,i)}catch(t){T.logAction(e,T.LOG_ERROR,"EventEmitter.emit()","Unexpected listener exception: "+t+"; stack = "+(t&&t.stack))}}(this.logger,n,e,t)})}once(...e){let t=e.length;if(0===t||1===t&&"function"!=typeof e[0]){let t=e[0];return new Promise(e=>{this.once(t,e)})}let[n,i]=e;if(1===e.length&&"function"==typeof n)this.anyOnce.push(n);else if(U(n)){if("function"!=typeof i)throw Error("EventEmitter.once(): Invalid arguments:"+E.Config.inspect(e));this.anyOnce.push(i)}else if(Array.isArray(n)){let t=this,r=function(){let o=Array.prototype.slice.call(arguments);if(n.forEach(function(e){t.off(e,r)}),"function"!=typeof i)throw Error("EventEmitter.once(): Invalid arguments:"+E.Config.inspect(e));i.apply(this,o)};n.forEach(function(e){t.on(e,r)})}else{if("string"!=typeof n)throw Error("EventEmitter.once(): Invalid arguments:"+E.Config.inspect(e));let t=this.eventsOnce[n]||(this.eventsOnce[n]=[]);if(i){if("function"!=typeof i)throw Error("EventEmitter.once(): Invalid arguments:"+E.Config.inspect(e));t.push(i)}}}async whenState(e,t){if("string"!=typeof e||"string"!=typeof t)throw Error("whenState requires a valid state String argument");return e===t?null:this.once(e)}},tH={HEARTBEAT:0,ACK:1,NACK:2,CONNECT:3,CONNECTED:4,DISCONNECT:5,DISCONNECTED:6,CLOSE:7,CLOSED:8,ERROR:9,ATTACH:10,ATTACHED:11,DETACH:12,DETACHED:13,PRESENCE:14,MESSAGE:15,SYNC:16,AUTH:17,ACTIVATE:18},tj=[];Object.keys(tH).forEach(function(e){tj[tH[e]]=e});var tG={HAS_PRESENCE:1,HAS_BACKLOG:2,RESUMED:4,TRANSIENT:16,ATTACH_RESUME:32,PRESENCE:65536,PUBLISH:131072,SUBSCRIBE:262144,PRESENCE_SUBSCRIBE:524288},tU=Object.keys(tG);function tV(e){let t=[];if(e)for(let n=0;n<e.length;n++)t.push(e[n].toString());return"[ "+t.join(", ")+" ]"}tG.MODE_ALL=tG.PRESENCE|tG.PUBLISH|tG.SUBSCRIBE|tG.PRESENCE_SUBSCRIBE;var tY=["PRESENCE","PUBLISH","SUBSCRIBE","PRESENCE_SUBSCRIBE"];function tB(e,t){let n=e.error;n&&(e.error=P.fromValues(n));let i=e.messages;if(i)for(let e=0;e<i.length;e++)i[e]=tl(i[e]);let r=t?e.presence:void 0;if(t&&r&&t)for(let e=0;e<r.length;e++)r[e]=t.presenceMessageFromValues(r[e],!0);return Object.assign(new tJ,S(_({},e),{presence:r}))}function tq(e){return tB(e,{presenceMessageFromValues:tm,presenceMessagesFromValuesArray:tv})}function tz(e){return Object.assign(new tJ,e)}function tW(e,t){let n,i="[ProtocolMessage";void 0!==e.action&&(i+="; action="+tj[e.action]);let r=["id","channel","channelSerial","connectionId","count","msgSerial","timestamp"];for(let t=0;t<r.length;t++)void 0!==e[n=r[t]]&&(i+="; "+n+"="+e[n]);if(e.messages&&(i+="; messages="+tV(tc(e.messages))),e.presence&&t&&(i+="; presence="+tV(t.presenceMessagesFromValuesArray(e.presence))),e.error&&(i+="; error="+P.fromValues(e.error).toString()),e.auth&&e.auth.accessToken&&(i+="; token="+e.auth.accessToken),e.flags&&(i+="; flags="+tU.filter(e.hasFlag).join(",")),e.params){let t="";ee(e.params,function(n){t.length>0&&(t+="; "),t+=n+"="+e.params[n]}),t.length>0&&(i+="; params=["+t+"]")}return i+"]"}var tJ=class{constructor(){this.hasFlag=e=>(this.flags&tG[e])>0}setFlag(e){return this.flags=this.flags|tG[e]}getMode(){return this.flags&&this.flags&tG.MODE_ALL}encodeModesToFlags(e){e.forEach(e=>this.setFlag(e))}decodeModesFromFlags(){let e=[];return tY.forEach(t=>{this.hasFlag(t)&&e.push(t)}),e.length>0?e:void 0}},tK=class extends tF{constructor(e){super(e),this.messages=[]}count(){return this.messages.length}push(e){this.messages.push(e)}shift(){return this.messages.shift()}last(){return this.messages[this.messages.length-1]}copyAll(){return this.messages.slice()}append(e){this.messages.push.apply(this.messages,e)}prepend(e){this.messages.unshift.apply(this.messages,e)}completeMessages(e,t,n){T.logAction(this.logger,T.LOG_MICRO,"MessageQueue.completeMessages()","serial = "+e+"; count = "+t),n=n||null;let i=this.messages;if(0===i.length)throw Error("MessageQueue.completeMessages(): completeMessages called on any empty MessageQueue");let r=i[0];if(r){let o=r.message.msgSerial,s=e+t;if(s>o){let e=i.splice(0,s-o);for(let t of e)t.callback(n)}0==i.length&&this.emit("idle")}}completeAllMessages(e){this.completeMessages(0,Number.MAX_SAFE_INTEGER||Number.MAX_VALUE,e)}resetSendAttempted(){for(let e of this.messages)e.sendAttempted=!1}clear(){T.logAction(this.logger,T.LOG_MICRO,"MessageQueue.clear()","clearing "+this.messages.length+" messages"),this.messages=[],this.emit("idle")}},t$=class{constructor(e,t){this.message=e,this.callback=t,this.merged=!1;let n=e.action;this.sendAttempted=!1,this.ackRequired=n==tH.MESSAGE||n==tH.PRESENCE}},tX=class extends tF{constructor(e){super(e.logger),this.transport=e,this.messageQueue=new tK(this.logger),e.on("ack",(e,t)=>{this.onAck(e,t)}),e.on("nack",(e,t,n)=>{this.onNack(e,t,n)})}onAck(e,t){T.logAction(this.logger,T.LOG_MICRO,"Protocol.onAck()","serial = "+e+"; count = "+t),this.messageQueue.completeMessages(e,t)}onNack(e,t,n){T.logAction(this.logger,T.LOG_ERROR,"Protocol.onNack()","serial = "+e+"; count = "+t+"; err = "+ea(n)),n||(n=new P("Unable to send message; channel not responding",50001,500)),this.messageQueue.completeMessages(e,t,n)}onceIdle(e){let t=this.messageQueue;if(0===t.count()){e();return}t.once("idle",e)}send(e){e.ackRequired&&this.messageQueue.push(e),this.logger.shouldLog(T.LOG_MICRO)&&T.logActionNoStrip(this.logger,T.LOG_MICRO,"Protocol.send()","sending msg; "+tW(e.message,this.transport.connectionManager.realtime._RealtimePresence)),e.sendAttempted=!0,this.transport.send(e.message)}getTransport(){return this.transport}getPendingMessages(){return this.messageQueue.copyAll()}clearPendingMessages(){return this.messageQueue.clear()}finish(){let e=this.transport;this.onceIdle(function(){e.disconnect()})}},tQ=class{constructor(e,t,n,i){this.previous=e,this.current=t,n&&(this.retryIn=n),i&&(this.reason=i)}},tZ={DISCONNECTED:80003,SUSPENDED:80002,FAILED:8e4,CLOSING:80017,CLOSED:80017,UNKNOWN_CONNECTION_ERR:50002,UNKNOWN_CHANNEL_ERR:50001},t0={disconnected:()=>P.fromValues({statusCode:400,code:tZ.DISCONNECTED,message:"Connection to server temporarily unavailable"}),suspended:()=>P.fromValues({statusCode:400,code:tZ.SUSPENDED,message:"Connection to server unavailable"}),failed:()=>P.fromValues({statusCode:400,code:tZ.FAILED,message:"Connection failed or disconnected by server"}),closing:()=>P.fromValues({statusCode:400,code:tZ.CLOSING,message:"Connection closing"}),closed:()=>P.fromValues({statusCode:400,code:tZ.CLOSED,message:"Connection closed"}),unknownConnectionErr:()=>P.fromValues({statusCode:500,code:tZ.UNKNOWN_CONNECTION_ERR,message:"Internal connection error"}),unknownChannelErr:()=>P.fromValues({statusCode:500,code:tZ.UNKNOWN_CONNECTION_ERR,message:"Internal channel error"})},t1=tz({action:tH.CLOSE}),t2=tz({action:tH.DISCONNECT}),t4=class extends tF{constructor(e,t,n,i){super(e.logger),i&&(n.format=void 0,n.heartbeats=!0),this.connectionManager=e,this.auth=t,this.params=n,this.timeouts=n.options.timeouts,this.format=n.format,this.isConnected=!1,this.isFinished=!1,this.isDisposed=!1,this.maxIdleInterval=null,this.idleTimer=null,this.lastActivity=null}connect(){}close(){this.isConnected&&this.requestClose(),this.finish("closed",t0.closed())}disconnect(e){this.isConnected&&this.requestDisconnect(),this.finish("disconnected",e||t0.disconnected())}fail(e){this.isConnected&&this.requestDisconnect(),this.finish("failed",e||t0.failed())}finish(e,t){var n;this.isFinished||(this.isFinished=!0,this.isConnected=!1,this.maxIdleInterval=null,clearTimeout(null!=(n=this.idleTimer)?n:void 0),this.idleTimer=null,this.emit(e,t),this.dispose())}onProtocolMessage(e){switch(this.logger.shouldLog(T.LOG_MICRO)&&T.logActionNoStrip(this.logger,T.LOG_MICRO,"Transport.onProtocolMessage()","received on "+this.shortName+": "+tW(e,this.connectionManager.realtime._RealtimePresence)+"; connectionId = "+this.connectionManager.connectionId),this.onActivity(),e.action){case tH.HEARTBEAT:T.logActionNoStrip(this.logger,T.LOG_MICRO,"Transport.onProtocolMessage()",this.shortName+" heartbeat; connectionId = "+this.connectionManager.connectionId),this.emit("heartbeat",e.id);break;case tH.CONNECTED:this.onConnect(e),this.emit("connected",e.error,e.connectionId,e.connectionDetails,e);break;case tH.CLOSED:this.onClose(e);break;case tH.DISCONNECTED:this.onDisconnect(e);break;case tH.ACK:this.emit("ack",e.msgSerial,e.count);break;case tH.NACK:this.emit("nack",e.msgSerial,e.count,e.error);break;case tH.SYNC:this.connectionManager.onChannelMessage(e,this);break;case tH.ACTIVATE:break;case tH.AUTH:eg(this.auth.authorize(),e=>{e&&T.logAction(this.logger,T.LOG_ERROR,"Transport.onProtocolMessage()","Ably requested re-authentication, but unable to obtain a new token: "+ea(e))});break;case tH.ERROR:if(T.logAction(this.logger,T.LOG_MINOR,"Transport.onProtocolMessage()","received error action; connectionId = "+this.connectionManager.connectionId+"; err = "+E.Config.inspect(e.error)+(e.channel?", channel: "+e.channel:"")),void 0===e.channel){this.onFatalError(e);break}this.connectionManager.onChannelMessage(e,this);break;default:this.connectionManager.onChannelMessage(e,this)}}onConnect(e){if(this.isConnected=!0,!e.connectionDetails)throw Error("Transport.onConnect(): Connect message recieved without connectionDetails");let t=e.connectionDetails.maxIdleInterval;t&&(this.maxIdleInterval=t+this.timeouts.realtimeRequestTimeout,this.onActivity())}onDisconnect(e){let t=e&&e.error;T.logAction(this.logger,T.LOG_MINOR,"Transport.onDisconnect()","err = "+ea(t)),this.finish("disconnected",t)}onFatalError(e){let t=e&&e.error;T.logAction(this.logger,T.LOG_MINOR,"Transport.onFatalError()","err = "+ea(t)),this.finish("failed",t)}onClose(e){let t=e&&e.error;T.logAction(this.logger,T.LOG_MINOR,"Transport.onClose()","err = "+ea(t)),this.finish("closed",t)}requestClose(){T.logAction(this.logger,T.LOG_MINOR,"Transport.requestClose()",""),this.send(t1)}requestDisconnect(){T.logAction(this.logger,T.LOG_MINOR,"Transport.requestDisconnect()",""),this.send(t2)}ping(e){let t={action:tH.HEARTBEAT};e&&(t.id=e),this.send(tz(t))}dispose(){T.logAction(this.logger,T.LOG_MINOR,"Transport.dispose()",""),this.isDisposed=!0,this.off()}onActivity(){this.maxIdleInterval&&(this.lastActivity=this.connectionManager.lastActivity=Date.now(),this.setIdleTimer(this.maxIdleInterval+100))}setIdleTimer(e){this.idleTimer||(this.idleTimer=setTimeout(()=>{this.onIdleTimerExpire()},e))}onIdleTimerExpire(){if(!this.lastActivity||!this.maxIdleInterval)throw Error("Transport.onIdleTimerExpire(): lastActivity/maxIdleInterval not set");this.idleTimer=null;let e=Date.now()-this.lastActivity,t=this.maxIdleInterval-e;if(t<=0){let t="No activity seen from realtime in "+e+"ms; assuming connection has dropped";T.logAction(this.logger,T.LOG_ERROR,"Transport.onIdleTimerExpire()",t),this.disconnect(new P(t,80003,408))}else this.setIdleTimer(t+100)}static tryConnect(e,t,n,i,r){let o;let s=new e(t,n,i),a=function(e){clearTimeout(o),r({event:this.event,error:e})},l=t.options.timeouts.realtimeRequestTimeout;return o=setTimeout(()=>{s.off(["preconnect","disconnected","failed"]),s.dispose(),a.call({event:"disconnected"},new P("Timeout waiting for transport to indicate itself viable",5e4,500))},l),s.on(["failed","disconnected"],a),s.on("preconnect",function(){T.logAction(t.logger,T.LOG_MINOR,"Transport.tryConnect()","viable transport "+s),clearTimeout(o),s.off(["failed","disconnected"],a),r(null,s)}),s.connect(),s}static isAvailable(){throw new P("isAvailable not implemented for transport",5e4,500)}};(r=s||(s={})).WebSocket="web_socket",r.Comet="comet",r.XhrPolling="xhr_polling";var t8=void 0!==n.g?n.g:"undefined"!=typeof window?window:self,t3=()=>{var e;return void 0!==E.WebStorage&&(null==(e=E.WebStorage)?void 0:e.localSupported)},t6=()=>{var e;return void 0!==E.WebStorage&&(null==(e=E.WebStorage)?void 0:e.sessionSupported)},t5=function(){},t9="ably-transport-preference";function t7(e){try{return JSON.parse(e)}catch(e){return null}}var ne=class{constructor(e,t,n,i){this.options=e,this.host=t,this.mode=n,this.connectionKey=i,this.format=e.useBinaryProtocol?"msgpack":"json"}getConnectParams(e){let t=e?F(e):{},n=this.options;switch(this.mode){case"resume":t.resume=this.connectionKey;break;case"recover":{let e=t7(n.recover);e&&(t.recover=e.connectionKey)}}return void 0!==n.clientId&&(t.clientId=n.clientId),!1===n.echoMessages&&(t.echo="false"),void 0!==this.format&&(t.format=this.format),void 0!==this.stream&&(t.stream=this.stream),void 0!==this.heartbeats&&(t.heartbeats=this.heartbeats),t.v=eA.protocolVersion,t.agent=eD(this.options),void 0!==n.transportParams&&N(t,n.transportParams),t}toString(){let e="[mode="+this.mode;return this.host&&(e+=",host="+this.host),this.connectionKey&&(e+=",connectionKey="+this.connectionKey),this.format&&(e+=",format="+this.format),e+="]"}},nt=class e extends tF{constructor(e,t){super(e.logger),this.supportedTransports={},this.disconnectedRetryCount=0,this.pendingChannelMessagesState={isProcessing:!1,queue:[]},this.realtime=e,this.initTransports(),this.options=t;let n=t.timeouts,i=n.webSocketConnectTimeout+n.realtimeRequestTimeout;if(this.states={initialized:{state:"initialized",terminal:!1,queueEvents:!0,sendEvents:!1,failState:"disconnected"},connecting:{state:"connecting",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:i,failState:"disconnected"},connected:{state:"connected",terminal:!1,queueEvents:!1,sendEvents:!0,failState:"disconnected"},disconnected:{state:"disconnected",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:n.disconnectedRetryTimeout,failState:"disconnected"},suspended:{state:"suspended",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:n.suspendedRetryTimeout,failState:"suspended"},closing:{state:"closing",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:n.realtimeRequestTimeout,failState:"closed"},closed:{state:"closed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"closed"},failed:{state:"failed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"failed"}},this.state=this.states.initialized,this.errorReason=null,this.queuedMessages=new tK(this.logger),this.msgSerial=0,this.connectionDetails=void 0,this.connectionId=void 0,this.connectionKey=void 0,this.connectionStateTtl=n.connectionStateTtl,this.maxIdleInterval=null,this.transports=z(t.transports||eA.defaultTransports,this.supportedTransports),this.transportPreference=null,this.transports.includes(s.WebSocket)&&(this.webSocketTransportAvailable=!0),this.transports.includes(s.XhrPolling)?this.baseTransport=s.XhrPolling:this.transports.includes(s.Comet)&&(this.baseTransport=s.Comet),this.httpHosts=eA.getHosts(t),this.wsHosts=eA.getHosts(t,!0),this.activeProtocol=null,this.host=null,this.lastAutoReconnectAttempt=null,this.lastActivity=null,this.forceFallbackHost=!1,this.connectCounter=0,this.wsCheckResult=null,this.webSocketSlowTimer=null,this.webSocketGiveUpTimer=null,this.abandonedWebSocket=!1,T.logAction(this.logger,T.LOG_MINOR,"Realtime.ConnectionManager()","started"),T.logAction(this.logger,T.LOG_MICRO,"Realtime.ConnectionManager()","requested transports = ["+(t.transports||eA.defaultTransports)+"]"),T.logAction(this.logger,T.LOG_MICRO,"Realtime.ConnectionManager()","available transports = ["+this.transports+"]"),T.logAction(this.logger,T.LOG_MICRO,"Realtime.ConnectionManager()","http hosts = ["+this.httpHosts+"]"),!this.transports.length){let e="no requested transports available";throw T.logAction(this.logger,T.LOG_ERROR,"realtime.ConnectionManager()",e),Error(e)}let r=E.Config.addEventListener;r&&(t6()&&"function"==typeof t.recover&&r("beforeunload",this.persistConnection.bind(this)),!0===t.closeOnUnload&&r("beforeunload",()=>{T.logAction(this.logger,T.LOG_MAJOR,"Realtime.ConnectionManager()","beforeunload event has triggered the connection to close as closeOnUnload is true"),this.requestState({state:"closing"})}),r("online",()=>{var e;this.state==this.states.disconnected||this.state==this.states.suspended?(T.logAction(this.logger,T.LOG_MINOR,"ConnectionManager caught browser ‘online’ event","reattempting connection"),this.requestState({state:"connecting"})):this.state==this.states.connecting&&(null==(e=this.pendingTransport)||e.off(),this.disconnectAllTransports(),this.startConnect())}),r("offline",()=>{this.state==this.states.connected&&(T.logAction(this.logger,T.LOG_MINOR,"ConnectionManager caught browser ‘offline’ event","disconnecting active transport"),this.disconnectAllTransports())}))}static supportedTransports(e){let t={supportedTransports:{}};return this.initTransports(e,t),t.supportedTransports}static initTransports(e,t){let n=_(_({},E.Transports.bundledImplementations),e);[s.WebSocket,...E.Transports.order].forEach(e=>{let i=n[e];i&&i.isAvailable()&&(t.supportedTransports[e]=i)})}initTransports(){e.initTransports(this.realtime._additionalTransportImplementations,this)}createTransportParams(e,t){return new ne(this.options,e,t,this.connectionKey)}getTransportParams(e){(e=>{if(this.connectionKey){e("resume");return}if("string"==typeof this.options.recover){e("recover");return}let t=this.options.recover,n=this.getSessionRecoverData(),i=this.sessionRecoveryName();if(n&&"function"==typeof t){T.logAction(this.logger,T.LOG_MINOR,"ConnectionManager.getTransportParams()","Calling clientOptions-provided recover function with last session data (recovery scope: "+i+")"),t(n,t=>{t?(this.options.recover=n.recoveryKey,e("recover")):e("clean")});return}e("clean")})(t=>{let n=this.createTransportParams(null,t);if("recover"===t){T.logAction(this.logger,T.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport recovery mode = recover; recoveryKey = "+this.options.recover);let e=t7(this.options.recover);e&&(this.msgSerial=e.msgSerial)}else T.logAction(this.logger,T.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport params = "+n.toString());e(n)})}tryATransport(e,t,n){T.logAction(this.logger,T.LOG_MICRO,"ConnectionManager.tryATransport()","trying "+t),this.proposedTransport=t4.tryConnect(this.supportedTransports[t],this,this.realtime.auth,e,(i,r)=>{let o=this.state;if(o==this.states.closing||o==this.states.closed||o==this.states.failed){r&&(T.logAction(this.logger,T.LOG_MINOR,"ConnectionManager.tryATransport()","connection "+o.state+" while we were attempting the transport; closing "+r),r.close()),n(!0);return}if(i){if(T.logAction(this.logger,T.LOG_MINOR,"ConnectionManager.tryATransport()","transport "+t+" "+i.event+", err: "+i.error.toString()),eJ.isTokenErr(i.error)&&!(this.errorReason&&eJ.isTokenErr(this.errorReason)))this.errorReason=i.error,eg(this.realtime.auth._forceNewToken(null,null),i=>{if(i){this.actOnErrorFromAuthorize(i);return}this.tryATransport(e,t,n)});else if("failed"===i.event)this.notifyState({state:"failed",error:i.error}),n(!0);else if("disconnected"===i.event){var s;!(s=i.error).statusCode||!s.code||s.statusCode>=500||Object.values(tZ).includes(s.code)?n(!1):(this.notifyState({state:this.states.connecting.failState,error:i.error}),n(!0))}return}T.logAction(this.logger,T.LOG_MICRO,"ConnectionManager.tryATransport()","viable transport "+t+"; setting pending"),this.setTransportPending(r,e),n(null,r)})}setTransportPending(e,t){let n=t.mode;T.logAction(this.logger,T.LOG_MINOR,"ConnectionManager.setTransportPending()","transport = "+e+"; mode = "+n),this.pendingTransport=e,this.cancelWebSocketSlowTimer(),this.cancelWebSocketGiveUpTimer(),e.once("connected",(t,i,r)=>{this.activateTransport(t,e,i,r),"recover"===n&&this.options.recover&&(delete this.options.recover,this.unpersistConnection())});let i=this;e.on(["disconnected","closed","failed"],function(t){i.deactivateTransport(e,this.event,t)}),this.emit("transport.pending",e)}activateTransport(e,t,n,i){T.logAction(this.logger,T.LOG_MINOR,"ConnectionManager.activateTransport()","transport = "+t),e&&T.logAction(this.logger,T.LOG_ERROR,"ConnectionManager.activateTransport()","error = "+e),n&&T.logAction(this.logger,T.LOG_MICRO,"ConnectionManager.activateTransport()","connectionId =  "+n),i&&T.logAction(this.logger,T.LOG_MICRO,"ConnectionManager.activateTransport()","connectionDetails =  "+JSON.stringify(i)),this.persistTransportPreference(t);let r=this.state,o=this.states.connected.state;if(T.logAction(this.logger,T.LOG_MINOR,"ConnectionManager.activateTransport()","current state = "+r.state),r.state==this.states.closing.state||r.state==this.states.closed.state||r.state==this.states.failed.state)return T.logAction(this.logger,T.LOG_MINOR,"ConnectionManager.activateTransport()","Disconnecting transport and abandoning"),t.disconnect(),!1;if(delete this.pendingTransport,!t.isConnected)return T.logAction(this.logger,T.LOG_MINOR,"ConnectionManager.activateTransport()","Declining to activate transport "+t+" since it appears to no longer be connected"),!1;let s=this.activeProtocol;this.activeProtocol=new tX(t),this.host=t.params.host;let a=i.connectionKey;if(a&&this.connectionKey!=a&&this.setConnection(n,i,!!e),this.onConnectionDetailsUpdate(i,t),E.Config.nextTick(()=>{t.on("connected",(e,n,i)=>{this.onConnectionDetailsUpdate(i,t),this.emit("update",new tQ(o,o,null,e))})}),r.state===this.states.connected.state?e&&(this.errorReason=this.realtime.connection.errorReason=e,this.emit("update",new tQ(o,o,null,e))):(this.notifyState({state:"connected",error:e}),this.errorReason=this.realtime.connection.errorReason=e||null),this.emit("transport.active",t),s){if(s.messageQueue.count()>0&&T.logAction(this.logger,T.LOG_ERROR,"ConnectionManager.activateTransport()","Previous active protocol (for transport "+s.transport.shortName+", new one is "+t.shortName+") finishing with "+s.messageQueue.count()+" messages still pending"),s.transport===t){let e="Assumption violated: activating a transport that was also the transport for the previous active protocol; transport = "+t.shortName+"; stack = "+Error().stack;T.logAction(this.logger,T.LOG_ERROR,"ConnectionManager.activateTransport()",e)}else s.finish()}return!0}deactivateTransport(e,t,n){let i=this.activeProtocol,r=i&&i.getTransport()===e,o=e===this.pendingTransport,s=this.noTransportsScheduledForActivation();if(T.logAction(this.logger,T.LOG_MINOR,"ConnectionManager.deactivateTransport()","transport = "+e),T.logAction(this.logger,T.LOG_MINOR,"ConnectionManager.deactivateTransport()","state = "+t+(r?"; was active":o?"; was pending":"")+(s?"":"; another transport is scheduled for activation")),n&&n.message&&T.logAction(this.logger,T.LOG_MICRO,"ConnectionManager.deactivateTransport()","reason =  "+n.message),r&&(T.logAction(this.logger,T.LOG_MICRO,"ConnectionManager.deactivateTransport()","Getting, clearing, and requeuing "+this.activeProtocol.messageQueue.count()+" pending messages"),this.queuePendingMessages(i.getPendingMessages()),i.clearPendingMessages(),this.activeProtocol=this.host=null),this.emit("transport.inactive",e),r&&s||r&&"failed"===t||"closed"===t||null===i&&o){if("disconnected"===t&&n&&n.statusCode>500&&this.httpHosts.length>1){this.unpersistTransportPreference(),this.forceFallbackHost=!0,this.notifyState({state:t,error:n,retryImmediately:!0});return}let e="failed"===t&&eJ.isTokenErr(n)?"disconnected":t;this.notifyState({state:e,error:n});return}}noTransportsScheduledForActivation(){return!this.pendingTransport||!this.pendingTransport.isConnected}setConnection(e,t,n){let i=this.connectionId;(i&&i!==e||!i&&n)&&(T.logAction(this.logger,T.LOG_MINOR,"ConnectionManager.setConnection()","Resetting msgSerial"),this.msgSerial=0,this.queuedMessages.resetSendAttempted()),this.connectionId!==e&&T.logAction(this.logger,T.LOG_MINOR,"ConnectionManager.setConnection()","New connectionId; reattaching any attached channels"),this.realtime.connection.id=this.connectionId=e,this.realtime.connection.key=this.connectionKey=t.connectionKey}clearConnection(){this.realtime.connection.id=this.connectionId=void 0,this.realtime.connection.key=this.connectionKey=void 0,this.msgSerial=0,this.unpersistConnection()}createRecoveryKey(){return this.connectionKey?JSON.stringify({connectionKey:this.connectionKey,msgSerial:this.msgSerial,channelSerials:this.realtime.channels.channelSerials()}):null}checkConnectionStateFreshness(){if(!this.lastActivity||!this.connectionId)return;let e=Date.now()-this.lastActivity;e>this.connectionStateTtl+this.maxIdleInterval&&(T.logAction(this.logger,T.LOG_MINOR,"ConnectionManager.checkConnectionStateFreshness()","Last known activity from realtime was "+e+"ms ago; discarding connection state"),this.clearConnection(),this.states.connecting.failState="suspended")}persistConnection(){if(t6()){let e=this.createRecoveryKey();e&&this.setSessionRecoverData({recoveryKey:e,disconnectedAt:Date.now(),location:t8.location,clientId:this.realtime.auth.clientId})}}unpersistConnection(){this.clearSessionRecoverData()}getError(){if(this.errorReason){let e=D.fromValues(this.errorReason);return e.cause=this.errorReason,e}return this.getStateError()}getStateError(){var e;return null==(e=t0[this.state.state])?void 0:e.call(t0)}activeState(){return this.state.queueEvents||this.state.sendEvents}enactStateChange(e){let t="Connection state",n=e.current+(e.reason?"; reason: "+e.reason:"");"failed"===e.current?T.logAction(this.logger,T.LOG_ERROR,t,n):T.logAction(this.logger,T.LOG_MAJOR,t,n),T.logAction(this.logger,T.LOG_MINOR,"ConnectionManager.enactStateChange","setting new state: "+e.current+"; reason = "+(e.reason&&e.reason.message));let i=this.state=this.states[e.current];e.reason&&(this.errorReason=e.reason,this.realtime.connection.errorReason=e.reason),(i.terminal||"suspended"===i.state)&&this.clearConnection(),this.emit("connectionstate",e)}startTransitionTimer(e){T.logAction(this.logger,T.LOG_MINOR,"ConnectionManager.startTransitionTimer()","transitionState: "+e.state),this.transitionTimer&&(T.logAction(this.logger,T.LOG_MINOR,"ConnectionManager.startTransitionTimer()","clearing already-running timer"),clearTimeout(this.transitionTimer)),this.transitionTimer=setTimeout(()=>{this.transitionTimer&&(this.transitionTimer=null,T.logAction(this.logger,T.LOG_MINOR,"ConnectionManager "+e.state+" timer expired","requesting new state: "+e.failState),this.notifyState({state:e.failState}))},e.retryDelay)}cancelTransitionTimer(){T.logAction(this.logger,T.LOG_MINOR,"ConnectionManager.cancelTransitionTimer()",""),this.transitionTimer&&(clearTimeout(this.transitionTimer),this.transitionTimer=null)}startSuspendTimer(){this.suspendTimer||(this.suspendTimer=setTimeout(()=>{this.suspendTimer&&(this.suspendTimer=null,T.logAction(this.logger,T.LOG_MINOR,"ConnectionManager suspend timer expired","requesting new state: suspended"),this.states.connecting.failState="suspended",this.notifyState({state:"suspended"}))},this.connectionStateTtl))}checkSuspendTimer(e){"disconnected"!==e&&"suspended"!==e&&"connecting"!==e&&this.cancelSuspendTimer()}cancelSuspendTimer(){this.states.connecting.failState="disconnected",this.suspendTimer&&(clearTimeout(this.suspendTimer),this.suspendTimer=null)}startRetryTimer(e){this.retryTimer=setTimeout(()=>{T.logAction(this.logger,T.LOG_MINOR,"ConnectionManager retry timer expired","retrying"),this.retryTimer=null,this.requestState({state:"connecting"})},e)}cancelRetryTimer(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)}startWebSocketSlowTimer(){this.webSocketSlowTimer=setTimeout(()=>{T.logAction(this.logger,T.LOG_MINOR,"ConnectionManager WebSocket slow timer","checking connectivity"),null===this.wsCheckResult&&this.checkWsConnectivity().then(()=>{T.logAction(this.logger,T.LOG_MINOR,"ConnectionManager WebSocket slow timer","ws connectivity check succeeded"),this.wsCheckResult=!0}).catch(()=>{T.logAction(this.logger,T.LOG_MAJOR,"ConnectionManager WebSocket slow timer","ws connectivity check failed"),this.wsCheckResult=!1}),this.realtime.http.checkConnectivity&&eg(this.realtime.http.checkConnectivity(),(e,t)=>{e||!t?(T.logAction(this.logger,T.LOG_MAJOR,"ConnectionManager WebSocket slow timer","http connectivity check failed"),this.cancelWebSocketGiveUpTimer(),this.notifyState({state:"disconnected",error:new P("Unable to connect (network unreachable)",80003,404)})):T.logAction(this.logger,T.LOG_MINOR,"ConnectionManager WebSocket slow timer","http connectivity check succeeded")})},this.options.timeouts.webSocketSlowTimeout)}cancelWebSocketSlowTimer(){this.webSocketSlowTimer&&(clearTimeout(this.webSocketSlowTimer),this.webSocketSlowTimer=null)}startWebSocketGiveUpTimer(e){this.webSocketGiveUpTimer=setTimeout(()=>{var t,n;this.wsCheckResult||(T.logAction(this.logger,T.LOG_MINOR,"ConnectionManager WebSocket give up timer","websocket connection took more than 10s; "+(this.baseTransport?"trying base transport":"")),this.baseTransport?(this.abandonedWebSocket=!0,null==(t=this.proposedTransport)||t.dispose(),null==(n=this.pendingTransport)||n.dispose(),this.connectBase(e,++this.connectCounter)):T.logAction(this.logger,T.LOG_MAJOR,"ConnectionManager WebSocket give up timer","websocket connectivity appears to be unavailable but no other transports to try"))},this.options.timeouts.webSocketConnectTimeout)}cancelWebSocketGiveUpTimer(){this.webSocketGiveUpTimer&&(clearTimeout(this.webSocketGiveUpTimer),this.webSocketGiveUpTimer=null)}notifyState(e){var t;let n=e.state,i="disconnected"===n&&(this.state===this.states.connected||e.retryImmediately||this.state===this.states.connecting&&e.error&&eJ.isTokenErr(e.error)&&!(this.errorReason&&eJ.isTokenErr(this.errorReason)));if(T.logAction(this.logger,T.LOG_MINOR,"ConnectionManager.notifyState()","new state: "+n+(i?"; will retry connection immediately":"")),n==this.state.state||(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.cancelWebSocketSlowTimer(),this.cancelWebSocketGiveUpTimer(),this.checkSuspendTimer(e.state),("suspended"===n||"connected"===n)&&(this.disconnectedRetryCount=0),this.state.terminal))return;let r=this.states[e.state],o=r.retryDelay;"disconnected"===r.state&&(this.disconnectedRetryCount++,o=ew(r.retryDelay,this.disconnectedRetryCount));let s=new tQ(this.state.state,r.state,o,e.error||(null==(t=t0[r.state])?void 0:t.call(t0)));if(i){let e=()=>{this.state===this.states.disconnected&&(this.lastAutoReconnectAttempt=Date.now(),this.requestState({state:"connecting"}))},t=this.lastAutoReconnectAttempt&&Date.now()-this.lastAutoReconnectAttempt+1;t&&t<1e3?(T.logAction(this.logger,T.LOG_MICRO,"ConnectionManager.notifyState()","Last reconnect attempt was only "+t+"ms ago, waiting another "+(1e3-t)+"ms before trying again"),setTimeout(e,1e3-t)):E.Config.nextTick(e)}else("disconnected"===n||"suspended"===n)&&this.startRetryTimer(o);("disconnected"===n&&!i||"suspended"===n||r.terminal)&&E.Config.nextTick(()=>{this.disconnectAllTransports()}),"connected"!=n||this.activeProtocol||T.logAction(this.logger,T.LOG_ERROR,"ConnectionManager.notifyState()","Broken invariant: attempted to go into connected state, but there is no active protocol"),this.enactStateChange(s),this.state.sendEvents?this.sendQueuedMessages():this.state.queueEvents||(this.realtime.channels.propogateConnectionInterruption(n,s.reason),this.failQueuedMessages(s.reason))}requestState(e){var t;let n=e.state;if(T.logAction(this.logger,T.LOG_MINOR,"ConnectionManager.requestState()","requested state: "+n+"; current state: "+this.state.state),n==this.state.state||(this.cancelWebSocketSlowTimer(),this.cancelWebSocketGiveUpTimer(),this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer(n),"connecting"==n&&"connected"==this.state.state||"closing"==n&&"closed"==this.state.state))return;let i=this.states[n],r=new tQ(this.state.state,i.state,null,e.error||(null==(t=t0[i.state])?void 0:t.call(t0)));this.enactStateChange(r),"connecting"==n&&E.Config.nextTick(()=>{this.startConnect()}),"closing"==n&&this.closeImpl()}startConnect(){if(this.state!==this.states.connecting){T.logAction(this.logger,T.LOG_MINOR,"ConnectionManager.startConnect()","Must be in connecting state to connect, but was "+this.state.state);return}let e=this.realtime.auth,t=++this.connectCounter,n=()=>{this.checkConnectionStateFreshness(),this.getTransportParams(e=>{if("recover"===e.mode&&e.options.recover){let t=t7(e.options.recover);t&&this.realtime.channels.recoverChannels(t.channelSerials)}t===this.connectCounter&&this.connectImpl(e,t)})};if(T.logAction(this.logger,T.LOG_MINOR,"ConnectionManager.startConnect()","starting connection"),this.startSuspendTimer(),this.startTransitionTimer(this.states.connecting),"basic"===e.method)n();else{let i=e=>{t===this.connectCounter&&(e?this.actOnErrorFromAuthorize(e):n())};this.errorReason&&eJ.isTokenErr(this.errorReason)?eg(e._forceNewToken(null,null),i):eg(e._ensureValidAuthCredentials(!1),i)}}connectImpl(e,t){let n=this.state.state;if(n!==this.states.connecting.state){T.logAction(this.logger,T.LOG_MINOR,"ConnectionManager.connectImpl()","Must be in connecting state to connect, but was "+n);return}let i=this.getTransportPreference();i&&i===this.baseTransport&&this.webSocketTransportAvailable&&this.checkWsConnectivity().then(()=>{this.wsCheckResult=!0,this.abandonedWebSocket=!1,this.unpersistTransportPreference(),this.state===this.states.connecting&&(T.logAction(this.logger,T.LOG_MINOR,"ConnectionManager.connectImpl():","web socket connectivity available, cancelling connection attempt with "+this.baseTransport),this.disconnectAllTransports(),this.connectWs(e,++this.connectCounter))}).catch(t5),i&&i===this.baseTransport||this.baseTransport&&!this.webSocketTransportAvailable?this.connectBase(e,t):this.connectWs(e,t)}connectWs(e,t){T.logAction(this.logger,T.LOG_MICRO,"ConnectionManager.connectWs()"),this.startWebSocketSlowTimer(),this.startWebSocketGiveUpTimer(e),this.tryTransportWithFallbacks("web_socket",e,!0,t,()=>!1!==this.wsCheckResult&&!this.abandonedWebSocket)}connectBase(e,t){T.logAction(this.logger,T.LOG_MICRO,"ConnectionManager.connectBase()"),this.baseTransport?this.tryTransportWithFallbacks(this.baseTransport,e,!1,t,()=>!0):this.notifyState({state:"disconnected",error:new P("No transports left to try",8e4,404)})}tryTransportWithFallbacks(e,t,n,i,r){T.logAction(this.logger,T.LOG_MICRO,"ConnectionManager.tryTransportWithFallbacks()",e);let o=e=>{this.notifyState({state:this.states.connecting.failState,error:e})},s=n?this.wsHosts.slice():this.httpHosts.slice(),a=(e,t)=>{if(i===this.connectCounter){if(!r()){t&&t.dispose();return}t||e||c()}},l=s.shift();if(!l){o(new P("Unable to connect (no available host)",80003,404));return}t.host=l;let c=()=>{if(!s.length){o(new P("Unable to connect (and no more fallback hosts to try)",80003,404));return}if(!this.realtime.http.checkConnectivity){o(new D("Internal error: Http.checkConnectivity not set",null,500));return}eg(this.realtime.http.checkConnectivity(),(n,l)=>{if(i===this.connectCounter&&r()){if(n){o(n);return}if(!l){o(new P("Unable to connect (network unreachable)",80003,404));return}t.host=ei(s),this.tryATransport(t,e,a)}})};if(this.forceFallbackHost&&s.length){this.forceFallbackHost=!1,c();return}this.tryATransport(t,e,a)}closeImpl(){T.logAction(this.logger,T.LOG_MINOR,"ConnectionManager.closeImpl()","closing connection"),this.cancelSuspendTimer(),this.startTransitionTimer(this.states.closing),this.pendingTransport&&(T.logAction(this.logger,T.LOG_MICRO,"ConnectionManager.closeImpl()","Closing pending transport: "+this.pendingTransport),this.pendingTransport.close()),this.activeProtocol&&(T.logAction(this.logger,T.LOG_MICRO,"ConnectionManager.closeImpl()","Closing active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().close()),this.notifyState({state:"closed"})}onAuthUpdated(e,t){var n;switch(this.state.state){case"connected":{T.logAction(this.logger,T.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Sending AUTH message on active transport");let i=null==(n=this.activeProtocol)?void 0:n.getTransport();i&&i.onAuthUpdated&&i.onAuthUpdated(e);let r=tz({action:tH.AUTH,auth:{accessToken:e.token}});this.send(r);let o=()=>{this.off(s),t(null,e)},s=e=>{"failed"===e.current&&(this.off(o),this.off(s),t(e.reason||this.getStateError()))};this.once("connectiondetails",o),this.on("connectionstate",s);break}case"connecting":T.logAction(this.logger,T.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Aborting current connection attempts in order to start again with the new auth details"),this.disconnectAllTransports();default:{T.logAction(this.logger,T.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Connection state is "+this.state.state+"; waiting until either connected or failed");let n=i=>{switch(i.current){case"connected":this.off(n),t(null,e);break;case"failed":case"closed":case"suspended":this.off(n),t(i.reason||this.getStateError())}};this.on("connectionstate",n),"connecting"===this.state.state?this.startConnect():this.requestState({state:"connecting"})}}}disconnectAllTransports(){T.logAction(this.logger,T.LOG_MINOR,"ConnectionManager.disconnectAllTransports()","Disconnecting all transports"),this.connectCounter++,this.pendingTransport&&(T.logAction(this.logger,T.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting pending transport: "+this.pendingTransport),this.pendingTransport.disconnect()),delete this.pendingTransport,this.proposedTransport&&(T.logAction(this.logger,T.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting proposed transport: "+this.pendingTransport),this.proposedTransport.disconnect()),delete this.pendingTransport,this.activeProtocol&&(T.logAction(this.logger,T.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().disconnect())}send(e,t,n){n=n||t5;let i=this.state;if(i.sendEvents){T.logAction(this.logger,T.LOG_MICRO,"ConnectionManager.send()","sending event"),this.sendImpl(new t$(e,n));return}let r=t&&i.queueEvents;if(!r){let e="rejecting event, queueEvent was "+t+", state was "+i.state;T.logAction(this.logger,T.LOG_MICRO,"ConnectionManager.send()",e),n(this.errorReason||new P(e,9e4,400));return}this.logger.shouldLog(T.LOG_MICRO)&&T.logAction(this.logger,T.LOG_MICRO,"ConnectionManager.send()","queueing msg; "+tW(e,this.realtime._RealtimePresence)),this.queue(e,n)}sendImpl(e){let t=e.message;e.ackRequired&&!e.sendAttempted&&(t.msgSerial=this.msgSerial++);try{this.activeProtocol.send(e)}catch(e){T.logAction(this.logger,T.LOG_ERROR,"ConnectionManager.sendImpl()","Unexpected exception in transport.send(): "+e.stack)}}queue(e,t){T.logAction(this.logger,T.LOG_MICRO,"ConnectionManager.queue()","queueing event");let n=this.queuedMessages.last(),i=this.options.maxMessageSize;n&&!n.sendAttempted&&function(e,t,n){let i;if(e.channel!==t.channel||(i=e.action)!==tH.PRESENCE&&i!==tH.MESSAGE||i!==t.action)return!1;let r=i===tH.PRESENCE?"presence":"messages",o=e[r].concat(t[r]),s=tu(o);return!!(!(s>n)&&et(o,"clientId")&&o.every(function(e){return!e.id}))&&(e[r]=o,!0)}(n.message,e,i)?(n.merged||(n.callback=ej.create(this.logger,[n.callback]),n.merged=!0),n.callback.push(t)):this.queuedMessages.push(new t$(e,t))}sendQueuedMessages(){let e;for(T.logAction(this.logger,T.LOG_MICRO,"ConnectionManager.sendQueuedMessages()","sending "+this.queuedMessages.count()+" queued messages");e=this.queuedMessages.shift();)this.sendImpl(e)}queuePendingMessages(e){e&&e.length&&(T.logAction(this.logger,T.LOG_MICRO,"ConnectionManager.queuePendingMessages()","queueing "+e.length+" pending messages"),this.queuedMessages.prepend(e))}failQueuedMessages(e){let t=this.queuedMessages.count();t>0&&(T.logAction(this.logger,T.LOG_ERROR,"ConnectionManager.failQueuedMessages()","failing "+t+" queued messages, err = "+ea(e)),this.queuedMessages.completeAllMessages(e))}onChannelMessage(e,t){this.pendingChannelMessagesState.queue.push({message:e,transport:t}),this.pendingChannelMessagesState.isProcessing||this.processNextPendingChannelMessage()}processNextPendingChannelMessage(){if(this.pendingChannelMessagesState.queue.length>0){this.pendingChannelMessagesState.isProcessing=!0;let e=this.pendingChannelMessagesState.queue.shift();this.processChannelMessage(e.message).catch(e=>{T.logAction(this.logger,T.LOG_ERROR,"ConnectionManager.processNextPendingChannelMessage() received error ",e)}).finally(()=>{this.pendingChannelMessagesState.isProcessing=!1,this.processNextPendingChannelMessage()})}}async processChannelMessage(e){await this.realtime.channels.processChannelMessage(e)}async ping(){var e;if("connected"!==this.state.state)throw new P("Unable to ping service; not connected",4e4,400);let t=null==(e=this.activeProtocol)?void 0:e.getTransport();if(!t)throw this.getStateError();T.logAction(this.logger,T.LOG_MINOR,"ConnectionManager.ping()","transport = "+t);let n=Date.now(),i=eu();return ek(new Promise(e=>{let r=o=>{o===i&&(t.off("heartbeat",r),e(Date.now()-n))};t.on("heartbeat",r),t.ping(i)}),this.options.timeouts.realtimeRequestTimeout,"Timeout waiting for heartbeat response")}abort(e){this.activeProtocol.getTransport().fail(e)}getTransportPreference(){var e,t;return this.transportPreference||t3()&&(null==(t=null==(e=E.WebStorage)?void 0:e.get)?void 0:t.call(e,t9))}persistTransportPreference(e){var t,n;this.transportPreference=e.shortName,t3()&&(null==(n=null==(t=E.WebStorage)?void 0:t.set)||n.call(t,t9,e.shortName))}unpersistTransportPreference(){var e,t;this.transportPreference=null,t3()&&(null==(t=null==(e=E.WebStorage)?void 0:e.remove)||t.call(e,t9))}actOnErrorFromAuthorize(e){if(40171===e.code)this.notifyState({state:"failed",error:e});else if(40102===e.code)this.notifyState({state:"failed",error:e});else if(e.statusCode===eU.Forbidden){let t="Client configured authentication provider returned 403; failing the connection";T.logAction(this.logger,T.LOG_ERROR,"ConnectionManager.actOnErrorFromAuthorize()",t),this.notifyState({state:"failed",error:new P(t,80019,403,e)})}else{let t="Client configured authentication provider request failed";T.logAction(this.logger,T.LOG_MINOR,"ConnectionManager.actOnErrorFromAuthorize",t),this.notifyState({state:this.state.failState,error:new P(t,80019,401,e)})}}onConnectionDetailsUpdate(e,t){if(!e)return;this.connectionDetails=e,e.maxMessageSize&&(this.options.maxMessageSize=e.maxMessageSize);let n=e.clientId;if(n){let e=this.realtime.auth._uncheckedSetClientId(n);if(e){T.logAction(this.logger,T.LOG_ERROR,"ConnectionManager.onConnectionDetailsUpdate()",e.message),t.fail(e);return}}let i=e.connectionStateTtl;i&&(this.connectionStateTtl=i),this.maxIdleInterval=e.maxIdleInterval,this.emit("connectiondetails",e)}checkWsConnectivity(){let e=new E.Config.WebSocket(eA.wsConnectivityUrl);return new Promise((t,n)=>{let i=!1;e.onopen=()=>{i||(i=!0,t(),e.close())},e.onclose=e.onerror=()=>{i||(i=!0,n())}})}sessionRecoveryName(){return this.options.recoveryKeyStorageName||"ably-connection-recovery"}getSessionRecoverData(){var e,t;return t6()&&(null==(t=null==(e=E.WebStorage)?void 0:e.getSession)?void 0:t.call(e,this.sessionRecoveryName()))}setSessionRecoverData(e){var t,n;return t6()&&(null==(n=null==(t=E.WebStorage)?void 0:t.setSession)?void 0:n.call(t,this.sessionRecoveryName(),e))}clearSessionRecoverData(){var e,t;return t6()&&(null==(t=null==(e=E.WebStorage)?void 0:e.removeSession)?void 0:t.call(e,this.sessionRecoveryName()))}},nn=class extends tF{constructor(e,t){super(e.logger),this.whenState=e=>tF.prototype.whenState.call(this,e,this.state),this.ably=e,this.connectionManager=new nt(e,t),this.state=this.connectionManager.state.state,this.key=void 0,this.id=void 0,this.errorReason=null,this.connectionManager.on("connectionstate",e=>{let t=this.state=e.current;E.Config.nextTick(()=>{this.emit(t,e)})}),this.connectionManager.on("update",e=>{E.Config.nextTick(()=>{this.emit("update",e)})})}connect(){T.logAction(this.logger,T.LOG_MINOR,"Connection.connect()",""),this.connectionManager.requestState({state:"connecting"})}async ping(){return T.logAction(this.logger,T.LOG_MINOR,"Connection.ping()",""),this.connectionManager.ping()}close(){T.logAction(this.logger,T.LOG_MINOR,"Connection.close()","connectionKey = "+this.key),this.connectionManager.requestState({state:"closing"})}get recoveryKey(){return this.logger.deprecationWarning("The `Connection.recoveryKey` attribute has been replaced by the `Connection.createRecoveryKey()` method. Replace your usage of `recoveryKey` with the return value of `createRecoveryKey()`. `recoveryKey` will be removed in a future version."),this.createRecoveryKey()}createRecoveryKey(){return this.connectionManager.createRecoveryKey()}},ni=class{constructor(e,t,n,i,r){this.previous=e,this.current=t,"attached"===t&&(this.resumed=n,this.hasBacklog=i),r&&(this.reason=r)}},nr=function(){},no=class e extends tF{constructor(e,t,n){var i,r;super(e.logger),this.retryCount=0,this.history=async function(e){T.logAction(this.logger,T.LOG_MICRO,"RealtimeChannel.history()","channel = "+this.name);let t=this.client.rest.channelMixin;if(e&&e.untilAttach){if("attached"!==this.state)throw new P("option untilAttach requires the channel to be attached",4e4,400);if(!this.properties.attachSerial)throw new P("untilAttach was specified and channel is attached, but attachSerial is not defined",4e4,400);delete e.untilAttach,e.from_serial=this.properties.attachSerial}return t.history(this,e)},this.whenState=e=>tF.prototype.whenState.call(this,e,this.state),T.logAction(this.logger,T.LOG_MINOR,"RealtimeChannel()","started; name = "+t),this.name=t,this.channelOptions=eN(null!=(i=e._Crypto)?i:null,this.logger,n),this.client=e,this._presence=e._RealtimePresence?new e._RealtimePresence.RealtimePresence(this):null,this.connectionManager=e.connection.connectionManager,this.state="initialized",this.subscriptions=new tF(this.logger),this.syncChannelSerial=void 0,this.properties={attachSerial:void 0,channelSerial:void 0},this.setOptions(n),this.errorReason=null,this._requestedFlags=null,this._mode=null,this._attachResume=!1,this._decodingContext={channelOptions:this.channelOptions,plugins:e.options.plugins||{},baseEncodedPreviousPayload:void 0},this._lastPayload={messageId:null,protocolMessageChannelSerial:null,decodeFailureRecoveryInProgress:null},this._allChannelChanges=new tF(this.logger),(null==(r=e.options.plugins)?void 0:r.Push)&&(this._push=new e.options.plugins.Push.PushChannel(this))}get presence(){return this._presence||eO("RealtimePresence"),this._presence}get push(){return this._push||eO("Push"),this._push}invalidStateError(){return new P("Channel operation failed as channel state is "+this.state,90001,400,this.errorReason||void 0)}static processListenerArgs(e){return"function"==typeof(e=Array.prototype.slice.call(e))[0]&&e.unshift(null),e}async setOptions(e){var t;let n=this.channelOptions,i=function(e){if(e&&"params"in e&&!j(e.params))return new P("options.params must be an object",4e4,400);if(e&&"modes"in e){if(!Array.isArray(e.modes))return new P("options.modes must be an array",4e4,400);for(let t=0;t<e.modes.length;t++){let n=e.modes[t];if(!n||"string"!=typeof n||!tY.includes(String.prototype.toUpperCase.call(n)))return new P("Invalid channel mode: "+n,4e4,400)}}}(e);if(i)throw i;if(this.channelOptions=eN(null!=(t=this.client._Crypto)?t:null,this.logger,e),this._decodingContext&&(this._decodingContext.channelOptions=this.channelOptions),this._shouldReattachToSetOptions(e,n))return this.attachImpl(),new Promise((e,t)=>{this._allChannelChanges.once(["attached","update","detached","failed"],function(n){switch(this.event){case"update":case"attached":e();break;default:t(n.reason)}})})}_shouldReattachToSetOptions(e,t){if(!("attached"===this.state||"attaching"===this.state))return!1;if(null==e?void 0:e.params){let n=ns(e.params),i=ns(t.params);if(Object.keys(n).length!==Object.keys(i).length||!eS(i,n))return!0}return null!=e&&!!e.modes&&(!t.modes||!eR(e.modes,t.modes))}async publish(...e){let t=e[0],n=e.length;if(!this.connectionManager.activeState())throw this.connectionManager.getError();if(1==n){if(j(t))t=[tl(t)];else if(Array.isArray(t))t=tc(t);else throw new P("The single-argument form of publish() expects a message object or an array of message objects",40013,400)}else t=[tl({name:e[0],data:e[1]})];let i=this.client.options.maxMessageSize;await to(t,this.channelOptions);let r=tu(t);if(r>i)throw new P("Maximum size of messages that can be published at once exceeded ( was "+r+" bytes; limit is "+i+" bytes)",40009,400);return new Promise((e,n)=>{this._publish(t,t=>t?n(t):e())})}_publish(e,t){T.logAction(this.logger,T.LOG_MICRO,"RealtimeChannel.publish()","message count = "+e.length);let n=this.state;switch(n){case"failed":case"suspended":t(P.fromValues(this.invalidStateError()));break;default:{T.logAction(this.logger,T.LOG_MICRO,"RealtimeChannel.publish()","sending message; channel state is "+n);let i=new tJ;i.action=tH.MESSAGE,i.channel=this.name,i.messages=e,this.sendMessage(i,t)}}}onEvent(e){T.logAction(this.logger,T.LOG_MICRO,"RealtimeChannel.onEvent()","received message");let t=this.subscriptions;for(let n=0;n<e.length;n++){let i=e[n];t.emit(i.name,i)}}async attach(){return"attached"===this.state?null:new Promise((e,t)=>{this._attach(!1,null,(n,i)=>n?t(n):e(i))})}_attach(e,t,n){n||(n=e=>{e&&T.logAction(this.logger,T.LOG_ERROR,"RealtimeChannel._attach()","Channel attach failed: "+e.toString())});let i=this.connectionManager;if(!i.activeState()){n(i.getError());return}("attaching"!==this.state||e)&&this.requestState("attaching",t),this.once(function(e){switch(this.event){case"attached":null==n||n(null,e);break;case"detached":case"suspended":case"failed":null==n||n(e.reason||i.getError()||new P("Unable to attach; reason unknown; state = "+this.event,9e4,500));break;case"detaching":null==n||n(new P("Attach request superseded by a subsequent detach request",9e4,409))}})}attachImpl(){T.logAction(this.logger,T.LOG_MICRO,"RealtimeChannel.attachImpl()","sending ATTACH message");let e=tz({action:tH.ATTACH,channel:this.name,params:this.channelOptions.params,channelSerial:this.properties.channelSerial});this._requestedFlags?e.encodeModesToFlags(this._requestedFlags):this.channelOptions.modes&&e.encodeModesToFlags(eb(this.channelOptions.modes)),this._attachResume&&e.setFlag("ATTACH_RESUME"),this._lastPayload.decodeFailureRecoveryInProgress&&(e.channelSerial=this._lastPayload.protocolMessageChannelSerial),this.sendMessage(e,nr)}async detach(){let e=this.connectionManager;if(!e.activeState())throw e.getError();switch(this.state){case"suspended":this.notifyState("detached");return;case"detached":return;case"failed":throw new P("Unable to detach; channel state = failed",90001,400);default:this.requestState("detaching");case"detaching":return new Promise((t,n)=>{this.once(function(i){switch(this.event){case"detached":t();break;case"attached":case"suspended":case"failed":n(i.reason||e.getError()||new P("Unable to detach; reason unknown; state = "+this.event,9e4,500));break;case"attaching":n(new P("Detach request superseded by a subsequent attach request",9e4,409))}})})}}detachImpl(e){T.logAction(this.logger,T.LOG_MICRO,"RealtimeChannel.detach()","sending DETACH message");let t=tz({action:tH.DETACH,channel:this.name});this.sendMessage(t,e||nr)}async subscribe(...t){let[n,i]=e.processListenerArgs(t);if("failed"===this.state)throw P.fromValues(this.invalidStateError());return n&&"object"==typeof n&&!Array.isArray(n)?this.client._FilteredSubscriptions.subscribeFilter(this,n,i):this.subscriptions.on(n,i),this.attach()}unsubscribe(...t){var n;let[i,r]=e.processListenerArgs(t);if("object"==typeof i&&!r||(null==(n=this.filteredSubscriptions)?void 0:n.has(r))){this.client._FilteredSubscriptions.getAndDeleteFilteredSubscriptions(this,i,r).forEach(e=>this.subscriptions.off(e));return}this.subscriptions.off(i,r)}sync(){switch(this.state){case"initialized":case"detaching":case"detached":throw new D("Unable to sync to channel; not attached",4e4)}let e=this.connectionManager;if(!e.activeState())throw e.getError();let t=tz({action:tH.SYNC,channel:this.name});this.syncChannelSerial&&(t.channelSerial=this.syncChannelSerial),e.send(t)}sendMessage(e,t){this.connectionManager.send(e,this.client.options.queueMessages,t)}sendPresence(e,t){let n=tz({action:tH.PRESENCE,channel:this.name,presence:Array.isArray(e)?this.client._RealtimePresence.presenceMessagesFromValuesArray(e):[this.client._RealtimePresence.presenceMessageFromValues(e)]});this.sendMessage(n,t)}async processMessage(e){(e.action===tH.ATTACHED||e.action===tH.MESSAGE||e.action===tH.PRESENCE)&&this.setChannelSerial(e.channelSerial);let t,n=!1;switch(e.action){case tH.ATTACHED:{this.properties.attachSerial=e.channelSerial,this._mode=e.getMode(),this.params=e.params||{};let t=e.decodeModesFromFlags();this.modes=t&&em(t)||void 0;let n=e.hasFlag("RESUMED"),i=e.hasFlag("HAS_PRESENCE"),r=e.hasFlag("HAS_BACKLOG");if("attached"===this.state){!n&&this._presence&&this._presence.onAttached(i);let t=new ni(this.state,this.state,n,r,e.error);this._allChannelChanges.emit("update",t),(!n||this.channelOptions.updateOnAttached)&&this.emit("update",t)}else"detaching"===this.state?this.checkPendingState():this.notifyState("attached",e.error,n,i,r);break}case tH.DETACHED:{let t=e.error?P.fromValues(e.error):new P("Channel detached",90001,404);"detaching"===this.state?this.notifyState("detached",t):"attaching"===this.state?this.notifyState("suspended",t):("attached"===this.state||"suspended"===this.state)&&this.requestState("attaching",t);break}case tH.SYNC:if(n=!0,t=this.syncChannelSerial=e.channelSerial,!e.presence)break;case tH.PRESENCE:{let i;let r=e.presence;if(!r)break;let{id:o,connectionId:s,timestamp:a}=e,l=this.channelOptions;for(let e=0;e<r.length;e++)try{i=r[e],await tb(i,l),i.connectionId||(i.connectionId=s),i.timestamp||(i.timestamp=a),i.id||(i.id=o+":"+e)}catch(e){T.logAction(this.logger,T.LOG_ERROR,"RealtimeChannel.processMessage()",e.toString())}this._presence&&this._presence.setPresence(r,n,t);break}case tH.MESSAGE:{if("attached"!==this.state){T.logAction(this.logger,T.LOG_MAJOR,"RealtimeChannel.processMessage()",'Message "'+e.id+'" skipped as this channel "'+this.name+'" state is not "attached" (state is "'+this.state+'").');return}let t=e.messages,n=t[0],i=t[t.length-1],r=e.id,o=e.connectionId,s=e.timestamp;if(n.extras&&n.extras.delta&&n.extras.delta.from!==this._lastPayload.messageId){let t='Delta message decode failure - previous message not available for message "'+e.id+'" on this channel "'+this.name+'".';T.logAction(this.logger,T.LOG_ERROR,"RealtimeChannel.processMessage()",t),this._startDecodeFailureRecovery(new P(t,40018,400));break}for(let e=0;e<t.length;e++){let n=t[e];try{await ts(n,this._decodingContext)}catch(e){switch(T.logAction(this.logger,T.LOG_ERROR,"RealtimeChannel.processMessage()",e.toString()),e.code){case 40018:this._startDecodeFailureRecovery(e);return;case 40019:case 40021:this.notifyState("failed",e);return}}n.connectionId||(n.connectionId=o),n.timestamp||(n.timestamp=s),n.id||(n.id=r+":"+e)}this._lastPayload.messageId=i.id,this._lastPayload.protocolMessageChannelSerial=e.channelSerial,this.onEvent(t);break}case tH.ERROR:{let t=e.error;t&&80016==t.code?this.checkPendingState():this.notifyState("failed",P.fromValues(t));break}default:T.logAction(this.logger,T.LOG_ERROR,"RealtimeChannel.processMessage()","Fatal protocol error: unrecognised action ("+e.action+")"),this.connectionManager.abort(t0.unknownChannelErr())}}_startDecodeFailureRecovery(e){this._lastPayload.decodeFailureRecoveryInProgress||(T.logAction(this.logger,T.LOG_MAJOR,"RealtimeChannel.processMessage()","Starting decode failure recovery process."),this._lastPayload.decodeFailureRecoveryInProgress=!0,this._attach(!0,e,()=>{this._lastPayload.decodeFailureRecoveryInProgress=!1}))}onAttached(){T.logAction(this.logger,T.LOG_MINOR,"RealtimeChannel.onAttached","activating channel; name = "+this.name)}notifyState(e,t,n,i,r){if(T.logAction(this.logger,T.LOG_MICRO,"RealtimeChannel.notifyState","name = "+this.name+", current state = "+this.state+", notifying state "+e),this.clearStateTimer(),["detached","suspended","failed"].includes(e)&&(this.properties.channelSerial=null),e===this.state)return;this._presence&&this._presence.actOnChannelState(e,i,t),"suspended"===e&&this.connectionManager.state.sendEvents?this.startRetryTimer():this.cancelRetryTimer(),t&&(this.errorReason=t);let o=new ni(this.state,e,n,r,t),s='Channel state for channel "'+this.name+'"',a=e+(t?"; reason: "+t:"");"failed"===e?T.logAction(this.logger,T.LOG_ERROR,s,a):T.logAction(this.logger,T.LOG_MAJOR,s,a),"attaching"!==e&&"suspended"!==e&&(this.retryCount=0),"attached"===e&&this.onAttached(),"attached"===e?this._attachResume=!0:("detaching"===e||"failed"===e)&&(this._attachResume=!1),this.state=e,this._allChannelChanges.emit(e,o),this.emit(e,o)}requestState(e,t){T.logAction(this.logger,T.LOG_MINOR,"RealtimeChannel.requestState","name = "+this.name+", state = "+e),this.notifyState(e,t),this.checkPendingState()}checkPendingState(){let e=this.connectionManager.state;if(!e.sendEvents){T.logAction(this.logger,T.LOG_MINOR,"RealtimeChannel.checkPendingState","sendEvents is false; state is "+this.connectionManager.state.state);return}switch(T.logAction(this.logger,T.LOG_MINOR,"RealtimeChannel.checkPendingState","name = "+this.name+", state = "+this.state),this.state){case"attaching":this.startStateTimerIfNotRunning(),this.attachImpl();break;case"detaching":this.startStateTimerIfNotRunning(),this.detachImpl();break;case"attached":this.sync()}}timeoutPendingState(){switch(this.state){case"attaching":{let e=new P("Channel attach timed out",90007,408);this.notifyState("suspended",e);break}case"detaching":{let e=new P("Channel detach timed out",90007,408);this.notifyState("attached",e);break}default:this.checkPendingState()}}startStateTimerIfNotRunning(){this.stateTimer||(this.stateTimer=setTimeout(()=>{T.logAction(this.logger,T.LOG_MINOR,"RealtimeChannel.startStateTimerIfNotRunning","timer expired"),this.stateTimer=null,this.timeoutPendingState()},this.client.options.timeouts.realtimeRequestTimeout))}clearStateTimer(){let e=this.stateTimer;e&&(clearTimeout(e),this.stateTimer=null)}startRetryTimer(){if(this.retryTimer)return;this.retryCount++;let e=ew(this.client.options.timeouts.channelRetryTimeout,this.retryCount);this.retryTimer=setTimeout(()=>{"suspended"===this.state&&this.connectionManager.state.sendEvents&&(this.retryTimer=null,T.logAction(this.logger,T.LOG_MINOR,"RealtimeChannel retry timer expired","attempting a new attach"),this.requestState("attaching"))},e)}cancelRetryTimer(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)}getReleaseErr(){let e=this.state;return"initialized"===e||"detached"===e||"failed"===e?null:new P("Can only release a channel in a state where there is no possibility of further updates from the server being received (initialized, detached, or failed); was "+e,90001,400)}setChannelSerial(e){T.logAction(this.logger,T.LOG_MICRO,"RealtimeChannel.setChannelSerial()","Updating channel serial; serial = "+e+"; previous = "+this.properties.channelSerial),e&&(this.properties.channelSerial=e)}async status(){return this.client.rest.channelMixin.status(this)}};function ns(e){let t=e||{},{agent:n}=t,i=C(t,["agent"]);return i}var na=class e extends eZ{constructor(t){var n,i;if(super(eA.objectifyOptions(t,!1,"BaseRealtime",T.defaultLogger)),T.logAction(this.logger,T.LOG_MINOR,"Realtime()",""),"string"==typeof EdgeRuntime)throw new P('Ably.Realtime instance cannot be used in Vercel Edge runtime. If you are running Vercel Edge functions, please replace your "new Ably.Realtime()" with "new Ably.Rest()" and use Ably Rest API instead of the Realtime API. If you are server-rendering your application in the Vercel Edge runtime, please use the condition "if (typeof EdgeRuntime === \'string\')" to prevent instantiating Ably.Realtime instance during SSR in the Vercel Edge runtime.',4e4,400);this._additionalTransportImplementations=e.transportImplementationsFromPlugins(this.options.plugins),this._RealtimePresence=null!=(i=null==(n=this.options.plugins)?void 0:n.RealtimePresence)?i:null,this.connection=new nn(this,this.options),this._channels=new nl(this),!1!==this.options.autoConnect&&this.connect()}static transportImplementationsFromPlugins(e){let t={};return(null==e?void 0:e.WebSocketTransport)&&(t[s.WebSocket]=e.WebSocketTransport),(null==e?void 0:e.XHRPolling)&&(t[s.XhrPolling]=e.XHRPolling),t}get channels(){return this._channels}connect(){T.logAction(this.logger,T.LOG_MINOR,"Realtime.connect()",""),this.connection.connect()}close(){T.logAction(this.logger,T.LOG_MINOR,"Realtime.close()",""),this.connection.close()}},nl=class extends tF{constructor(e){super(e.logger),this.realtime=e,this.all=Object.create(null),e.connection.connectionManager.on("transport.active",()=>{this.onTransportActive()})}channelSerials(){let e={};for(let t of Q(this.all,!0)){let n=this.all[t];n.properties.channelSerial&&(e[t]=n.properties.channelSerial)}return e}recoverChannels(e){for(let t of Q(e,!0)){let n=this.get(t);n.properties.channelSerial=e[t]}}async processChannelMessage(e){let t=e.channel;if(void 0===t){T.logAction(this.logger,T.LOG_ERROR,"Channels.processChannelMessage()","received event unspecified channel, action = "+e.action);return}let n=this.all[t];if(!n){T.logAction(this.logger,T.LOG_ERROR,"Channels.processChannelMessage()","received event for non-existent channel: "+t);return}await n.processMessage(e)}onTransportActive(){for(let e in this.all){let t=this.all[e];"attaching"===t.state||"detaching"===t.state?t.checkPendingState():"suspended"===t.state?t._attach(!1,null):"attached"===t.state&&t.requestState("attaching")}}propogateConnectionInterruption(e,t){let n=["attaching","attached","detaching","suspended"],i={closing:"detached",closed:"detached",failed:"failed",suspended:"suspended"}[e];for(let e in this.all){let r=this.all[e];n.includes(r.state)&&r.notifyState(i,t)}}get(e,t){e=String(e);let n=this.all[e];if(n){if(t){if(n._shouldReattachToSetOptions(t,n.channelOptions))throw new P("Channels.get() cannot be used to set channel options that would cause the channel to reattach. Please, use RealtimeChannel.setOptions() instead.",4e4,400);n.setOptions(t)}}else n=this.all[e]=new no(this.realtime,e,t);return n}getDerived(e,t,n){if(t.filter){let n=eM(t.filter),i=eC(e);e=`[filter=${n}${i.qualifierParam}]${i.channelName}`}return this.get(e,n)}release(e){e=String(e);let t=this.all[e];if(!t)return;let n=t.getReleaseErr();if(n)throw n;delete this.all[e]}},nc=na;function nu(e){let t=e.channel.client,n=t.auth.clientId;return(!n||"*"===n)&&"connected"===t.connection.state}function nd(e,t){if(e.isSynthesized()||t.isSynthesized())return e.timestamp>=t.timestamp;let n=e.parseId(),i=t.parseId();return n.msgSerial===i.msgSerial?n.index>i.index:n.msgSerial>i.msgSerial}var nh=class extends tF{constructor(e){super(e.logger),this.channel=e,this.syncComplete=!1,this.members=new ng(this,e=>e.clientId+":"+e.connectionId),this._myMembers=new ng(this,e=>e.clientId),this.subscriptions=new tF(this.logger),this.pendingPresence=[]}async enter(e){if(nu(this))throw new P("clientId must be specified to enter a presence channel",40012,400);return this._enterOrUpdateClient(void 0,void 0,e,"enter")}async update(e){if(nu(this))throw new P("clientId must be specified to update presence data",40012,400);return this._enterOrUpdateClient(void 0,void 0,e,"update")}async enterClient(e,t){return this._enterOrUpdateClient(void 0,e,t,"enter")}async updateClient(e,t){return this._enterOrUpdateClient(void 0,e,t,"update")}async _enterOrUpdateClient(e,t,n,i){let r=this.channel;if(!r.connectionManager.activeState())throw r.connectionManager.getError();T.logAction(this.logger,T.LOG_MICRO,"RealtimePresence."+i+"Client()","channel = "+r.name+", id = "+e+", client = "+(t||"(implicit) "+this.channel.client.auth.clientId));let o=tw(n);switch(o.action=i,e&&(o.id=e),t&&(o.clientId=t),await tr(o,r.channelOptions),r.state){case"attached":return new Promise((e,t)=>{r.sendPresence(o,n=>n?t(n):e())});case"initialized":case"detached":r.attach();case"attaching":return new Promise((e,t)=>{this.pendingPresence.push({presence:o,callback:n=>n?t(n):e()})});default:{let e=new D("Unable to "+i+" presence channel while in "+r.state+" state",90001);throw e.code=90001,e}}}async leave(e){if(nu(this))throw new P("clientId must have been specified to enter or leave a presence channel",40012,400);return this.leaveClient(void 0,e)}async leaveClient(e,t){let n=this.channel;if(!n.connectionManager.activeState())throw n.connectionManager.getError();T.logAction(this.logger,T.LOG_MICRO,"RealtimePresence.leaveClient()","leaving; channel = "+this.channel.name+", client = "+e);let i=tw(t);return i.action="leave",e&&(i.clientId=e),new Promise((e,t)=>{switch(n.state){case"attached":n.sendPresence(i,n=>n?t(n):e());break;case"attaching":this.pendingPresence.push({presence:i,callback:n=>n?t(n):e()});break;case"initialized":case"failed":{let e=new D("Unable to leave presence channel (incompatible state)",90001);t(e);break}default:t(n.invalidStateError())}})}async get(e){let t=!e||!("waitForSync"in e)||e.waitForSync;return new Promise((n,i)=>{function r(t){n(e?t.list(e):t.values())}if("suspended"===this.channel.state){t?i(P.fromValues({statusCode:400,code:91005,message:"Presence state is out of sync due to channel being in the SUSPENDED state"})):r(this.members);return}!function(e,t,n){switch(e.state){case"attached":case"suspended":n();break;case"initialized":case"detached":case"detaching":case"attaching":eg(e.attach(),function(e){e?t(e):n()});break;default:t(P.fromValues(e.invalidStateError()))}}(this.channel,e=>i(e),()=>{let e=this.members;t?e.waitSync(function(){r(e)}):r(e)})})}async history(e){T.logAction(this.logger,T.LOG_MICRO,"RealtimePresence.history()","channel = "+this.name);let t=this.channel.client.rest.presenceMixin;if(e&&e.untilAttach){if("attached"===this.channel.state)delete e.untilAttach,e.from_serial=this.channel.properties.attachSerial;else throw new P("option untilAttach requires the channel to be attached, was: "+this.channel.state,4e4,400)}return t.history(this,e)}setPresence(e,t,n){let i,r;T.logAction(this.logger,T.LOG_MICRO,"RealtimePresence.setPresence()","received presence for "+e.length+" participants; syncChannelSerial = "+n);let o=this.members,s=this._myMembers,a=[],l=this.channel.connectionManager.connectionId;t&&(this.members.startSync(),n&&(r=n.match(/^[\w-]+:(.*)$/))&&(i=r[1]));for(let t=0;t<e.length;t++){let n=tm(e[t]);switch(n.action){case"leave":o.remove(n)&&a.push(n),n.connectionId!==l||n.isSynthesized()||s.remove(n);break;case"enter":case"present":case"update":o.put(n)&&a.push(n),n.connectionId===l&&s.put(n)}}t&&!i&&(o.endSync(),this.channel.syncChannelSerial=null);for(let e=0;e<a.length;e++){let t=a[e];this.subscriptions.emit(t.action,t)}}onAttached(e){T.logAction(this.logger,T.LOG_MINOR,"RealtimePresence.onAttached()","channel = "+this.channel.name+", hasPresence = "+e),e?this.members.startSync():(this._synthesizeLeaves(this.members.values()),this.members.clear()),this._ensureMyMembersPresent();let t=this.pendingPresence,n=t.length;if(n){this.pendingPresence=[];let e=[],i=ej.create(this.logger);T.logAction(this.logger,T.LOG_MICRO,"RealtimePresence.onAttached","sending "+n+" queued presence messages");for(let r=0;r<n;r++){let n=t[r];e.push(n.presence),i.push(n.callback)}this.channel.sendPresence(e,i)}}actOnChannelState(e,t,n){switch(e){case"attached":this.onAttached(t);break;case"detached":case"failed":this._clearMyMembers(),this.members.clear();case"suspended":this.failPendingPresence(n)}}failPendingPresence(e){if(this.pendingPresence.length){T.logAction(this.logger,T.LOG_MINOR,"RealtimeChannel.failPendingPresence","channel; name = "+this.channel.name+", err = "+ea(e));for(let t=0;t<this.pendingPresence.length;t++)try{this.pendingPresence[t].callback(e)}catch(e){}this.pendingPresence=[]}}_clearMyMembers(){this._myMembers.clear()}_ensureMyMembersPresent(){let e=this._myMembers,t=e=>{if(e){let t="Presence auto-re-enter failed: "+e.toString(),n=new P(t,91004,400);T.logAction(this.logger,T.LOG_ERROR,"RealtimePresence._ensureMyMembersPresent()",t);let i=new ni(this.channel.state,this.channel.state,!0,!1,n);this.channel.emit("update",i)}};for(let n in e.map){let i=e.map[n];T.logAction(this.logger,T.LOG_MICRO,"RealtimePresence._ensureMyMembersPresent()",'Auto-reentering clientId "'+i.clientId+'" into the presence set'),eg(this._enterOrUpdateClient(i.id,i.clientId,i.data,"enter"),t)}}_synthesizeLeaves(e){let t=this.subscriptions;e.forEach(function(e){let n=tm({action:"leave",connectionId:e.connectionId,clientId:e.clientId,data:e.data,encoding:e.encoding,timestamp:Date.now()});t.emit("leave",n)})}async subscribe(...e){let t=no.processListenerArgs(e),n=t[0],i=t[1],r=this.channel;if("failed"===r.state)throw P.fromValues(r.invalidStateError());this.subscriptions.on(n,i),await r.attach()}unsubscribe(...e){let t=no.processListenerArgs(e),n=t[0],i=t[1];this.subscriptions.off(n,i)}},ng=class extends tF{constructor(e,t){super(e.logger),this.presence=e,this.map=Object.create(null),this.syncInProgress=!1,this.residualMembers=null,this.memberKey=t}get(e){return this.map[e]}getClient(e){let t=this.map,n=[];for(let i in t){let r=t[i];r.clientId==e&&"absent"!=r.action&&n.push(r)}return n}list(e){let t=this.map,n=e&&e.clientId,i=e&&e.connectionId,r=[];for(let e in t){let o=t[e];"absent"!==o.action&&(!n||n==o.clientId)&&(i&&i!=o.connectionId||r.push(o))}return r}put(e){("enter"===e.action||"update"===e.action)&&((e=tm(e)).action="present");let t=this.map,n=this.memberKey(e);this.residualMembers&&delete this.residualMembers[n];let i=t[n];return(!i||!!nd(e,i))&&(t[n]=e,!0)}values(){let e=this.map,t=[];for(let n in e){let i=e[n];"absent"!=i.action&&t.push(i)}return t}remove(e){let t=this.map,n=this.memberKey(e),i=t[n];return(!i||!!nd(e,i))&&(this.syncInProgress?((e=tm(e)).action="absent",t[n]=e):delete t[n],!0)}startSync(){let e=this.map,t=this.syncInProgress;T.logAction(this.logger,T.LOG_MINOR,"PresenceMap.startSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+t),this.syncInProgress||(this.residualMembers=F(e),this.setInProgress(!0))}endSync(){let e=this.map,t=this.syncInProgress;if(T.logAction(this.logger,T.LOG_MINOR,"PresenceMap.endSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+t),t){for(let t in e){let n=e[t];"absent"===n.action&&delete e[t]}for(let t in this.presence._synthesizeLeaves(Z(this.residualMembers)),this.residualMembers)delete e[t];this.residualMembers=null,this.setInProgress(!1)}this.emit("sync")}waitSync(e){let t=this.syncInProgress;if(T.logAction(this.logger,T.LOG_MINOR,"PresenceMap.waitSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+t),!t){e();return}this.once("sync",e)}clear(){this.map={},this.setInProgress(!1),this.residualMembers=null}setInProgress(e){T.logAction(this.logger,T.LOG_MICRO,"PresenceMap.setInProgress()","inProgress = "+e),this.syncInProgress=e,this.presence.syncComplete=!e}},nf=s.WebSocket,np=class extends t4{constructor(e,t,n){super(e,t,n),this.shortName=nf,n.heartbeats=E.Config.useProtocolHeartbeats,this.wsHost=n.host}static isAvailable(){return!!E.Config.WebSocket}createWebSocket(e,t){return this.uri=e+er(t),new E.Config.WebSocket(this.uri)}toString(){return"WebSocketTransport; uri="+this.uri}connect(){T.logAction(this.logger,T.LOG_MINOR,"WebSocketTransport.connect()","starting"),t4.prototype.connect.call(this);let e=this,t=this.params,n=t.options,i=n.tls?"wss://":"ws://",r=i+this.wsHost+":"+eA.getPort(n)+"/";T.logAction(this.logger,T.LOG_MINOR,"WebSocketTransport.connect()","uri: "+r),eg(this.auth.getAuthParams(),function(n,i){if(e.isDisposed)return;let o="";for(let e in i)o+=" "+e+": "+i[e]+";";if(T.logAction(e.logger,T.LOG_MINOR,"WebSocketTransport.connect()","authParams:"+o+" err: "+n),n){e.disconnect(n);return}let s=t.getConnectParams(i);try{let t=e.wsConnection=e.createWebSocket(r,s);t.binaryType=E.Config.binaryType,t.onopen=function(){e.onWsOpen()},t.onclose=function(t){e.onWsClose(t)},t.onmessage=function(t){e.onWsData(t.data)},t.onerror=function(t){e.onWsError(t)},t.on&&t.on("ping",function(){e.onActivity()})}catch(t){T.logAction(e.logger,T.LOG_ERROR,"WebSocketTransport.connect()","Unexpected exception creating websocket: err = "+(t.stack||t.message)),e.disconnect(t)}})}send(e){let t=this.wsConnection;if(!t){T.logAction(this.logger,T.LOG_ERROR,"WebSocketTransport.send()","No socket connection");return}try{t.send(ep(e,this.connectionManager.realtime._MsgPack,this.params.format))}catch(t){let e="Exception from ws connection when trying to send: "+ea(t);T.logAction(this.logger,T.LOG_ERROR,"WebSocketTransport.send()",e),this.finish("disconnected",new P(e,5e4,500))}}onWsData(e){T.logAction(this.logger,T.LOG_MICRO,"WebSocketTransport.onWsData()","data received; length = "+e.length+"; type = "+typeof e);try{this.onProtocolMessage(function(e,t,n,i){let r=ef(e,t,i);return tB(r,n)}(e,this.connectionManager.realtime._MsgPack,this.connectionManager.realtime._RealtimePresence,this.format))}catch(e){T.logAction(this.logger,T.LOG_ERROR,"WebSocketTransport.onWsData()","Unexpected exception handing channel message: "+e.stack)}}onWsOpen(){T.logAction(this.logger,T.LOG_MINOR,"WebSocketTransport.onWsOpen()","opened WebSocket"),this.emit("preconnect")}onWsClose(e){let t,n;if("object"==typeof e?(n=e.code,t=e.wasClean||1e3===n):t=1e3==(n=e),delete this.wsConnection,t){T.logAction(this.logger,T.LOG_MINOR,"WebSocketTransport.onWsClose()","Cleanly closed WebSocket");let e=new P("Websocket closed",80003,400);this.finish("disconnected",e)}else{let e="Unclean disconnection of WebSocket ; code = "+n,t=new P(e,80003,400);T.logAction(this.logger,T.LOG_MINOR,"WebSocketTransport.onWsClose()",e),this.finish("disconnected",t)}this.emit("disposed")}onWsError(e){T.logAction(this.logger,T.LOG_MINOR,"WebSocketTransport.onError()","Error from WebSocket: "+e.message),E.Config.nextTick(()=>{this.disconnect(Error(e.message))})}dispose(){T.logAction(this.logger,T.LOG_MINOR,"WebSocketTransport.dispose()",""),this.isDisposed=!0;let e=this.wsConnection;e&&(e.onmessage=function(){},delete this.wsConnection,E.Config.nextTick(()=>{if(T.logAction(this.logger,T.LOG_MICRO,"WebSocketTransport.dispose()","closing websocket"),!e)throw Error("WebSocketTransport.dispose(): wsConnection is not defined");e.close()}))}},nm=class{static subscribeFilter(e,t,n){let i=e=>{var i,r,o,s,a,l;let c={name:e.name,refTimeserial:null==(r=null==(i=e.extras)?void 0:i.ref)?void 0:r.timeserial,refType:null==(s=null==(o=e.extras)?void 0:o.ref)?void 0:s.type,isRef:!!(null==(l=null==(a=e.extras)?void 0:a.ref)?void 0:l.timeserial),clientId:e.clientId};Object.entries(t).find(([e,t])=>void 0!==t&&c[e]!==t)||n(e)};this.addFilteredSubscription(e,t,n,i),e.subscriptions.on(i)}static addFilteredSubscription(e,t,n,i){var r;if(e.filteredSubscriptions||(e.filteredSubscriptions=new Map),e.filteredSubscriptions.has(n)){let o=e.filteredSubscriptions.get(n);o.set(t,(null==(r=null==o?void 0:o.get(t))?void 0:r.concat(i))||[i])}else e.filteredSubscriptions.set(n,new Map([[t,[i]]]))}static getAndDeleteFilteredSubscriptions(e,t,n){if(!e.filteredSubscriptions)return[];if(!n&&t)return Array.from(e.filteredSubscriptions.entries()).map(([n,i])=>{var r;let o=i.get(t);return i.delete(t),0===i.size&&(null==(r=e.filteredSubscriptions)||r.delete(n)),o}).reduce((e,t)=>t?e.concat(...t):e,[]);if(!n||!e.filteredSubscriptions.has(n))return[];let i=e.filteredSubscriptions.get(n);if(!t){let t=Array.from(i.values()).reduce((e,t)=>e.concat(...t),[]);return e.filteredSubscriptions.delete(n),t}let r=i.get(t);return i.delete(t),r||[]}},nb=class e extends nc{constructor(t){var n;let i=e._MsgPack;if(!i)throw Error("Expected DefaultRealtime._MsgPack to have been set");super(eA.objectifyOptions(t,!0,"Realtime",T.defaultLogger,S(_({},tT),{Crypto:null!=(n=e.Crypto)?n:void 0,MsgPack:i,RealtimePresence:{RealtimePresence:nh,presenceMessageFromValues:tm,presenceMessagesFromValuesArray:tv},WebSocketTransport:np,MessageInteractions:nm})))}static get Crypto(){if(null===this._Crypto)throw Error("Encryption not enabled; use ably.encryption.js instead");return this._Crypto}static set Crypto(e){this._Crypto=e}};nb.Utils=L,nb.ConnectionManager=nt,nb.ProtocolMessage=tJ,nb._Crypto=null,nb.Message=tL,nb.PresenceMessage=tI,nb._MsgPack=null,nb._Http=eX;var ny=nb,nv=Uint8Array,nw=Uint32Array,n_=Math.pow,nS=new nw(8),nC=[],nM=new nw(64);function nR(e){return(e-(0|e))*n_(2,32)|0}for(var nE=2,nO=0;nO<64;){for(l=2,a=!0;l<=nE/2;l++)nE%l==0&&(a=!1);a&&(nO<8&&(nS[nO]=nR(n_(nE,.5))),nC[nO]=nR(n_(nE,1/3)),nO++),nE++}var nk=!!new nv(new nw([1]).buffer)[0];function nx(e){return nk?e>>>24|(e>>>16&255)<<8|(65280&e)<<8|e<<24:e}function nA(e,t){return e>>>t|e<<32-t}function nT(e){var t=nS.slice(),n=e.length,i=8*n,r=512-(i+64)%512-1+i+65,o=new nv(r/8),s=new nw(o.buffer);o.set(e,0),o[n]=128,s[s.length-1]=nx(i);for(var a=0;a<r/32;a+=16){var l=t.slice();for(c=0;c<64;c++){if(c<16)u=nx(s[a+c]);else{var c,u,d=nM[c-15],h=nM[c-2];u=nM[c-7]+nM[c-16]+(nA(d,7)^nA(d,18)^d>>>3)+(nA(h,17)^nA(h,19)^h>>>10)}nM[c]=u|=0;for(var g=(nA(l[4],6)^nA(l[4],11)^nA(l[4],25))+(l[4]&l[5]^~l[4]&l[6])+l[7]+u+nC[c],f=(nA(l[0],2)^nA(l[0],13)^nA(l[0],22))+(l[0]&l[1]^l[2]&(l[0]^l[1])),p=7;p>0;p--)l[p]=l[p-1];l[0]=g+f|0,l[4]=l[4]+g|0}for(c=0;c<8;c++)t[c]=t[c]+l[c]|0}return new nv(new nw(t.map(function(e){return nx(e)})).buffer)}var nL=new class{constructor(){this.base64CharSet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",this.hexCharSet="0123456789abcdef"}uint8ViewToBase64(e){let t,n,i,r,o,s="",a=this.base64CharSet,l=e.byteLength,c=l%3,u=l-c;for(let l=0;l<u;l+=3)t=(16515072&(o=e[l]<<16|e[l+1]<<8|e[l+2]))>>18,n=(258048&o)>>12,i=(4032&o)>>6,r=63&o,s+=a[t]+a[n]+a[i]+a[r];return 1==c?(t=(252&(o=e[u]))>>2,n=(3&o)<<4,s+=a[t]+a[n]+"=="):2==c&&(t=(64512&(o=e[u]<<8|e[u+1]))>>10,n=(1008&o)>>4,i=(15&o)<<2,s+=a[t]+a[n]+a[i]+"="),s}base64ToArrayBuffer(e){let t=null==atob?void 0:atob(e),n=t.length,i=new Uint8Array(n);for(let e=0;e<n;e++){let n=t.charCodeAt(e);i[e]=n}return this.toArrayBuffer(i)}isBuffer(e){return e instanceof ArrayBuffer||ArrayBuffer.isView(e)}toBuffer(e){if(!ArrayBuffer)throw Error("Can't convert to Buffer: browser does not support the necessary types");if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(this.toArrayBuffer(e));throw Error("BufferUtils.toBuffer expected an ArrayBuffer or a view onto one")}toArrayBuffer(e){if(!ArrayBuffer)throw Error("Can't convert to ArrayBuffer: browser does not support the necessary types");if(e instanceof ArrayBuffer)return e;if(ArrayBuffer.isView(e))return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);throw Error("BufferUtils.toArrayBuffer expected an ArrayBuffer or a view onto one")}base64Encode(e){return this.uint8ViewToBase64(this.toBuffer(e))}base64Decode(e){if(ArrayBuffer&&E.Config.atob)return this.base64ToArrayBuffer(e);throw Error("Expected ArrayBuffer to exist and Platform.Config.atob to be configured")}hexEncode(e){let t=this.toBuffer(e);return t.reduce((e,t)=>e+t.toString(16).padStart(2,"0"),"")}hexDecode(e){if(e.length%2!=0)throw Error("Can't create a byte array from a hex string of odd length");let t=new Uint8Array(e.length/2);for(let n=0;n<t.length;n++)t[n]=parseInt(e.slice(2*n,2*(n+1)),16);return this.toArrayBuffer(t)}utf8Encode(e){if(E.Config.TextEncoder){let t=new E.Config.TextEncoder().encode(e);return this.toArrayBuffer(t)}throw Error("Expected TextEncoder to be configured")}utf8Decode(e){if(!this.isBuffer(e))throw Error("Expected input of utf8decode to be an arraybuffer or typed array");if(TextDecoder)return new TextDecoder().decode(e);throw Error("Expected TextDecoder to be configured")}areBuffersEqual(e,t){if(!e||!t)return!1;let n=this.toArrayBuffer(e),i=this.toArrayBuffer(t);if(n.byteLength!=i.byteLength)return!1;let r=new Uint8Array(n),o=new Uint8Array(i);for(var s=0;s<r.length;s++)if(r[s]!=o[s])return!1;return!0}byteLength(e){return e instanceof ArrayBuffer||ArrayBuffer.isView(e)?e.byteLength:-1}arrayBufferViewToBuffer(e){return this.toArrayBuffer(e)}hmacSha256(e,t){let n=function(e,t){if(e.length>64&&(e=nT(e)),e.length<64){let t=new Uint8Array(64);t.set(e,0),e=t}for(var n=new Uint8Array(64),i=new Uint8Array(64),r=0;r<64;r++)n[r]=54^e[r],i[r]=92^e[r];var o=new Uint8Array(t.length+64);o.set(n,0),o.set(t,64);var s=new Uint8Array(96);return s.set(i,0),s.set(nT(o),64),nT(s)}(this.toBuffer(t),this.toBuffer(e));return this.toArrayBuffer(n)}},nI=((o=nI||{})[o.REQ_SEND=0]="REQ_SEND",o[o.REQ_RECV=1]="REQ_RECV",o[o.REQ_RECV_POLL=2]="REQ_RECV_POLL",o[o.REQ_RECV_STREAM=3]="REQ_RECV_STREAM",o);function nP(){return new P("No HTTP request plugin provided. Provide at least one of the FetchRequest or XHRRequest plugins.",400,4e4)}var nD=((c=class{constructor(e){var t;this.checksInProgress=null,this.checkConnectivity=void 0,this.supportsAuthHeaders=!1,this.supportsLinkHeaders=!1,this.client=null!=e?e:null;let n=(null==e?void 0:e.options.connectivityCheckUrl)||eA.connectivityCheckUrl,i=null!=(t=null==e?void 0:e.options.connectivityCheckParams)?t:null,r=!(null==e?void 0:e.options.connectivityCheckUrl),o=_(_({},nD.bundledRequestImplementations),null==e?void 0:e._additionalHTTPRequestImplementations),s=o.XHRRequest,a=o.FetchRequest,l=!!(s||a);if(!l)throw nP();E.Config.xhrSupported&&s?(this.supportsAuthHeaders=!0,this.Request=async function(t,n,i,r,o){return new Promise(a=>{var l;let c=s.createRequest(n,i,r,o,nI.REQ_SEND,null!=(l=e&&e.options.timeouts)?l:null,this.logger,t);c.once("complete",(e,t,n,i,r)=>a({error:e,body:t,headers:n,unpacked:i,statusCode:r})),c.exec()})},(null==e?void 0:e.options.disableConnectivityCheck)?this.checkConnectivity=async function(){return!0}:this.checkConnectivity=async function(){var e,t;T.logAction(this.logger,T.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Sending; "+n);let o=await this.doUri(eG.Get,n,null,null,i),s=!1;return s=r?!o.error&&(null==(e=o.body)?void 0:e.replace(/\n/,""))=="yes":!o.error&&(t=o.statusCode)>=200&&t<400,T.logAction(this.logger,T.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Result: "+s),s}):E.Config.fetchSupported&&a?(this.supportsAuthHeaders=!0,this.Request=async(t,n,i,r,o)=>a(t,null!=e?e:null,n,i,r,o),this.checkConnectivity=async function(){var e;T.logAction(this.logger,T.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Sending; "+n);let t=await this.doUri(eG.Get,n,null,null,null),i=!t.error&&(null==(e=t.body)?void 0:e.replace(/\n/,""))=="yes";return T.logAction(this.logger,T.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Result: "+i),i}):this.Request=async()=>{let e=l?new D("no supported HTTP transports available",null,400):nP();return{error:e}}}get logger(){var e,t;return null!=(t=null==(e=this.client)?void 0:e.logger)?t:T.defaultLogger}async doUri(e,t,n,i,r){return this.Request?this.Request(e,t,n,r,i):{error:new D("Request invoked before assigned to",null,500)}}shouldFallback(e){let t=e.statusCode;return 408===t&&!e.code||400===t&&!e.code||t>=500&&t<=504}}).methods=[eG.Get,eG.Delete,eG.Post,eG.Put,eG.Patch],c.methodsWithoutBody=[eG.Get,eG.Delete],c.methodsWithBody=[eG.Post,eG.Put,eG.Patch],c),nN="ablyjs-storage-test",nF=void 0!==n.g?n.g:"undefined"!=typeof window?window:self,nH=new class{constructor(){try{nF.sessionStorage.setItem(nN,nN),nF.sessionStorage.removeItem(nN),this.sessionSupported=!0}catch(e){this.sessionSupported=!1}try{nF.localStorage.setItem(nN,nN),nF.localStorage.removeItem(nN),this.localSupported=!0}catch(e){this.localSupported=!1}}get(e){return this._get(e,!1)}getSession(e){return this._get(e,!0)}remove(e){return this._remove(e,!1)}removeSession(e){return this._remove(e,!0)}set(e,t,n){return this._set(e,t,n,!1)}setSession(e,t,n){return this._set(e,t,n,!0)}_set(e,t,n,i){let r={value:t};return n&&(r.expires=Date.now()+n),this.storageInterface(i).setItem(e,JSON.stringify(r))}_get(e,t){if(t&&!this.sessionSupported)throw Error("Session Storage not supported");if(!t&&!this.localSupported)throw Error("Local Storage not supported");let n=this.storageInterface(t).getItem(e);if(!n)return null;let i=JSON.parse(n);return i.expires&&i.expires<Date.now()?(this.storageInterface(t).removeItem(e),null):i.value}_remove(e,t){return this.storageInterface(t).removeItem(e)}storageInterface(e){return e?nF.sessionStorage:nF.localStorage}},nj=e_(),nG="string"==typeof EdgeRuntime;"undefined"!=typeof Window||"undefined"!=typeof WorkerGlobalScope||nG||console.log("Warning: this distribution of Ably is intended for browsers. On nodejs, please use the 'ably' package on npm");var nU={agent:"browser",logTimestamps:!0,userAgent:nj.navigator&&nj.navigator.userAgent.toString(),currentUrl:nj.location&&nj.location.href,binaryType:"arraybuffer",WebSocket:nj.WebSocket,fetchSupported:!!nj.fetch,xhrSupported:nj.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,allowComet:function(){let e=nj.location;return!nj.WebSocket||!e||!e.origin||e.origin.indexOf("http")>-1}(),useProtocolHeartbeats:!0,supportsBinary:!!nj.TextDecoder,preferBinary:!1,ArrayBuffer:nj.ArrayBuffer,atob:nj.atob,nextTick:void 0!==nj.setImmediate?nj.setImmediate.bind(nj):function(e){setTimeout(e,0)},addEventListener:nj.addEventListener,inspect:JSON.stringify,stringByteSize:function(e){return nj.TextDecoder&&new nj.TextEncoder().encode(e).length||e.length},TextEncoder:nj.TextEncoder,TextDecoder:nj.TextDecoder,getRandomArrayBuffer:async function(e){let t=new Uint8Array(e);return nj.crypto.getRandomValues(t),t.buffer},isWebworker:!!("undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope),push:{platform:"browser",formFactor:"desktop",storage:nH}};function nV(e){return e.code&&!eJ.isTokenErr(e)&&([80015,80017,80030].includes(e.code)||e.code>=4e4&&e.code<5e4)?[tz({action:tH.ERROR,error:e})]:[tz({action:tH.DISCONNECTED,error:e})]}var nY=class extends t4{constructor(e,t,n){super(e,t,n,!0),this.onAuthUpdated=e=>{this.authParams={access_token:e.token}},this.stream=!("stream"in n)||n.stream,this.sendRequest=null,this.recvRequest=null,this.pendingCallback=null,this.pendingItems=null}connect(){T.logAction(this.logger,T.LOG_MINOR,"CometTransport.connect()","starting"),t4.prototype.connect.call(this);let e=this.params,t=e.options,n=eA.getHost(t,e.host),i=eA.getPort(t),r=t.tls?"https://":"http://";this.baseUri=r+n+":"+i+"/comet/";let o=this.baseUri+"connect";T.logAction(this.logger,T.LOG_MINOR,"CometTransport.connect()","uri: "+o),eg(this.auth.getAuthParams(),(e,t)=>{if(e){this.disconnect(e);return}if(this.isDisposed)return;this.authParams=t;let n=this.params.getConnectParams(t);"stream"in n&&(this.stream=n.stream),T.logAction(this.logger,T.LOG_MINOR,"CometTransport.connect()","connectParams:"+er(n));let i=!1,r=this.recvRequest=this.createRequest(o,null,n,null,this.stream?nI.REQ_RECV_STREAM:nI.REQ_RECV);r.on("data",e=>{this.recvRequest&&(i||(i=!0,this.emit("preconnect")),this.onData(e))}),r.on("complete",e=>{if(this.recvRequest||(e=e||new P("Request cancelled",80003,400)),this.recvRequest=null,i||e||(i=!0,this.emit("preconnect")),this.onActivity(),e){e.code?this.onData(nV(e)):this.disconnect(e);return}E.Config.nextTick(()=>{this.recv()})}),r.exec()})}requestClose(){T.logAction(this.logger,T.LOG_MINOR,"CometTransport.requestClose()"),this._requestCloseOrDisconnect(!0)}requestDisconnect(){T.logAction(this.logger,T.LOG_MINOR,"CometTransport.requestDisconnect()"),this._requestCloseOrDisconnect(!1)}_requestCloseOrDisconnect(e){let t=e?this.closeUri:this.disconnectUri;if(t){let n=this.createRequest(t,null,this.authParams,null,nI.REQ_SEND);n.on("complete",t=>{t&&(T.logAction(this.logger,T.LOG_ERROR,"CometTransport.request"+(e?"Close()":"Disconnect()"),"request returned err = "+ea(t)),this.finish("disconnected",t))}),n.exec()}}dispose(){T.logAction(this.logger,T.LOG_MINOR,"CometTransport.dispose()",""),this.isDisposed||(this.isDisposed=!0,this.recvRequest&&(T.logAction(this.logger,T.LOG_MINOR,"CometTransport.dispose()","aborting recv request"),this.recvRequest.abort(),this.recvRequest=null),this.finish("disconnected",t0.disconnected()),E.Config.nextTick(()=>{this.emit("disposed")}))}onConnect(e){var t;if(this.isDisposed)return;let n=null==(t=e.connectionDetails)?void 0:t.connectionKey;t4.prototype.onConnect.call(this,e);let i=this.baseUri+n;T.logAction(this.logger,T.LOG_MICRO,"CometTransport.onConnect()","baseUri = "+i),this.sendUri=i+"/send",this.recvUri=i+"/recv",this.closeUri=i+"/close",this.disconnectUri=i+"/disconnect"}send(e){if(this.sendRequest){this.pendingItems=this.pendingItems||[],this.pendingItems.push(e);return}let t=this.pendingItems||[];t.push(e),this.pendingItems=null,this.sendItems(t)}sendAnyPending(){let e=this.pendingItems;e&&(this.pendingItems=null,this.sendItems(e))}sendItems(e){let t=this.sendRequest=this.createRequest(this.sendUri,null,this.authParams,this.encodeRequest(e),nI.REQ_SEND);t.on("complete",(e,t)=>{if(e&&T.logAction(this.logger,T.LOG_ERROR,"CometTransport.sendItems()","on complete: err = "+ea(e)),this.sendRequest=null,e){e.code?this.onData(nV(e)):this.disconnect(e);return}t&&this.onData(t),this.pendingItems&&E.Config.nextTick(()=>{this.sendRequest||this.sendAnyPending()})}),t.exec()}recv(){if(this.recvRequest||!this.isConnected)return;let e=this.recvRequest=this.createRequest(this.recvUri,null,this.authParams,null,this.stream?nI.REQ_RECV_STREAM:nI.REQ_RECV_POLL);e.on("data",e=>{this.onData(e)}),e.on("complete",e=>{if(this.recvRequest=null,this.onActivity(),e){e.code?this.onData(nV(e)):this.disconnect(e);return}E.Config.nextTick(()=>{this.recv()})}),e.exec()}onData(e){try{let t=this.decodeResponse(e);if(t&&t.length)for(let e=0;e<t.length;e++)this.onProtocolMessage(tB(t[e],this.connectionManager.realtime._RealtimePresence))}catch(e){T.logAction(this.logger,T.LOG_ERROR,"CometTransport.onData()","Unexpected exception handing channel event: "+e.stack)}}encodeRequest(e){return JSON.stringify(e)}decodeResponse(e){return"string"==typeof e?JSON.parse(e):e}},nB=function(){},nq=0,nz={},nW=class e extends tF{constructor(e,t,n,i,r,o,s,a){super(s),(n=n||{}).rnd=eu(),this.uri=e+er(n),this.headers=t||{},this.body=i,this.method=a?a.toUpperCase():U(i)?"GET":"POST",this.requestMode=r,this.timeouts=o,this.timedOut=!1,this.requestComplete=!1,this.id=String(++nq),nz[this.id]=this}static createRequest(t,n,i,r,o,s,a,l){let c=s||eA.TIMEOUTS;return new e(t,n,F(i),r,o,c,a,l)}complete(e,t,n,i,r){this.requestComplete||(this.requestComplete=!0,!e&&t&&this.emit("data",t),this.emit("complete",e,t,n,i,r),this.dispose())}abort(){this.dispose()}exec(){let e,t,n,i=this.headers,r=this.requestMode==nI.REQ_SEND?this.timeouts.httpRequestTimeout:this.timeouts.recvTimeout,o=this.timer=setTimeout(()=>{this.timedOut=!0,a.abort()},r),s=this.method,a=this.xhr=new XMLHttpRequest,l=i.accept,c=this.body,u="text";if(l?0===l.indexOf("application/x-msgpack")&&(u="arraybuffer"):i.accept="application/json",c){let e=i["content-type"]||(i["content-type"]="application/json");e.indexOf("application/json")>-1&&"string"!=typeof c&&(c=JSON.stringify(c))}for(let e in a.open(s,this.uri,!0),a.responseType=u,"authorization"in i&&(a.withCredentials=!0),i)a.setRequestHeader(e,i[e]);let d=(e,t,n,i)=>{var r;let o=t+" (event type: "+e.type+")";(null==(r=this==null?void 0:this.xhr)?void 0:r.statusText)&&(o+=", current statusText is "+this.xhr.statusText),T.logAction(this.logger,T.LOG_ERROR,"Request.on"+e.type+"()",o),this.complete(new D(o,n,i))};a.onerror=function(e){d(e,"XHR error occurred",null,400)},a.onabort=e=>{this.timedOut?d(e,"Request aborted due to request timeout expiring",null,408):d(e,"Request cancelled",null,400)},a.ontimeout=function(e){d(e,"Request timed out",null,408)};let h=0,g=!1,f=()=>{var i;if(clearTimeout(o),n=t<400,204==t){this.complete(null,null,null,null,t);return}e=this.requestMode==nI.REQ_RECV_STREAM&&n&&(i=a).getResponseHeader&&(i.getResponseHeader("transfer-encoding")||!i.getResponseHeader("content-length"))},p=()=>{let e;try{let r=a.getResponseHeader&&a.getResponseHeader("content-type"),o=r?r.indexOf("application/json")>=0:"text"==a.responseType;if(o){let t="arraybuffer"===a.responseType?E.BufferUtils.utf8Decode(a.response):String(a.responseText);e=t.length?JSON.parse(t):t,g=!0}else e=a.response;void 0!==e.response?(n=(t=e.statusCode)<400,i=e.headers,e=e.response):i=function(e){let t=e.getAllResponseHeaders().trim().split("\r\n"),n={};for(let e=0;e<t.length;e++){let i=t[e].split(":").map(e=>e.trim());n[i[0].toLowerCase()]=i[1]}return n}(a)}catch(e){this.complete(new D("Malformed response body from server: "+e.message,null,400));return}if(n||Array.isArray(e)){this.complete(null,e,i,g,t);return}let r=function(e,t){if(em(Q(t)).includes("x-ably-errorcode"))return e.error&&P.fromValues(e.error)}(e,i);r||(r=new D("Error response received from server: "+t+" body was: "+E.Config.inspect(e),null,t)),this.complete(r,e,i,g,t)};function m(){let e,t;let n=a.responseText,i=n.length-1;for(;h<i&&(e=n.indexOf("\n",h))>-1;)t=n.slice(h,e),h=e+1,b(t)}let b=e=>{try{e=JSON.parse(e)}catch(e){this.complete(new D("Malformed response body from server: "+e.message,null,400));return}this.emit("data",e)},y=()=>{m(),this.streamComplete=!0,E.Config.nextTick(()=>{this.complete()})};a.onreadystatechange=function(){let n=a.readyState;n<3||0===a.status||(void 0===t&&(t=a.status,f()),3==n&&e?m():4==n&&(e?y():p()))},a.send(c)}dispose(){let e=this.xhr;if(e){e.onreadystatechange=e.onerror=e.onabort=e.ontimeout=nB,this.xhr=null;let t=this.timer;t&&(clearTimeout(t),this.timer=null),this.requestComplete||e.abort()}delete nz[this.id]}},nJ=s.XhrPolling,nK=class extends nY{constructor(e,t,n){super(e,t,n),this.shortName=nJ,n.stream=!1,this.shortName=nJ}static isAvailable(){return!!(E.Config.xhrSupported&&E.Config.allowComet)}toString(){return"XHRPollingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected}createRequest(e,t,n,i,r){return nW.createRequest(e,t,n,i,r,this.timeouts,this.logger)}},n$={connectivityCheckUrl:"https://internet-up.ably-realtime.com/is-the-internet-up.txt",wsConnectivityUrl:"wss://ws-up.ably-realtime.com",defaultTransports:[s.XhrPolling,s.WebSocket]};function nX(e,t,n){for(let i=0,r=n.length;i<r;i++){let r=n.charCodeAt(i);if(r<128){e.setUint8(t++,r>>>0&127|0);continue}if(r<2048){e.setUint8(t++,r>>>6&31|192),e.setUint8(t++,r>>>0&63|128);continue}if(r<65536){e.setUint8(t++,r>>>12&15|224),e.setUint8(t++,r>>>6&63|128),e.setUint8(t++,r>>>0&63|128);continue}if(r<1114112){e.setUint8(t++,r>>>18&7|240),e.setUint8(t++,r>>>12&63|128),e.setUint8(t++,r>>>6&63|128),e.setUint8(t++,r>>>0&63|128);continue}throw Error("bad codepoint "+r)}}function nQ(e,t,n){let i="";for(let r=t,o=t+n;r<o;r++){let t=e.getUint8(r);if((128&t)==0){i+=String.fromCharCode(t);continue}if((224&t)==192){i+=String.fromCharCode((15&t)<<6|63&e.getUint8(++r));continue}if((240&t)==224){i+=String.fromCharCode((15&t)<<12|(63&e.getUint8(++r))<<6|(63&e.getUint8(++r))<<0);continue}if((248&t)==240){i+=String.fromCharCode((7&t)<<18|(63&e.getUint8(++r))<<12|(63&e.getUint8(++r))<<6|(63&e.getUint8(++r))<<0);continue}throw Error("Invalid byte "+t.toString(16))}return i}function nZ(e){let t=0;for(let n=0,i=e.length;n<i;n++){let i=e.charCodeAt(n);if(i<128){t+=1;continue}if(i<2048){t+=2;continue}if(i<65536){t+=3;continue}if(i<1114112){t+=4;continue}throw Error("bad codepoint "+i)}return t}var n0=class{constructor(e,t){this.map=e=>{let t={};for(let n=0;n<e;n++){let e=this.parse();t[e]=this.parse()}return t},this.bin=e=>{let t=new ArrayBuffer(e);return new Uint8Array(t).set(new Uint8Array(this.view.buffer,this.offset,e),0),this.offset+=e,t},this.buf=this.bin,this.str=e=>{let t=nQ(this.view,this.offset,e);return this.offset+=e,t},this.array=e=>{let t=Array(e);for(let n=0;n<e;n++)t[n]=this.parse();return t},this.ext=e=>(this.offset+=e,{type:this.view.getInt8(this.offset),data:this.buf(e)}),this.parse=()=>{var e,t,n,i;let r,o;let s=this.view.getUint8(this.offset);if((128&s)==0)return this.offset++,s;if((240&s)==128)return o=15&s,this.offset++,this.map(o);if((240&s)==144)return o=15&s,this.offset++,this.array(o);if((224&s)==160)return o=31&s,this.offset++,this.str(o);if((224&s)==224)return r=this.view.getInt8(this.offset),this.offset++,r;switch(s){case 192:return this.offset++,null;case 193:this.offset++;return;case 194:return this.offset++,!1;case 195:return this.offset++,!0;case 196:return o=this.view.getUint8(this.offset+1),this.offset+=2,this.bin(o);case 197:return o=this.view.getUint16(this.offset+1),this.offset+=3,this.bin(o);case 198:return o=this.view.getUint32(this.offset+1),this.offset+=5,this.bin(o);case 199:return o=this.view.getUint8(this.offset+1),this.offset+=2,this.ext(o);case 200:return o=this.view.getUint16(this.offset+1),this.offset+=3,this.ext(o);case 201:return o=this.view.getUint32(this.offset+1),this.offset+=5,this.ext(o);case 202:return r=this.view.getFloat32(this.offset+1),this.offset+=5,r;case 203:return r=this.view.getFloat64(this.offset+1),this.offset+=9,r;case 204:return r=this.view.getUint8(this.offset+1),this.offset+=2,r;case 205:return r=this.view.getUint16(this.offset+1),this.offset+=3,r;case 206:return r=this.view.getUint32(this.offset+1),this.offset+=5,r;case 207:return e=this.view,t=(t=this.offset+1)||0,r=4294967296*e.getUint32(t)+e.getUint32(t+4),this.offset+=9,r;case 208:return r=this.view.getInt8(this.offset+1),this.offset+=2,r;case 209:return r=this.view.getInt16(this.offset+1),this.offset+=3,r;case 210:return r=this.view.getInt32(this.offset+1),this.offset+=5,r;case 211:return n=this.view,i=(i=this.offset+1)||0,r=4294967296*n.getInt32(i)+n.getUint32(i+4),this.offset+=9,r;case 212:return o=1,this.offset++,this.ext(o);case 213:return o=2,this.offset++,this.ext(o);case 214:return o=4,this.offset++,this.ext(o);case 215:return o=8,this.offset++,this.ext(o);case 216:return o=16,this.offset++,this.ext(o);case 217:return o=this.view.getUint8(this.offset+1),this.offset+=2,this.str(o);case 218:return o=this.view.getUint16(this.offset+1),this.offset+=3,this.str(o);case 219:return o=this.view.getUint32(this.offset+1),this.offset+=5,this.str(o);case 220:return o=this.view.getUint16(this.offset+1),this.offset+=3,this.array(o);case 221:return o=this.view.getUint32(this.offset+1),this.offset+=5,this.array(o);case 222:return o=this.view.getUint16(this.offset+1),this.offset+=3,this.map(o);case 223:return o=this.view.getUint32(this.offset+1),this.offset+=5,this.map(o)}throw Error("Unknown type 0x"+s.toString(16))},this.offset=t||0,this.view=e}};function n1(e,t){return Object.keys(e).filter(function(n){let i=e[n];return(!t||null!=i)&&("function"!=typeof i||!!i.toJSON)})}var n2={encode:function(e,t){let n=function e(t,n){let i=typeof t;if("string"===i){let e=nZ(t);if(e<32)return 1+e;if(e<256)return 2+e;if(e<65536)return 3+e;if(e<4294967296)return 5+e}if(ArrayBuffer.isView&&ArrayBuffer.isView(t)&&(t=t.buffer),t instanceof ArrayBuffer){let e=t.byteLength;if(e<256)return 2+e;if(e<65536)return 3+e;if(e<4294967296)return 5+e}if("number"==typeof t){if(Math.floor(t)!==t)return 9;if(t>=0){if(t<128)return 1;if(t<256)return 2;if(t<65536)return 3;if(t<4294967296)return 5;if(t<18446744073709552e3)return 9;throw Error("Number too big 0x"+t.toString(16))}if(t>=-32)return 1;if(t>=-128)return 2;if(t>=-32768)return 3;if(t>=-2147483648)return 5;if(t>=-0x8000000000000000)return 9;throw Error("Number too small -0x"+t.toString(16).substr(1))}if("boolean"===i)return 1;if(null===t)return n?0:1;if(void 0===t)return n?0:3;if("function"==typeof t.toJSON)return e(t.toJSON(),n);if("object"===i){let i,r=0;if(Array.isArray(t)){i=t.length;for(let o=0;o<i;o++)r+=e(t[o],n)}else{let o=n1(t,n);i=o.length;for(let s=0;s<i;s++){let i=o[s];r+=e(i)+e(t[i],n)}}if(i<16)return 1+r;if(i<65536)return 3+r;if(i<4294967296)return 5+r;throw Error("Array or object too long 0x"+i.toString(16))}if("function"===i)return 0;throw Error("Unknown type "+i)}(e,t);if(0===n)return;let i=new ArrayBuffer(n),r=new DataView(i);return function e(t,n,i,r){let o=typeof t;if("string"==typeof t){let e=nZ(t);if(e<32)return n.setUint8(i,160|e),nX(n,i+1,t),1+e;if(e<256)return n.setUint8(i,217),n.setUint8(i+1,e),nX(n,i+2,t),2+e;if(e<65536)return n.setUint8(i,218),n.setUint16(i+1,e),nX(n,i+3,t),3+e;if(e<4294967296)return n.setUint8(i,219),n.setUint32(i+1,e),nX(n,i+5,t),5+e}if(ArrayBuffer.isView&&ArrayBuffer.isView(t)&&(t=t.buffer),t instanceof ArrayBuffer){let e=t.byteLength;if(e<256)return n.setUint8(i,196),n.setUint8(i+1,e),new Uint8Array(n.buffer).set(new Uint8Array(t),i+2),2+e;if(e<65536)return n.setUint8(i,197),n.setUint16(i+1,e),new Uint8Array(n.buffer).set(new Uint8Array(t),i+3),3+e;if(e<4294967296)return n.setUint8(i,198),n.setUint32(i+1,e),new Uint8Array(n.buffer).set(new Uint8Array(t),i+5),5+e}if("number"==typeof t){var s,a,l,c;if(Math.floor(t)!==t)return n.setUint8(i,203),n.setFloat64(i+1,t),9;if(t>=0){if(t<128)return n.setUint8(i,t),1;if(t<256)return n.setUint8(i,204),n.setUint8(i+1,t),2;if(t<65536)return n.setUint8(i,205),n.setUint16(i+1,t),3;if(t<4294967296)return n.setUint8(i,206),n.setUint32(i+1,t),5;if(t<18446744073709552e3)return n.setUint8(i,207),s=i+1,(a=t)<18446744073709552e3?(n.setUint32(s,Math.floor(23283064365386963e-26*a)),n.setInt32(s+4,-1&a)):(n.setUint32(s,4294967295),n.setUint32(s+4,4294967295)),9;throw Error("Number too big 0x"+t.toString(16))}if(t>=-32)return n.setInt8(i,t),1;if(t>=-128)return n.setUint8(i,208),n.setInt8(i+1,t),2;if(t>=-32768)return n.setUint8(i,209),n.setInt16(i+1,t),3;if(t>=-2147483648)return n.setUint8(i,210),n.setInt32(i+1,t),5;if(t>=-0x8000000000000000)return n.setUint8(i,211),l=i+1,(c=t)<0x7fffffffffffffff?(n.setInt32(l,Math.floor(23283064365386963e-26*c)),n.setInt32(l+4,-1&c)):(n.setUint32(l,2147483647),n.setUint32(l+4,2147483647)),9;throw Error("Number too small -0x"+(-t).toString(16).substr(1))}if("undefined"===o)return r?0:(n.setUint8(i,212),n.setUint8(i+1,0),n.setUint8(i+2,0),3);if(null===t)return r?0:(n.setUint8(i,192),1);if("boolean"===o)return n.setUint8(i,t?195:194),1;if("function"==typeof t.toJSON)return e(t.toJSON(),n,i,r);if("object"===o){let o,s,a=0,l=Array.isArray(t);if((s=l?t.length:(o=n1(t,r)).length)<16?(n.setUint8(i,s|(l?144:128)),a=1):s<65536?(n.setUint8(i,l?220:222),n.setUint16(i+1,s),a=3):s<4294967296&&(n.setUint8(i,l?221:223),n.setUint32(i+1,s),a=5),l)for(let o=0;o<s;o++)a+=e(t[o],n,i+a,r);else if(o)for(let l=0;l<s;l++){let s=o[l];a+=e(s,n,i+a),a+=e(t[s],n,i+a,r)}return a}if("function"===o)return 0;throw Error("Unknown type "+o)}(e,r,0,t),i},decode:function(e){let t=new DataView(e),n=new n0(t),i=n.parse();if(n.offset!==e.byteLength)throw Error(e.byteLength-n.offset+" trailing bytes");return i},inspect:function(e){let t,n;if(void 0===e)return"undefined";if(e instanceof ArrayBuffer?(n="ArrayBuffer",t=new DataView(e)):e instanceof DataView&&(n="DataView",t=e),!t)return JSON.stringify(e);let i=[];for(let n=0;n<e.byteLength;n++){if(n>20){i.push("...");break}let e=t.getUint8(n).toString(16);1===e.length&&(e="0"+e),i.push(e)}return"<"+n+" "+i.join(" ")+">"},utf8Write:nX,utf8Read:nQ,utf8ByteCount:nZ};async function n4(e,t,n,i,r,o){let s;let a=new Headers(i||{}),l=e?e.toUpperCase():U(o)?"GET":"POST",c=new AbortController,u=new Promise(e=>{s=setTimeout(()=>{c.abort(),e({error:new D("Request timed out",null,408)})},t?t.options.timeouts.httpRequestTimeout:eA.TIMEOUTS.httpRequestTimeout)}),d={method:l,headers:a,body:o,signal:c.signal};E.Config.isWebworker||(d.credentials=a.has("authorization")?"include":"same-origin");let h=(async()=>{try{let e;let t=await e_().fetch(n+"?"+new URLSearchParams(r||{}),d);if(clearTimeout(s),204==t.status)return{error:null,statusCode:t.status};let i=t.headers.get("Content-Type");e=i&&i.indexOf("application/x-msgpack")>-1?await t.arrayBuffer():i&&i.indexOf("application/json")>-1?await t.json():await t.text();let o=!!i&&-1===i.indexOf("application/x-msgpack"),a=function(e){let t={};return e.forEach((e,n)=>{t[n]=e}),t}(t.headers);if(t.ok)return{error:null,body:e,headers:a,unpacked:o,statusCode:t.status};{let n=function(e,t){if(t.get("x-ably-errorcode"))return e.error&&P.fromValues(e.error)}(e,t.headers)||new D("Error response received from server: "+t.status+" body was: "+E.Config.inspect(e),null,t.status);return{error:n,body:e,headers:a,unpacked:o,statusCode:t.status}}}catch(e){return clearTimeout(s),{error:e}}})();return Promise.race([u,h])}var n8=function(e,t){class n{constructor(e,t,n,i){this.algorithm=e,this.keyLength=t,this.mode=n,this.key=i}}class i{static getDefaultParams(e){if(!e.key)throw Error("Crypto.getDefaultParams: a key is required");i="string"==typeof e.key?t.toArrayBuffer(t.base64Decode(e.key.replace("_","/").replace("-","+"))):e.key instanceof ArrayBuffer?e.key:t.toArrayBuffer(e.key);var i,r=e.algorithm||"aes",o=8*i.byteLength,s=e.mode||"cbc",a=new n(r,o,s,i);if(e.keyLength&&e.keyLength!==a.keyLength)throw Error("Crypto.getDefaultParams: a keyLength of "+e.keyLength+" was specified, but the key actually has length "+a.keyLength);return function(e){if("aes"===e.algorithm&&"cbc"===e.mode&&128!==e.keyLength&&256!==e.keyLength)throw Error("Unsupported key length "+e.keyLength+" for aes-cbc encryption. Encryption key must be 128 or 256 bits (16 or 32 ASCII characters)")}(a),a}static async generateRandomKey(t){try{return e.getRandomArrayBuffer((t||256)/8)}catch(e){throw new P("Failed to generate random key: "+e.message,400,5e4,e)}}static getCipher(e,t){var i,o=e instanceof n?e:this.getDefaultParams(e);return{cipherParams:o,cipher:new r(o,null!=(i=e.iv)?i:null,t)}}}i.CipherParams=n;class r{constructor(e,n,i){if(this.logger=i,!crypto.subtle){if(isSecureContext)throw Error("Crypto operations are not possible since the browser’s SubtleCrypto class is unavailable (reason unknown).");throw Error("Crypto operations are is not possible since the current environment is a non-secure context and hence the browser’s SubtleCrypto class is not available.")}this.algorithm=e.algorithm+"-"+String(e.keyLength)+"-"+e.mode,this.webCryptoAlgorithm=e.algorithm+"-"+e.mode,this.key=t.toArrayBuffer(e.key),this.iv=n?t.toArrayBuffer(n):null}concat(e,n){let i=new ArrayBuffer(e.byteLength+n.byteLength),r=new DataView(i),o=new DataView(t.toArrayBuffer(e));for(let e=0;e<o.byteLength;e++)r.setInt8(e,o.getInt8(e));let s=new DataView(t.toArrayBuffer(n));for(let e=0;e<s.byteLength;e++)r.setInt8(o.byteLength+e,s.getInt8(e));return i}async encrypt(e){T.logAction(this.logger,T.LOG_MICRO,"CBCCipher.encrypt()","");let t=await this.getIv(),n=await crypto.subtle.importKey("raw",this.key,this.webCryptoAlgorithm,!1,["encrypt"]),i=await crypto.subtle.encrypt({name:this.webCryptoAlgorithm,iv:t},n,e);return this.concat(t,i)}async decrypt(e){T.logAction(this.logger,T.LOG_MICRO,"CBCCipher.decrypt()","");let n=t.toArrayBuffer(e),i=n.slice(0,16),r=n.slice(16),o=await crypto.subtle.importKey("raw",this.key,this.webCryptoAlgorithm,!1,["decrypt"]);return crypto.subtle.decrypt({name:this.webCryptoAlgorithm,iv:i},o,r)}async getIv(){if(this.iv){var n=this.iv;return this.iv=null,n}let i=await e.getRandomArrayBuffer(16);return t.toArrayBuffer(i)}}return i}(nU,nL);for(let e of(E.Crypto=n8,E.BufferUtils=nL,E.Http=nD,E.Config=nU,E.Transports={order:["xhr_polling"],bundledImplementations:{web_socket:np,xhr_polling:nK}},E.WebStorage=nH,[tD,ny]))e.Crypto=n8,e._MsgPack=n2;nD.bundledRequestImplementations={XHRRequest:nW,FetchRequest:n4},T.initLogHandlers(),E.Defaults=Object.assign(eA,n$),E.Config.agent&&(E.Defaults.agent+=" "+E.Config.agent);var n3={ErrorInfo:P,Rest:tD,Realtime:ny,msgpack:n2};return"object"==typeof d.exports&&(d.exports=((e,t,n,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of Object.getOwnPropertyNames(t))Object.prototype.hasOwnProperty.call(e,n)||void 0===n||Object.defineProperty(e,n,{get:()=>t[n],enumerable:!(i=Object.getOwnPropertyDescriptor(t,n))||i.enumerable});return e})(d.exports,u)),d.exports})()},99994:function(e,t,n){var i,r;e.exports=(i=n(28879),r={name:"ca",weekdays:"Diumenge_Dilluns_Dimarts_Dimecres_Dijous_Divendres_Dissabte".split("_"),weekdaysShort:"Dg._Dl._Dt._Dc._Dj._Dv._Ds.".split("_"),weekdaysMin:"Dg_Dl_Dt_Dc_Dj_Dv_Ds".split("_"),months:"Gener_Febrer_Mar\xe7_Abril_Maig_Juny_Juliol_Agost_Setembre_Octubre_Novembre_Desembre".split("_"),monthsShort:"Gen._Febr._Mar\xe7_Abr._Maig_Juny_Jul._Ag._Set._Oct._Nov._Des.".split("_"),weekStart:1,formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM [de] YYYY",LLL:"D MMMM [de] YYYY [a les] H:mm",LLLL:"dddd D MMMM [de] YYYY [a les] H:mm",ll:"D MMM YYYY",lll:"D MMM YYYY, H:mm",llll:"ddd D MMM YYYY, H:mm"},relativeTime:{future:"d'aqu\xed %s",past:"fa %s",s:"uns segons",m:"un minut",mm:"%d minuts",h:"una hora",hh:"%d hores",d:"un dia",dd:"%d dies",M:"un mes",MM:"%d mesos",y:"un any",yy:"%d anys"},ordinal:function(e){return""+e+(1===e||3===e?"r":2===e?"n":4===e?"t":"\xe8")}},(i&&"object"==typeof i&&"default"in i?i:{default:i}).default.locale(r,null,!0),r)},99654:function(e,t,n){var i,r;e.exports=(i=n(28879),r={name:"da",weekdays:"s\xf8ndag_mandag_tirsdag_onsdag_torsdag_fredag_l\xf8rdag".split("_"),weekdaysShort:"s\xf8n._man._tirs._ons._tors._fre._l\xf8r.".split("_"),weekdaysMin:"s\xf8._ma._ti._on._to._fr._l\xf8.".split("_"),months:"januar_februar_marts_april_maj_juni_juli_august_september_oktober_november_december".split("_"),monthsShort:"jan._feb._mar._apr._maj_juni_juli_aug._sept._okt._nov._dec.".split("_"),weekStart:1,yearStart:4,ordinal:function(e){return e+"."},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd [d.] D. MMMM YYYY [kl.] HH:mm"},relativeTime:{future:"om %s",past:"%s siden",s:"f\xe5 sekunder",m:"et minut",mm:"%d minutter",h:"en time",hh:"%d timer",d:"en dag",dd:"%d dage",M:"en m\xe5ned",MM:"%d m\xe5neder",y:"et \xe5r",yy:"%d \xe5r"}},(i&&"object"==typeof i&&"default"in i?i:{default:i}).default.locale(r,null,!0),r)},55411:function(e,t,n){e.exports=function(e){"use strict";var t={s:"ein paar Sekunden",m:["eine Minute","einer Minute"],mm:"%d Minuten",h:["eine Stunde","einer Stunde"],hh:"%d Stunden",d:["ein Tag","einem Tag"],dd:["%d Tage","%d Tagen"],M:["ein Monat","einem Monat"],MM:["%d Monate","%d Monaten"],y:["ein Jahr","einem Jahr"],yy:["%d Jahre","%d Jahren"]};function n(e,n,i){var r=t[i];return Array.isArray(r)&&(r=r[n?0:1]),r.replace("%d",e)}var i={name:"de",weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),months:"Januar_Februar_M\xe4rz_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Feb._M\xe4rz_Apr._Mai_Juni_Juli_Aug._Sept._Okt._Nov._Dez.".split("_"),ordinal:function(e){return e+"."},weekStart:1,yearStart:4,formats:{LTS:"HH:mm:ss",LT:"HH:mm",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd, D. MMMM YYYY HH:mm"},relativeTime:{future:"in %s",past:"vor %s",s:n,m:n,mm:n,h:n,hh:n,d:n,dd:n,M:n,MM:n,y:n,yy:n}};return(e&&"object"==typeof e&&"default"in e?e:{default:e}).default.locale(i,null,!0),i}(n(28879))},78844:function(e,t,n){var i,r;e.exports=(i=n(28879),r={name:"en-gb",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekStart:1,yearStart:4,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},ordinal:function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||"th")+"]"}},(i&&"object"==typeof i&&"default"in i?i:{default:i}).default.locale(r,null,!0),r)},16017:function(e){e.exports={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||"th")+"]"}}},79457:function(e,t,n){var i,r;e.exports=(i=n(28879),r={name:"es",monthsShort:"ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),weekdays:"domingo_lunes_martes_mi\xe9rcoles_jueves_viernes_s\xe1bado".split("_"),weekdaysShort:"dom._lun._mar._mi\xe9._jue._vie._s\xe1b.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_s\xe1".split("_"),months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),weekStart:1,formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un d\xeda",dd:"%d d\xedas",M:"un mes",MM:"%d meses",y:"un a\xf1o",yy:"%d a\xf1os"},ordinal:function(e){return e+"\xba"}},(i&&"object"==typeof i&&"default"in i?i:{default:i}).default.locale(r,null,!0),r)},16988:function(e,t,n){e.exports=function(e){"use strict";function t(e,t,n,i){var r=i&&!t?{s:"muutaman sekunnin",m:"minuutin",mm:"%d minuutin",h:"tunnin",hh:"%d tunnin",d:"p\xe4iv\xe4n",dd:"%d p\xe4iv\xe4n",M:"kuukauden",MM:"%d kuukauden",y:"vuoden",yy:"%d vuoden",numbers:"nollan_yhden_kahden_kolmen_nelj\xe4n_viiden_kuuden_seitsem\xe4n_kahdeksan_yhdeks\xe4n".split("_")}:{s:"muutama sekunti",m:"minuutti",mm:"%d minuuttia",h:"tunti",hh:"%d tuntia",d:"p\xe4iv\xe4",dd:"%d p\xe4iv\xe4\xe4",M:"kuukausi",MM:"%d kuukautta",y:"vuosi",yy:"%d vuotta",numbers:"nolla_yksi_kaksi_kolme_nelj\xe4_viisi_kuusi_seitsem\xe4n_kahdeksan_yhdeks\xe4n".split("_")},o=r[n];return e<10?o.replace("%d",r.numbers[e]):o.replace("%d",e)}var n={name:"fi",weekdays:"sunnuntai_maanantai_tiistai_keskiviikko_torstai_perjantai_lauantai".split("_"),weekdaysShort:"su_ma_ti_ke_to_pe_la".split("_"),weekdaysMin:"su_ma_ti_ke_to_pe_la".split("_"),months:"tammikuu_helmikuu_maaliskuu_huhtikuu_toukokuu_kes\xe4kuu_hein\xe4kuu_elokuu_syyskuu_lokakuu_marraskuu_joulukuu".split("_"),monthsShort:"tammi_helmi_maalis_huhti_touko_kes\xe4_hein\xe4_elo_syys_loka_marras_joulu".split("_"),ordinal:function(e){return e+"."},weekStart:1,yearStart:4,relativeTime:{future:"%s p\xe4\xe4st\xe4",past:"%s sitten",s:t,m:t,mm:t,h:t,hh:t,d:t,dd:t,M:t,MM:t,y:t,yy:t},formats:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD.MM.YYYY",LL:"D. MMMM[ta] YYYY",LLL:"D. MMMM[ta] YYYY, [klo] HH.mm",LLLL:"dddd, D. MMMM[ta] YYYY, [klo] HH.mm",l:"D.M.YYYY",ll:"D. MMM YYYY",lll:"D. MMM YYYY, [klo] HH.mm",llll:"ddd, D. MMM YYYY, [klo] HH.mm"}};return(e&&"object"==typeof e&&"default"in e?e:{default:e}).default.locale(n,null,!0),n}(n(28879))},21295:function(e,t,n){var i,r;e.exports=(i=n(28879),r={name:"fr",weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"di_lu_ma_me_je_ve_sa".split("_"),months:"janvier_f\xe9vrier_mars_avril_mai_juin_juillet_ao\xfbt_septembre_octobre_novembre_d\xe9cembre".split("_"),monthsShort:"janv._f\xe9vr._mars_avr._mai_juin_juil._ao\xfbt_sept._oct._nov._d\xe9c.".split("_"),weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},ordinal:function(e){return""+e+(1===e?"er":"")}},(i&&"object"==typeof i&&"default"in i?i:{default:i}).default.locale(r,null,!0),r)},11570:function(e,t,n){var i,r;e.exports=(i=n(28879),r={name:"it",weekdays:"domenica_luned\xec_marted\xec_mercoled\xec_gioved\xec_venerd\xec_sabato".split("_"),weekdaysShort:"dom_lun_mar_mer_gio_ven_sab".split("_"),weekdaysMin:"do_lu_ma_me_gi_ve_sa".split("_"),months:"gennaio_febbraio_marzo_aprile_maggio_giugno_luglio_agosto_settembre_ottobre_novembre_dicembre".split("_"),weekStart:1,monthsShort:"gen_feb_mar_apr_mag_giu_lug_ago_set_ott_nov_dic".split("_"),formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},relativeTime:{future:"tra %s",past:"%s fa",s:"qualche secondo",m:"un minuto",mm:"%d minuti",h:"un' ora",hh:"%d ore",d:"un giorno",dd:"%d giorni",M:"un mese",MM:"%d mesi",y:"un anno",yy:"%d anni"},ordinal:function(e){return e+"\xba"}},(i&&"object"==typeof i&&"default"in i?i:{default:i}).default.locale(r,null,!0),r)},12425:function(e,t,n){var i,r;e.exports=(i=n(28879),r={name:"nb",weekdays:"s\xf8ndag_mandag_tirsdag_onsdag_torsdag_fredag_l\xf8rdag".split("_"),weekdaysShort:"s\xf8._ma._ti._on._to._fr._l\xf8.".split("_"),weekdaysMin:"s\xf8_ma_ti_on_to_fr_l\xf8".split("_"),months:"januar_februar_mars_april_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan._feb._mars_april_mai_juni_juli_aug._sep._okt._nov._des.".split("_"),ordinal:function(e){return e+"."},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] HH:mm",LLLL:"dddd D. MMMM YYYY [kl.] HH:mm"},relativeTime:{future:"om %s",past:"%s siden",s:"noen sekunder",m:"ett minutt",mm:"%d minutter",h:"en time",hh:"%d timer",d:"en dag",dd:"%d dager",M:"en m\xe5ned",MM:"%d m\xe5neder",y:"ett \xe5r",yy:"%d \xe5r"}},(i&&"object"==typeof i&&"default"in i?i:{default:i}).default.locale(r,null,!0),r)},34859:function(e,t,n){var i,r;e.exports=(i=n(28879),r={name:"nl-be",weekdays:"zondag_maandag_dinsdag_woensdag_donderdag_vrijdag_zaterdag".split("_"),months:"januari_februari_maart_april_mei_juni_juli_augustus_september_oktober_november_december".split("_"),monthsShort:"jan._feb._mrt._apr._mei_jun._jul._aug._sep._okt._nov._dec.".split("_"),weekStart:1,weekdaysShort:"zo._ma._di._wo._do._vr._za.".split("_"),weekdaysMin:"zo_ma_di_wo_do_vr_za".split("_"),ordinal:function(e){return e},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},relativeTime:{future:"over %s",past:"%s geleden",s:"een paar seconden",m:"\xe9\xe9n minuut",mm:"%d minuten",h:"\xe9\xe9n uur",hh:"%d uur",d:"\xe9\xe9n dag",dd:"%d dagen",M:"\xe9\xe9n maand",MM:"%d maanden",y:"\xe9\xe9n jaar",yy:"%d jaar"}},(i&&"object"==typeof i&&"default"in i?i:{default:i}).default.locale(r,null,!0),r)},65958:function(e,t,n){var i,r;e.exports=(i=n(28879),r={name:"nl",weekdays:"zondag_maandag_dinsdag_woensdag_donderdag_vrijdag_zaterdag".split("_"),weekdaysShort:"zo._ma._di._wo._do._vr._za.".split("_"),weekdaysMin:"zo_ma_di_wo_do_vr_za".split("_"),months:"januari_februari_maart_april_mei_juni_juli_augustus_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mrt_apr_mei_jun_jul_aug_sep_okt_nov_dec".split("_"),ordinal:function(e){return"["+e+(1===e||8===e||e>=20?"ste":"de")+"]"},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},relativeTime:{future:"over %s",past:"%s geleden",s:"een paar seconden",m:"een minuut",mm:"%d minuten",h:"een uur",hh:"%d uur",d:"een dag",dd:"%d dagen",M:"een maand",MM:"%d maanden",y:"een jaar",yy:"%d jaar"}},(i&&"object"==typeof i&&"default"in i?i:{default:i}).default.locale(r,null,!0),r)},30114:function(e,t,n){var i,r;e.exports=(i=n(28879),r={name:"nn",weekdays:"sundag_m\xe5ndag_tysdag_onsdag_torsdag_fredag_laurdag".split("_"),weekdaysShort:"sun_m\xe5n_tys_ons_tor_fre_lau".split("_"),weekdaysMin:"su_m\xe5_ty_on_to_fr_la".split("_"),months:"januar_februar_mars_april_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan_feb_mar_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_"),ordinal:function(e){return e+"."},weekStart:1,relativeTime:{future:"om %s",past:"for %s sidan",s:"nokre sekund",m:"eitt minutt",mm:"%d minutt",h:"ein time",hh:"%d timar",d:"ein dag",dd:"%d dagar",M:"ein m\xe5nad",MM:"%d m\xe5nadar",y:"eitt \xe5r",yy:"%d \xe5r"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] H:mm",LLLL:"dddd D. MMMM YYYY [kl.] HH:mm"}},(i&&"object"==typeof i&&"default"in i?i:{default:i}).default.locale(r,null,!0),r)},78325:function(e,t,n){e.exports=function(e){"use strict";function t(e){return e%10<5&&e%10>1&&~~(e/10)%10!=1}function n(e,n,i){var r=e+" ";switch(i){case"m":return n?"minuta":"minutę";case"mm":return r+(t(e)?"minuty":"minut");case"h":return n?"godzina":"godzinę";case"hh":return r+(t(e)?"godziny":"godzin");case"MM":return r+(t(e)?"miesiące":"miesięcy");case"yy":return r+(t(e)?"lata":"lat")}}var i="stycznia_lutego_marca_kwietnia_maja_czerwca_lipca_sierpnia_września_października_listopada_grudnia".split("_"),r="styczeń_luty_marzec_kwiecień_maj_czerwiec_lipiec_sierpień_wrzesień_październik_listopad_grudzień".split("_"),o=/D MMMM/,s=function(e,t){return o.test(t)?i[e.month()]:r[e.month()]};s.s=r,s.f=i;var a={name:"pl",weekdays:"niedziela_poniedziałek_wtorek_środa_czwartek_piątek_sobota".split("_"),weekdaysShort:"ndz_pon_wt_śr_czw_pt_sob".split("_"),weekdaysMin:"Nd_Pn_Wt_Śr_Cz_Pt_So".split("_"),months:s,monthsShort:"sty_lut_mar_kwi_maj_cze_lip_sie_wrz_paź_lis_gru".split("_"),ordinal:function(e){return e+"."},weekStart:1,yearStart:4,relativeTime:{future:"za %s",past:"%s temu",s:"kilka sekund",m:n,mm:n,h:n,hh:n,d:"1 dzień",dd:"%d dni",M:"miesiąc",MM:n,y:"rok",yy:n},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"}};return(e&&"object"==typeof e&&"default"in e?e:{default:e}).default.locale(a,null,!0),a}(n(28879))},18034:function(e,t,n){var i,r;e.exports=(i=n(28879),r={name:"pt-br",weekdays:"domingo_segunda-feira_ter\xe7a-feira_quarta-feira_quinta-feira_sexta-feira_s\xe1bado".split("_"),weekdaysShort:"dom_seg_ter_qua_qui_sex_s\xe1b".split("_"),weekdaysMin:"Do_2\xaa_3\xaa_4\xaa_5\xaa_6\xaa_S\xe1".split("_"),months:"janeiro_fevereiro_mar\xe7o_abril_maio_junho_julho_agosto_setembro_outubro_novembro_dezembro".split("_"),monthsShort:"jan_fev_mar_abr_mai_jun_jul_ago_set_out_nov_dez".split("_"),ordinal:function(e){return e+"\xba"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY [\xe0s] HH:mm",LLLL:"dddd, D [de] MMMM [de] YYYY [\xe0s] HH:mm"},relativeTime:{future:"em %s",past:"h\xe1 %s",s:"poucos segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um m\xeas",MM:"%d meses",y:"um ano",yy:"%d anos"}},(i&&"object"==typeof i&&"default"in i?i:{default:i}).default.locale(r,null,!0),r)},83952:function(e,t,n){var i,r;e.exports=(i=n(28879),r={name:"pt",weekdays:"domingo_segunda-feira_ter\xe7a-feira_quarta-feira_quinta-feira_sexta-feira_s\xe1bado".split("_"),weekdaysShort:"dom_seg_ter_qua_qui_sex_sab".split("_"),weekdaysMin:"Do_2\xaa_3\xaa_4\xaa_5\xaa_6\xaa_Sa".split("_"),months:"janeiro_fevereiro_mar\xe7o_abril_maio_junho_julho_agosto_setembro_outubro_novembro_dezembro".split("_"),monthsShort:"jan_fev_mar_abr_mai_jun_jul_ago_set_out_nov_dez".split("_"),ordinal:function(e){return e+"\xba"},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY [\xe0s] HH:mm",LLLL:"dddd, D [de] MMMM [de] YYYY [\xe0s] HH:mm"},relativeTime:{future:"em %s",past:"h\xe1 %s",s:"alguns segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um m\xeas",MM:"%d meses",y:"um ano",yy:"%d anos"}},(i&&"object"==typeof i&&"default"in i?i:{default:i}).default.locale(r,null,!0),r)},92116:function(e,t,n){var i,r;e.exports=(i=n(28879),r={name:"sv",weekdays:"s\xf6ndag_m\xe5ndag_tisdag_onsdag_torsdag_fredag_l\xf6rdag".split("_"),weekdaysShort:"s\xf6n_m\xe5n_tis_ons_tor_fre_l\xf6r".split("_"),weekdaysMin:"s\xf6_m\xe5_ti_on_to_fr_l\xf6".split("_"),months:"januari_februari_mars_april_maj_juni_juli_augusti_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec".split("_"),weekStart:1,yearStart:4,ordinal:function(e){var t=e%10;return"["+e+(1===t||2===t?"a":"e")+"]"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [kl.] HH:mm",LLLL:"dddd D MMMM YYYY [kl.] HH:mm",lll:"D MMM YYYY HH:mm",llll:"ddd D MMM YYYY HH:mm"},relativeTime:{future:"om %s",past:"f\xf6r %s sedan",s:"n\xe5gra sekunder",m:"en minut",mm:"%d minuter",h:"en timme",hh:"%d timmar",d:"en dag",dd:"%d dagar",M:"en m\xe5nad",MM:"%d m\xe5nader",y:"ett \xe5r",yy:"%d \xe5r"}},(i&&"object"==typeof i&&"default"in i?i:{default:i}).default.locale(r,null,!0),r)},33147:function(e){var t;e.exports=(t={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},function(e,n,i){var r=n.prototype,o=r.format;i.en.formats=t,r.format=function(e){void 0===e&&(e="YYYY-MM-DDTHH:mm:ssZ");var n,i,r=this.$locale().formats,s=(n=e,i=void 0===r?{}:r,n.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(e,n,r){var o=r&&r.toUpperCase();return n||i[r]||t[r]||i[o].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(e,t,n){return t||n.slice(1)})}));return o.call(this,s)}})},24011:function(e){e.exports=function(e,t,n){e=e||{};var i=t.prototype,r={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function o(e,t,n,r){return i.fromToBase(e,t,n,r)}n.en.relativeTime=r,i.fromToBase=function(t,i,o,s,a){for(var l,c,u,d=o.$locale().relativeTime||r,h=e.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],g=h.length,f=0;f<g;f+=1){var p=h[f];p.d&&(l=s?n(t).diff(o,p.d,!0):o.diff(t,p.d,!0));var m=(e.rounding||Math.round)(Math.abs(l));if(u=l>0,m<=p.r||!p.r){m<=1&&f>0&&(p=h[f-1]);var b=d[p.l];a&&(m=a(""+m)),c="string"==typeof b?b.replace("%d",m):b(m,i,p.l,u);break}}if(i)return c;var y=u?d.future:d.past;return"function"==typeof y?y(c):y.replace("%s",c)},i.to=function(e,t){return o(e,t,this,!0)},i.from=function(e,t){return o(e,t,this)};var s=function(e){return e.$u?n.utc():n()};i.toNow=function(e){return this.to(s(this),e)},i.fromNow=function(e){return this.from(s(this),e)}}},93808:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var i=n(2784),r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},o=function(){return(o=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},s={Pixel:"Pixel",Percent:"Percent"},a={unit:s.Percent,value:.8};function l(e){return"number"==typeof e?{unit:s.Percent,value:100*e}:"string"==typeof e?e.match(/^(\d*(\.\d+)?)px$/)?{unit:s.Pixel,value:parseFloat(e)}:e.match(/^(\d*(\.\d+)?)%$/)?{unit:s.Percent,value:parseFloat(e)}:(console.warn('scrollThreshold format is invalid. Valid formats: "120px", "50%"...'),a):(console.warn("scrollThreshold should be string or number"),a)}var c=function(e){function t(t){var n=e.call(this,t)||this;return n.lastScrollTop=0,n.actionTriggered=!1,n.startY=0,n.currentY=0,n.dragging=!1,n.maxPullDownDistance=0,n.getScrollableTarget=function(){return n.props.scrollableTarget instanceof HTMLElement?n.props.scrollableTarget:"string"==typeof n.props.scrollableTarget?document.getElementById(n.props.scrollableTarget):(null===n.props.scrollableTarget&&console.warn("You are trying to pass scrollableTarget but it is null. This might\n        happen because the element may not have been added to DOM yet.\n        See https://github.com/ankeetmaini/react-infinite-scroll-component/issues/59 for more info.\n      "),null)},n.onStart=function(e){!n.lastScrollTop&&(n.dragging=!0,e instanceof MouseEvent?n.startY=e.pageY:e instanceof TouchEvent&&(n.startY=e.touches[0].pageY),n.currentY=n.startY,n._infScroll&&(n._infScroll.style.willChange="transform",n._infScroll.style.transition="transform 0.2s cubic-bezier(0,0,0.31,1)"))},n.onMove=function(e){n.dragging&&(e instanceof MouseEvent?n.currentY=e.pageY:e instanceof TouchEvent&&(n.currentY=e.touches[0].pageY),n.currentY<n.startY||(n.currentY-n.startY>=Number(n.props.pullDownToRefreshThreshold)&&n.setState({pullToRefreshThresholdBreached:!0}),n.currentY-n.startY>1.5*n.maxPullDownDistance||!n._infScroll||(n._infScroll.style.overflow="visible",n._infScroll.style.transform="translate3d(0px, "+(n.currentY-n.startY)+"px, 0px)")))},n.onEnd=function(){n.startY=0,n.currentY=0,n.dragging=!1,n.state.pullToRefreshThresholdBreached&&(n.props.refreshFunction&&n.props.refreshFunction(),n.setState({pullToRefreshThresholdBreached:!1})),requestAnimationFrame(function(){n._infScroll&&(n._infScroll.style.overflow="auto",n._infScroll.style.transform="none",n._infScroll.style.willChange="unset")})},n.onScrollListener=function(e){"function"==typeof n.props.onScroll&&setTimeout(function(){return n.props.onScroll&&n.props.onScroll(e)},0);var t=n.props.height||n._scrollableNode?e.target:document.documentElement.scrollTop?document.documentElement:document.body;n.actionTriggered||((n.props.inverse?n.isElementAtTop(t,n.props.scrollThreshold):n.isElementAtBottom(t,n.props.scrollThreshold))&&n.props.hasMore&&(n.actionTriggered=!0,n.setState({showLoader:!0}),n.props.next&&n.props.next()),n.lastScrollTop=t.scrollTop)},n.state={showLoader:!1,pullToRefreshThresholdBreached:!1,prevDataLength:t.dataLength},n.throttledOnScrollListener=(function(e,t,n,i){var r,o=!1,s=0;function a(){r&&clearTimeout(r)}function l(){var l=this,c=Date.now()-s,u=arguments;function d(){s=Date.now(),n.apply(l,u)}o||(i&&!r&&d(),a(),void 0===i&&c>e?d():!0!==t&&(r=setTimeout(i?function(){r=void 0}:d,void 0===i?e-c:e)))}return"boolean"!=typeof t&&(i=n,n=t,t=void 0),l.cancel=function(){a(),o=!0},l})(150,n.onScrollListener).bind(n),n.onStart=n.onStart.bind(n),n.onMove=n.onMove.bind(n),n.onEnd=n.onEnd.bind(n),n}return!function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t.prototype.componentDidMount=function(){if(void 0===this.props.dataLength)throw Error('mandatory prop "dataLength" is missing. The prop is needed when loading more content. Check README.md for usage');if(this._scrollableNode=this.getScrollableTarget(),this.el=this.props.height?this._infScroll:this._scrollableNode||window,this.el&&this.el.addEventListener("scroll",this.throttledOnScrollListener),"number"==typeof this.props.initialScrollY&&this.el&&this.el instanceof HTMLElement&&this.el.scrollHeight>this.props.initialScrollY&&this.el.scrollTo(0,this.props.initialScrollY),this.props.pullDownToRefresh&&this.el&&(this.el.addEventListener("touchstart",this.onStart),this.el.addEventListener("touchmove",this.onMove),this.el.addEventListener("touchend",this.onEnd),this.el.addEventListener("mousedown",this.onStart),this.el.addEventListener("mousemove",this.onMove),this.el.addEventListener("mouseup",this.onEnd),this.maxPullDownDistance=this._pullDown&&this._pullDown.firstChild&&this._pullDown.firstChild.getBoundingClientRect().height||0,this.forceUpdate(),"function"!=typeof this.props.refreshFunction))throw Error('Mandatory prop "refreshFunction" missing.\n          Pull Down To Refresh functionality will not work\n          as expected. Check README.md for usage\'')},t.prototype.componentWillUnmount=function(){this.el&&(this.el.removeEventListener("scroll",this.throttledOnScrollListener),this.props.pullDownToRefresh&&(this.el.removeEventListener("touchstart",this.onStart),this.el.removeEventListener("touchmove",this.onMove),this.el.removeEventListener("touchend",this.onEnd),this.el.removeEventListener("mousedown",this.onStart),this.el.removeEventListener("mousemove",this.onMove),this.el.removeEventListener("mouseup",this.onEnd)))},t.prototype.componentDidUpdate=function(e){this.props.dataLength!==e.dataLength&&(this.actionTriggered=!1,this.setState({showLoader:!1}))},t.getDerivedStateFromProps=function(e,t){return e.dataLength!==t.prevDataLength?o(o({},t),{prevDataLength:e.dataLength}):null},t.prototype.isElementAtTop=function(e,t){void 0===t&&(t=.8);var n=e===document.body||e===document.documentElement?window.screen.availHeight:e.clientHeight,i=l(t);return i.unit===s.Pixel?e.scrollTop<=i.value+n-e.scrollHeight+1:e.scrollTop<=i.value/100+n-e.scrollHeight+1},t.prototype.isElementAtBottom=function(e,t){void 0===t&&(t=.8);var n=e===document.body||e===document.documentElement?window.screen.availHeight:e.clientHeight,i=l(t);return i.unit===s.Pixel?e.scrollTop+n>=e.scrollHeight-i.value:e.scrollTop+n>=i.value/100*e.scrollHeight},t.prototype.render=function(){var e=this,t=o({height:this.props.height||"auto",overflow:"auto",WebkitOverflowScrolling:"touch"},this.props.style),n=this.props.hasChildren||!!(this.props.children&&this.props.children instanceof Array&&this.props.children.length),r=this.props.pullDownToRefresh&&this.props.height?{overflow:"auto"}:{};return i.createElement("div",{style:r,className:"infinite-scroll-component__outerdiv"},i.createElement("div",{className:"infinite-scroll-component "+(this.props.className||""),ref:function(t){return e._infScroll=t},style:t},this.props.pullDownToRefresh&&i.createElement("div",{style:{position:"relative"},ref:function(t){return e._pullDown=t}},i.createElement("div",{style:{position:"absolute",left:0,right:0,top:-1*this.maxPullDownDistance}},this.state.pullToRefreshThresholdBreached?this.props.releaseToRefreshContent:this.props.pullDownToRefreshContent)),this.props.children,!this.state.showLoader&&!n&&this.props.hasMore&&this.props.loader,this.state.showLoader&&this.props.hasMore&&this.props.loader,!this.props.hasMore&&this.props.endMessage))},t}(i.Component);let u=c},3358:(e,t,n)=>{"use strict";n.d(t,{Z:()=>f});var i,r,o=n(48595),s=n(2784),a=n(14657),l=n(77008),c={out:"out-in",in:"in-out"},u=function(e,t,n){return function(){var i;e.props[t]&&(i=e.props)[t].apply(i,arguments),n()}},d=((i={})[c.out]=function(e){var t=e.current,n=e.changeState;return s.cloneElement(t,{in:!1,onExited:u(t,"onExited",function(){n(a.d0,null)})})},i[c.in]=function(e){var t=e.current,n=e.changeState,i=e.children;return[t,s.cloneElement(i,{in:!0,onEntered:u(i,"onEntered",function(){n(a.d0)})})]},i),h=((r={})[c.out]=function(e){var t=e.children,n=e.changeState;return s.cloneElement(t,{in:!0,onEntered:u(t,"onEntered",function(){n(a.cn,s.cloneElement(t,{in:!0}))})})},r[c.in]=function(e){var t=e.current,n=e.children,i=e.changeState;return[s.cloneElement(t,{in:!1,onExited:u(t,"onExited",function(){i(a.cn,s.cloneElement(n,{in:!0}))})}),s.cloneElement(n,{in:!0})]},r),g=function(e){function t(){for(var t,n=arguments.length,i=Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).state={status:a.cn,current:null},t.appeared=!1,t.changeState=function(e,n){void 0===n&&(n=t.state.current),t.setState({status:e,current:n})},t}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.appeared=!0},t.getDerivedStateFromProps=function(e,t){var n,i;return null==e.children?{current:null}:t.status===a.d0&&e.mode===c.in?{status:a.d0}:t.current&&!((n=t.current)===(i=e.children)||s.isValidElement(n)&&s.isValidElement(i)&&null!=n.key&&n.key===i.key)?{status:a.Ix}:{current:s.cloneElement(e.children,{in:!0})}},n.render=function(){var e,t=this.props,n=t.children,i=t.mode,r=this.state,o=r.status,c=r.current,u={children:n,current:c,changeState:this.changeState,status:o};switch(o){case a.d0:e=h[i](u);break;case a.Ix:e=d[i](u);break;case a.cn:e=c}return s.createElement(l.Z.Provider,{value:{isMounting:!this.appeared}},e)},t}(s.Component);g.propTypes={},g.defaultProps={mode:c.out};let f=g},57609:(e,t,n)=>{"use strict";let i;n.d(t,{H:()=>tP});var r=n(52322),o=n(2784),s=n.t(o,2),a=n(28316);function l(e){return d(e)?(e.nodeName||"").toLowerCase():"#document"}function c(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function u(e){var t;return null==(t=(d(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function d(e){return e instanceof Node||e instanceof c(e).Node}function h(e){return e instanceof Element||e instanceof c(e).Element}function g(e){return e instanceof HTMLElement||e instanceof c(e).HTMLElement}function f(e){return!(typeof ShadowRoot>"u")&&(e instanceof ShadowRoot||e instanceof c(e).ShadowRoot)}function p(e){let{overflow:t,overflowX:n,overflowY:i,display:r}=w(e);return/auto|scroll|overlay|hidden|clip/.test(t+i+n)&&!["inline","contents"].includes(r)}function m(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function b(e){let t=y(),n=h(e)?w(e):e;return"none"!==n.transform||"none"!==n.perspective||!!n.containerType&&"normal"!==n.containerType||!t&&!!n.backdropFilter&&"none"!==n.backdropFilter||!t&&!!n.filter&&"none"!==n.filter||["transform","perspective","filter"].some(e=>(n.willChange||"").includes(e))||["paint","layout","strict","content"].some(e=>(n.contain||"").includes(e))}function y(){return!(typeof CSS>"u")&&!!CSS.supports&&CSS.supports("-webkit-backdrop-filter","none")}function v(e){return["html","body","#document"].includes(l(e))}function w(e){return c(e).getComputedStyle(e)}function _(e){return h(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function S(e){if("html"===l(e))return e;let t=e.assignedSlot||e.parentNode||f(e)&&e.host||u(e);return f(t)?t.host:t}function C(e,t,n){var i;void 0===t&&(t=[]),void 0===n&&(n=!0);let r=function e(t){let n=S(t);return v(n)?t.ownerDocument?t.ownerDocument.body:t.body:g(n)&&p(n)?n:e(n)}(e),o=r===(null==(i=e.ownerDocument)?void 0:i.body),s=c(r);if(o){let e=M(s);return t.concat(s,s.visualViewport||[],p(r)?r:[],e&&n?C(e):[])}return t.concat(r,C(r,[],n))}function M(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function R(e){let t=e.activeElement;for(;(null==(n=t)||null==(n=n.shadowRoot)?void 0:n.activeElement)!=null;){var n;t=t.shadowRoot.activeElement}return t}function E(e,t){if(!e||!t)return!1;let n=null==t.getRootNode?void 0:t.getRootNode();if(e.contains(t))return!0;if(n&&f(n)){let n=t;for(;n;){if(e===n)return!0;n=n.parentNode||n.host}}return!1}function O(){let e=navigator.userAgentData;return null!=e&&e.platform?e.platform:navigator.platform}function k(){let e=navigator.userAgentData;return e&&Array.isArray(e.brands)?e.brands.map(e=>{let{brand:t,version:n}=e;return t+"/"+n}).join(" "):navigator.userAgent}function x(){return/apple/i.test(navigator.vendor)}function A(){let e=/android/i;return e.test(O())||e.test(k())}function T(e,t){let n=["mouse","pen"];return t||n.push("",void 0),n.includes(e)}function L(e){return(null==e?void 0:e.ownerDocument)||document}function I(e,t){return null!=t&&("composedPath"in e?e.composedPath().includes(t):null!=e.target&&t.contains(e.target))}function P(e){return"composedPath"in e?e.composedPath()[0]:e.target}function D(e){return g(e)&&e.matches("input:not([type='hidden']):not([disabled]),[contenteditable]:not([contenteditable='false']),textarea:not([disabled])")}let N=Math.min,F=Math.max,H=Math.round,j=Math.floor,G=e=>({x:e,y:e}),U={left:"right",right:"left",bottom:"top",top:"bottom"},V={start:"end",end:"start"};function Y(e,t){return"function"==typeof e?e(t):e}function B(e){return e.split("-")[0]}function q(e){return e.split("-")[1]}function z(e){return"x"===e?"y":"x"}function W(e){return"y"===e?"height":"width"}function J(e){return["top","bottom"].includes(B(e))?"y":"x"}function K(e){return e.replace(/start|end/g,e=>V[e])}function $(e){return e.replace(/left|right|bottom|top/g,e=>U[e])}function X(e){return"number"!=typeof e?{top:0,right:0,bottom:0,left:0,...e}:{top:e,right:e,bottom:e,left:e}}function Q(e){let{x:t,y:n,width:i,height:r}=e;return{width:i,height:r,top:n,left:t,right:t+i,bottom:n+r,x:t,y:n}}/*!
* tabbable 6.2.0
* @license MIT, https://github.com/focus-trap/tabbable/blob/master/LICENSE
*/var Z='input:not([inert]),select:not([inert]),textarea:not([inert]),a[href]:not([inert]),button:not([inert]),[tabindex]:not(slot):not([inert]),audio[controls]:not([inert]),video[controls]:not([inert]),[contenteditable]:not([contenteditable="false"]):not([inert]),details>summary:first-of-type:not([inert]),details:not([inert])',ee=typeof Element>"u",et=ee?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,en=!ee&&Element.prototype.getRootNode?function(e){var t;return null==e||null===(t=e.getRootNode)||void 0===t?void 0:t.call(e)}:function(e){return null==e?void 0:e.ownerDocument},ei=function e(t,n){void 0===n&&(n=!0);var i,r=null==t||null===(i=t.getAttribute)||void 0===i?void 0:i.call(t,"inert");return""===r||"true"===r||n&&t&&e(t.parentNode)},er=function(e){var t,n=null==e||null===(t=e.getAttribute)||void 0===t?void 0:t.call(e,"contenteditable");return""===n||"true"===n},eo=function(e,t,n){if(ei(e))return[];var i=Array.prototype.slice.apply(e.querySelectorAll(Z));return t&&et.call(e,Z)&&i.unshift(e),i=i.filter(n)},es=function e(t,n,i){for(var r=[],o=Array.from(t);o.length;){var s=o.shift();if(!ei(s,!1)){if("SLOT"===s.tagName){var a=s.assignedElements(),l=e(a.length?a:s.children,!0,i);i.flatten?r.push.apply(r,l):r.push({scopeParent:s,candidates:l})}else{et.call(s,Z)&&i.filter(s)&&(n||!t.includes(s))&&r.push(s);var c=s.shadowRoot||"function"==typeof i.getShadowRoot&&i.getShadowRoot(s),u=!ei(c,!1)&&(!i.shadowRootFilter||i.shadowRootFilter(s));if(c&&u){var d=e(!0===c?s.children:c.children,!0,i);i.flatten?r.push.apply(r,d):r.push({scopeParent:s,candidates:d})}else o.unshift.apply(o,s.children)}}}return r},ea=function(e){return!isNaN(parseInt(e.getAttribute("tabindex"),10))},el=function(e){if(!e)throw Error("No node provided");return e.tabIndex<0&&(/^(AUDIO|VIDEO|DETAILS)$/.test(e.tagName)||er(e))&&!ea(e)?0:e.tabIndex},ec=function(e,t){var n=el(e);return n<0&&t&&!ea(e)?0:n},eu=function(e,t){return e.tabIndex===t.tabIndex?e.documentOrder-t.documentOrder:e.tabIndex-t.tabIndex},ed=function(e){return"INPUT"===e.tagName},eh=function(e,t){for(var n=0;n<e.length;n++)if(e[n].checked&&e[n].form===t)return e[n]},eg=function(e){if(!e.name)return!0;var t,n=e.form||en(e),i=function(e){return n.querySelectorAll('input[type="radio"][name="'+e+'"]')};if("u">typeof window&&"u">typeof window.CSS&&"function"==typeof window.CSS.escape)t=i(window.CSS.escape(e.name));else try{t=i(e.name)}catch(e){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",e.message),!1}var r=eh(t,e.form);return!r||r===e},ef=function(e){var t,n,i,r,o,s,a,l=e&&en(e),c=null===(a=l)||void 0===a?void 0:a.host,u=!1;if(l&&l!==e)for(u=!!(null!==(t=c)&&void 0!==t&&null!==(n=t.ownerDocument)&&void 0!==n&&n.contains(c)||null!=e&&null!==(i=e.ownerDocument)&&void 0!==i&&i.contains(e));!u&&c;)u=!!(null!==(o=c=null===(r=l=en(c))||void 0===r?void 0:r.host)&&void 0!==o&&null!==(s=o.ownerDocument)&&void 0!==s&&s.contains(c));return u},ep=function(e){var t=e.getBoundingClientRect(),n=t.width,i=t.height;return 0===n&&0===i},em=function(e,t){var n=t.displayCheck,i=t.getShadowRoot;if("hidden"===getComputedStyle(e).visibility)return!0;var r=et.call(e,"details>summary:first-of-type")?e.parentElement:e;if(et.call(r,"details:not([open]) *"))return!0;if(n&&"full"!==n&&"legacy-full"!==n){if("non-zero-area"===n)return ep(e)}else{if("function"==typeof i){for(var o=e;e;){var s=e.parentElement,a=en(e);if(s&&!s.shadowRoot&&!0===i(s))return ep(e);e=e.assignedSlot?e.assignedSlot:s||a===e.ownerDocument?s:a.host}e=o}if(ef(e))return!e.getClientRects().length;if("legacy-full"!==n)return!0}return!1},eb=function(e){if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(e.tagName))for(var t=e.parentElement;t;){if("FIELDSET"===t.tagName&&t.disabled){for(var n=0;n<t.children.length;n++){var i=t.children.item(n);if("LEGEND"===i.tagName)return!!et.call(t,"fieldset[disabled] *")||!i.contains(e)}return!0}t=t.parentElement}return!1},ey=function(e,t){var n,i,r;return!(ed(n=t)&&"radio"===n.type&&!eg(n)||0>el(t)||(i=e,(r=t).disabled||ei(r)||ed(r)&&"hidden"===r.type||em(r,i)||"DETAILS"===r.tagName&&Array.prototype.slice.apply(r.children).some(function(e){return"SUMMARY"===e.tagName})||eb(r)))},ev=function(e){var t=parseInt(e.getAttribute("tabindex"),10);return!!(isNaN(t)||t>=0)},ew=function e(t){var n=[],i=[];return t.forEach(function(t,r){var o=!!t.scopeParent,s=o?t.scopeParent:t,a=ec(s,o),l=o?e(t.candidates):s;0===a?o?n.push.apply(n,l):n.push(s):i.push({documentOrder:r,tabIndex:a,item:t,isScope:o,content:l})}),i.sort(eu).reduce(function(e,t){return t.isScope?e.push.apply(e,t.content):e.push(t.content),e},[]).concat(n)},e_=function(e,t){return ew((t=t||{}).getShadowRoot?es([e],t.includeContainer,{filter:ey.bind(null,t),flatten:!1,getShadowRoot:t.getShadowRoot,shadowRootFilter:ev}):eo(e,t.includeContainer,ey.bind(null,t)))};function eS(e,t,n){let i,{reference:r,floating:o}=e,s=J(t),a=z(J(t)),l=W(a),c=B(t),u="y"===s,d=r.x+r.width/2-o.width/2,h=r.y+r.height/2-o.height/2,g=r[l]/2-o[l]/2;switch(c){case"top":i={x:d,y:r.y-o.height};break;case"bottom":i={x:d,y:r.y+r.height};break;case"right":i={x:r.x+r.width,y:h};break;case"left":i={x:r.x-o.width,y:h};break;default:i={x:r.x,y:r.y}}switch(q(t)){case"start":i[a]-=g*(n&&u?-1:1);break;case"end":i[a]+=g*(n&&u?-1:1)}return i}let eC=async(e,t,n)=>{let{placement:i="bottom",strategy:r="absolute",middleware:o=[],platform:s}=n,a=o.filter(Boolean),l=await (null==s.isRTL?void 0:s.isRTL(t)),c=await s.getElementRects({reference:e,floating:t,strategy:r}),{x:u,y:d}=eS(c,i,l),h=i,g={},f=0;for(let n=0;n<a.length;n++){let{name:o,fn:p}=a[n],{x:m,y:b,data:y,reset:v}=await p({x:u,y:d,initialPlacement:i,placement:h,strategy:r,middlewareData:g,rects:c,platform:s,elements:{reference:e,floating:t}});u=m??u,d=b??d,g={...g,[o]:{...g[o],...y}},v&&f<=50&&(f++,"object"==typeof v&&(v.placement&&(h=v.placement),v.rects&&(c=!0===v.rects?await s.getElementRects({reference:e,floating:t,strategy:r}):v.rects),{x:u,y:d}=eS(c,h,l)),n=-1)}return{x:u,y:d,placement:h,strategy:r,middlewareData:g}};async function eM(e,t){var n;void 0===t&&(t={});let{x:i,y:r,platform:o,rects:s,elements:a,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:g=0}=Y(t,e),f=X(g),p=a[h?"floating"===d?"reference":"floating":d],m=Q(await o.getClippingRect({element:null==(n=await (null==o.isElement?void 0:o.isElement(p)))||n?p:p.contextElement||await (null==o.getDocumentElement?void 0:o.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),b="floating"===d?{x:i,y:r,width:s.floating.width,height:s.floating.height}:s.reference,y=await (null==o.getOffsetParent?void 0:o.getOffsetParent(a.floating)),v=await (null==o.isElement?void 0:o.isElement(y))&&await (null==o.getScale?void 0:o.getScale(y))||{x:1,y:1},w=Q(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:b,offsetParent:y,strategy:l}):b);return{top:(m.top-w.top+f.top)/v.y,bottom:(w.bottom-m.bottom+f.bottom)/v.y,left:(m.left-w.left+f.left)/v.x,right:(w.right-m.right+f.right)/v.x}}async function eR(e,t){let{placement:n,platform:i,elements:r}=e,o=await (null==i.isRTL?void 0:i.isRTL(r.floating)),s=B(n),a=q(n),l="y"===J(n),c=["left","top"].includes(s)?-1:1,u=o&&l?-1:1,d=Y(t,e),{mainAxis:h,crossAxis:g,alignmentAxis:f}="number"==typeof d?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return a&&"number"==typeof f&&(g="end"===a?-1*f:f),l?{x:g*u,y:h*c}:{x:h*c,y:g*u}}function eE(e){let t=w(e),n=parseFloat(t.width)||0,i=parseFloat(t.height)||0,r=g(e),o=r?e.offsetWidth:n,s=r?e.offsetHeight:i,a=H(n)!==o||H(i)!==s;return a&&(n=o,i=s),{width:n,height:i,$:a}}function eO(e){return h(e)?e:e.contextElement}function ek(e){let t=eO(e);if(!g(t))return G(1);let n=t.getBoundingClientRect(),{width:i,height:r,$:o}=eE(t),s=(o?H(n.width):n.width)/i,a=(o?H(n.height):n.height)/r;return s&&Number.isFinite(s)||(s=1),a&&Number.isFinite(a)||(a=1),{x:s,y:a}}let ex=G(0);function eA(e){let t=c(e);return y()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:ex}function eT(e,t,n,i){var r;void 0===t&&(t=!1),void 0===n&&(n=!1);let o=e.getBoundingClientRect(),s=eO(e),a=G(1);t&&(i?h(i)&&(a=ek(i)):a=ek(e));let l=(void 0===(r=n)&&(r=!1),i&&(!r||i===c(s))&&r)?eA(s):G(0),u=(o.left+l.x)/a.x,d=(o.top+l.y)/a.y,g=o.width/a.x,f=o.height/a.y;if(s){let e=c(s),t=i&&h(i)?c(i):i,n=e,r=M(n);for(;r&&i&&t!==n;){let e=ek(r),t=r.getBoundingClientRect(),i=w(r),o=t.left+(r.clientLeft+parseFloat(i.paddingLeft))*e.x,s=t.top+(r.clientTop+parseFloat(i.paddingTop))*e.y;u*=e.x,d*=e.y,g*=e.x,f*=e.y,u+=o,d+=s,r=M(n=c(r))}}return Q({width:g,height:f,x:u,y:d})}function eL(e){return eT(u(e)).left+_(e).scrollLeft}function eI(e,t,n){let i;if("viewport"===t)i=function(e,t){let n=c(e),i=u(e),r=n.visualViewport,o=i.clientWidth,s=i.clientHeight,a=0,l=0;if(r){o=r.width,s=r.height;let e=y();(!e||e&&"fixed"===t)&&(a=r.offsetLeft,l=r.offsetTop)}return{width:o,height:s,x:a,y:l}}(e,n);else if("document"===t)i=function(e){let t=u(e),n=_(e),i=e.ownerDocument.body,r=F(t.scrollWidth,t.clientWidth,i.scrollWidth,i.clientWidth),o=F(t.scrollHeight,t.clientHeight,i.scrollHeight,i.clientHeight),s=-n.scrollLeft+eL(e),a=-n.scrollTop;return"rtl"===w(i).direction&&(s+=F(t.clientWidth,i.clientWidth)-r),{width:r,height:o,x:s,y:a}}(u(e));else if(h(t))i=function(e,t){let n=eT(e,!0,"fixed"===t),i=n.top+e.clientTop,r=n.left+e.clientLeft,o=g(e)?ek(e):G(1),s=e.clientWidth*o.x,a=e.clientHeight*o.y,l=r*o.x,c=i*o.y;return{width:s,height:a,x:l,y:c}}(t,n);else{let n=eA(e);i={...t,x:t.x-n.x,y:t.y-n.y}}return Q(i)}function eP(e){return"static"===w(e).position}function eD(e,t){return g(e)&&"fixed"!==w(e).position?t?t(e):e.offsetParent:null}function eN(e,t){let n=c(e);if(m(e))return n;if(!g(e)){let t=S(e);for(;t&&!v(t);){if(h(t)&&!eP(t))return t;t=S(t)}return n}let i=eD(e,t);for(;i&&["table","td","th"].includes(l(i))&&eP(i);)i=eD(i,t);return i&&v(i)&&eP(i)&&!b(i)?n:i||function(e){let t=S(e);for(;g(t)&&!v(t);){if(b(t))return t;if(m(t))break;t=S(t)}return null}(e)||n}let eF=async function(e){let t=this.getOffsetParent||eN,n=this.getDimensions,i=await n(e.floating);return{reference:function(e,t,n){let i=g(t),r=u(t),o="fixed"===n,s=eT(e,!0,o,t),a={scrollLeft:0,scrollTop:0},c=G(0);if(i||!i&&!o){if(("body"!==l(t)||p(r))&&(a=_(t)),i){let e=eT(t,!0,o,t);c.x=e.x+t.clientLeft,c.y=e.y+t.clientTop}else r&&(c.x=eL(r))}let d=s.left+a.scrollLeft-c.x,h=s.top+a.scrollTop-c.y;return{x:d,y:h,width:s.width,height:s.height}}(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:i.width,height:i.height}}},eH={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{elements:t,rect:n,offsetParent:i,strategy:r}=e,o="fixed"===r,s=u(i),a=!!t&&m(t.floating);if(i===s||a&&o)return n;let c={scrollLeft:0,scrollTop:0},d=G(1),h=G(0),f=g(i);if((f||!f&&!o)&&(("body"!==l(i)||p(s))&&(c=_(i)),g(i))){let e=eT(i);d=ek(i),h.x=e.x+i.clientLeft,h.y=e.y+i.clientTop}return{width:n.width*d.x,height:n.height*d.y,x:n.x*d.x-c.scrollLeft*d.x+h.x,y:n.y*d.y-c.scrollTop*d.y+h.y}},getDocumentElement:u,getClippingRect:function(e){let{element:t,boundary:n,rootBoundary:i,strategy:r}=e,o=[..."clippingAncestors"===n?m(t)?[]:function(e,t){let n=t.get(e);if(n)return n;let i=C(e,[],!1).filter(e=>h(e)&&"body"!==l(e)),r=null,o="fixed"===w(e).position,s=o?S(e):e;for(;h(s)&&!v(s);){let t=w(s),n=b(s);n||"fixed"!==t.position||(r=null),(o?!n&&!r:!n&&"static"===t.position&&!!r&&["absolute","fixed"].includes(r.position)||p(s)&&!n&&function e(t,n){let i=S(t);return!(i===n||!h(i)||v(i))&&("fixed"===w(i).position||e(i,n))}(e,s))?i=i.filter(e=>e!==s):r=t,s=S(s)}return t.set(e,i),i}(t,this._c):[].concat(n),i],s=o[0],a=o.reduce((e,n)=>{let i=eI(t,n,r);return e.top=F(i.top,e.top),e.right=N(i.right,e.right),e.bottom=N(i.bottom,e.bottom),e.left=F(i.left,e.left),e},eI(t,s,r));return{width:a.right-a.left,height:a.bottom-a.top,x:a.left,y:a.top}},getOffsetParent:eN,getElementRects:eF,getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){let{width:t,height:n}=eE(e);return{width:t,height:n}},getScale:ek,isElement:h,isRTL:function(e){return"rtl"===w(e).direction}};function ej(e,t,n,i){void 0===i&&(i={});let{ancestorScroll:r=!0,ancestorResize:o=!0,elementResize:s="function"==typeof ResizeObserver,layoutShift:a="function"==typeof IntersectionObserver,animationFrame:l=!1}=i,c=eO(e),d=r||o?[...c?C(c):[],...C(t)]:[];d.forEach(e=>{r&&e.addEventListener("scroll",n,{passive:!0}),o&&e.addEventListener("resize",n)});let h=c&&a?function(e,t){let n=null,i,r=u(e);function o(){var e;clearTimeout(i),null==(e=n)||e.disconnect(),n=null}return function s(a,l){void 0===a&&(a=!1),void 0===l&&(l=1),o();let{left:c,top:u,width:d,height:h}=e.getBoundingClientRect();if(a||t(),!d||!h)return;let g=j(u),f=j(r.clientWidth-(c+d)),p=j(r.clientHeight-(u+h)),m=j(c),b={rootMargin:-g+"px "+-f+"px "+-p+"px "+-m+"px",threshold:F(0,N(1,l))||1},y=!0;function v(e){let t=e[0].intersectionRatio;if(t!==l){if(!y)return s();t?s(!1,t):i=setTimeout(()=>{s(!1,1e-7)},1e3)}y=!1}try{n=new IntersectionObserver(v,{...b,root:r.ownerDocument})}catch{n=new IntersectionObserver(v,b)}n.observe(e)}(!0),o}(c,n):null,g=-1,f=null;s&&(f=new ResizeObserver(e=>{let[i]=e;i&&i.target===c&&f&&(f.unobserve(t),cancelAnimationFrame(g),g=requestAnimationFrame(()=>{var e;null==(e=f)||e.observe(t)})),n()}),c&&!l&&f.observe(c),f.observe(t));let p,m=l?eT(e):null;return l&&function t(){let i=eT(e);m&&(i.x!==m.x||i.y!==m.y||i.width!==m.width||i.height!==m.height)&&n(),m=i,p=requestAnimationFrame(t)}(),n(),()=>{var e;d.forEach(e=>{r&&e.removeEventListener("scroll",n),o&&e.removeEventListener("resize",n)}),null==h||h(),null==(e=f)||e.disconnect(),f=null,l&&cancelAnimationFrame(p)}}let eG=e=>({name:"arrow",options:e,async fn(t){let{x:n,y:i,placement:r,rects:o,platform:s,elements:a,middlewareData:l}=t,{element:c,padding:u=0}=Y(e,t)||{};if(null==c)return{};let d=X(u),h={x:n,y:i},g=z(J(r)),f=W(g),p=await s.getDimensions(c),m="y"===g,b=m?"clientHeight":"clientWidth",y=o.reference[f]+o.reference[g]-h[g]-o.floating[f],v=h[g]-o.reference[g],w=await (null==s.getOffsetParent?void 0:s.getOffsetParent(c)),_=w?w[b]:0;_&&await (null==s.isElement?void 0:s.isElement(w))||(_=a.floating[b]||o.floating[f]);let S=_/2-p[f]/2-1,C=N(d[m?"top":"left"],S),M=N(d[m?"bottom":"right"],S),R=_-p[f]-M,E=_/2-p[f]/2+(y/2-v/2),O=F(C,N(E,R)),k=!l.arrow&&null!=q(r)&&E!==O&&o.reference[f]/2-(E<C?C:M)-p[f]/2<0,x=k?E<C?E-C:E-R:0;return{[g]:h[g]+x,data:{[g]:O,centerOffset:E-O-x,...k&&{alignmentOffset:x}},reset:k}}}),eU=(e,t,n)=>{let i=new Map,r={platform:eH,...n},o={...r.platform,_c:i};return eC(e,t,{...r,platform:o})};var eV="u">typeof document?o.useLayoutEffect:o.useEffect;function eY(e,t){let n,i,r;if(e===t)return!0;if(typeof e!=typeof t)return!1;if("function"==typeof e&&e.toString()===t.toString())return!0;if(e&&t&&"object"==typeof e){if(Array.isArray(e)){if((n=e.length)!==t.length)return!1;for(i=n;0!=i--;)if(!eY(e[i],t[i]))return!1;return!0}if((n=(r=Object.keys(e)).length)!==Object.keys(t).length)return!1;for(i=n;0!=i--;)if(!({}).hasOwnProperty.call(t,r[i]))return!1;for(i=n;0!=i--;){let n=r[i];if(!("_owner"===n&&e.$$typeof)&&!eY(e[n],t[n]))return!1}return!0}return e!=e&&t!=t}function eB(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function eq(e,t){let n=eB(e);return Math.round(t*n)/n}function ez(e){let t=o.useRef(e);return eV(()=>{t.current=e}),t}let eW=e=>({name:"arrow",options:e,fn(t){let{element:n,padding:i}="function"==typeof e?e(t):e;return n&&({}).hasOwnProperty.call(n,"current")?null!=n.current?eG({element:n.current,padding:i}).fn(t):{}:n?eG({element:n,padding:i}).fn(t):{}}}),eJ=(e,t)=>({...function(e){return void 0===e&&(e=0),{name:"offset",options:e,async fn(t){var n,i;let{x:r,y:o,placement:s,middlewareData:a}=t,l=await eR(t,e);return s===(null==(n=a.offset)?void 0:n.placement)&&null!=(i=a.arrow)&&i.alignmentOffset?{}:{x:r+l.x,y:o+l.y,data:{...l,placement:s}}}}}(e),options:[e,t]}),eK=(e,t)=>({...function(e){return void 0===e&&(e={}),{name:"shift",options:e,async fn(t){let{x:n,y:i,placement:r}=t,{mainAxis:o=!0,crossAxis:s=!1,limiter:a={fn:e=>{let{x:t,y:n}=e;return{x:t,y:n}}},...l}=Y(e,t),c={x:n,y:i},u=await eM(t,l),d=J(B(r)),h=z(d),g=c[h],f=c[d];if(o){let e=g+u["y"===h?"top":"left"],t=g-u["y"===h?"bottom":"right"];g=F(e,N(g,t))}if(s){let e="y"===d?"top":"left",t="y"===d?"bottom":"right",n=f+u[e],i=f-u[t];f=F(n,N(f,i))}let p=a.fn({...t,[h]:g,[d]:f});return{...p,data:{x:p.x-n,y:p.y-i}}}}}(e),options:[e,t]}),e$=(e,t)=>({...function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(t){var n,i,r,o,s;let{placement:a,middlewareData:l,rects:c,initialPlacement:u,platform:d,elements:h}=t,{mainAxis:g=!0,crossAxis:f=!0,fallbackPlacements:p,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:b="none",flipAlignment:y=!0,...v}=Y(e,t);if(null!=(n=l.arrow)&&n.alignmentOffset)return{};let w=B(a),_=J(u),S=B(u)===u,C=await (null==d.isRTL?void 0:d.isRTL(h.floating)),M=p||(S||!y?[$(u)]:function(e){let t=$(e);return[K(e),t,K(t)]}(u)),R="none"!==b;!p&&R&&M.push(...function(e,t,n,i){let r=q(e),o=function(e,t,n){let i=["left","right"],r=["right","left"];switch(e){case"top":case"bottom":return n?t?r:i:t?i:r;case"left":case"right":return t?["top","bottom"]:["bottom","top"];default:return[]}}(B(e),"start"===n,i);return r&&(o=o.map(e=>e+"-"+r),t&&(o=o.concat(o.map(K)))),o}(u,y,b,C));let E=[u,...M],O=await eM(t,v),k=[],x=(null==(i=l.flip)?void 0:i.overflows)||[];if(g&&k.push(O[w]),f){let e=function(e,t,n){void 0===n&&(n=!1);let i=q(e),r=z(J(e)),o=W(r),s="x"===r?i===(n?"end":"start")?"right":"left":"start"===i?"bottom":"top";return t.reference[o]>t.floating[o]&&(s=$(s)),[s,$(s)]}(a,c,C);k.push(O[e[0]],O[e[1]])}if(x=[...x,{placement:a,overflows:k}],!k.every(e=>e<=0)){let e=((null==(r=l.flip)?void 0:r.index)||0)+1,t=E[e];if(t)return{data:{index:e,overflows:x},reset:{placement:t}};let n=null==(o=x.filter(e=>e.overflows[0]<=0).sort((e,t)=>e.overflows[1]-t.overflows[1])[0])?void 0:o.placement;if(!n)switch(m){case"bestFit":{let e=null==(s=x.filter(e=>{if(R){let t=J(e.placement);return t===_||"y"===t}return!0}).map(e=>[e.placement,e.overflows.filter(e=>e>0).reduce((e,t)=>e+t,0)]).sort((e,t)=>e[1]-t[1])[0])?void 0:s[0];e&&(n=e);break}case"initialPlacement":n=u}if(a!==n)return{reset:{placement:n}}}return{}}}}(e),options:[e,t]}),eX=(e,t)=>({...eW(e),options:[e,t]}),eQ={...s},eZ=eQ.useInsertionEffect,e0=eZ||(e=>e());function e1(e){let t=o.useRef(()=>{});return e0(()=>{t.current=e}),o.useCallback(function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];return null==t.current?void 0:t.current(...n)},[])}var e2="u">typeof document?o.useLayoutEffect:o.useEffect;function e4(){return(e4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}let e8=!1,e3=0,e6=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+e3++,e5=eQ.useId,e9=e5||function(){let[e,t]=o.useState(()=>e8?e6():void 0);return e2(()=>{null==e&&t(e6())},[]),o.useEffect(()=>{e8=!0},[]),e},e7=o.forwardRef(function(e,t){let{context:{placement:n,elements:{floating:i},middlewareData:{arrow:r,shift:s}},width:a=14,height:l=7,tipRadius:c=0,strokeWidth:u=0,staticOffset:d,stroke:h,d:g,style:{transform:f,...p}={},...m}=e,b=e9(),[y,v]=o.useState(!1);if(e2(()=>{i&&"rtl"===w(i).direction&&v(!0)},[i]),!i)return null;let[_,S]=n.split("-"),C="top"===_||"bottom"===_,M=d;(C&&null!=s&&s.x||!C&&null!=s&&s.y)&&(M=null);let R=2*u,E=R/2,O=a/2*(-(c/8)+1),k=l/2*c/4,x=!!g,A=M&&"end"===S?"bottom":"top",T=M&&"end"===S?"right":"left";M&&y&&(T="end"===S?"left":"right");let L=(null==r?void 0:r.x)!=null?M||r.x:"",I=(null==r?void 0:r.y)!=null?M||r.y:"",P=g||"M0,0 H"+a+" L"+(a-O)+","+(l-k)+(" Q"+a/2+","+l+" ")+O+","+(l-k)+" Z";return o.createElement("svg",e4({},m,{"aria-hidden":!0,ref:t,width:x?a:a+R,height:a,viewBox:"0 0 "+a+" "+(l>a?l:a),style:{position:"absolute",pointerEvents:"none",[T]:L,[A]:I,[_]:C||x?"100%":"calc(100% - "+R/2+"px)",transform:""+({top:x?"rotate(180deg)":"",left:x?"rotate(90deg)":"rotate(-90deg)",bottom:x?"":"rotate(180deg)",right:x?"rotate(-90deg)":"rotate(90deg)"})[_]+(f??""),...p}}),R>0&&o.createElement("path",{clipPath:"url(#"+b+")",fill:"none",stroke:h,strokeWidth:R+(g?0:1),d:P}),o.createElement("path",{stroke:R&&!g?m.fill:"none",d:P}),o.createElement("clipPath",{id:b},o.createElement("rect",{x:-E,y:E*(x?-1:1),width:a+R,height:a})))}),te=o.createContext(null),tt=o.createContext(null),tn=()=>{var e;return(null==(e=o.useContext(te))?void 0:e.id)||null},ti=()=>o.useContext(tt);function tr(e){return"data-floating-ui-"+e}function to(e){let t=(0,o.useRef)(e);return e2(()=>{t.current=e}),t}let ts=tr("safe-polygon");function ta(e,t,n){return n&&!T(n)?0:"number"==typeof e?e:null==e?void 0:e[t]}function tl(e,t){let n=e.filter(e=>{var n;return e.parentId===t&&(null==(n=e.context)?void 0:n.open)}),i=n;for(;i.length;)i=e.filter(e=>{var t;return null==(t=i)?void 0:t.some(t=>{var n;return e.parentId===t.id&&(null==(n=e.context)?void 0:n.open)})}),n=n.concat(i);return n}let tc=e=>e&&(e.host||tc(e.parentNode)),tu=()=>({getShadowRoot:!0,displayCheck:"function"==typeof ResizeObserver&&ResizeObserver.toString().includes("[native code]")?"full":"none"});function td(e,t){let n=e_(e,tu());"prev"===t&&n.reverse();let i=n.indexOf(R(L(e)));return n.slice(i+1)[0]}function th(e,t){let n=t||e.currentTarget,i=e.relatedTarget;return!i||!E(n,i)}function tg(e){e.querySelectorAll("[data-tabindex]").forEach(e=>{let t=e.dataset.tabindex;delete e.dataset.tabindex,t?e.setAttribute("tabindex",t):e.removeAttribute("tabindex")})}let tf={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"fixed",whiteSpace:"nowrap",width:"1px",top:0,left:0};function tp(e){"Tab"===e.key&&(e.target,clearTimeout(i))}let tm=o.forwardRef(function(e,t){let[n,i]=o.useState();e2(()=>(x()&&i("button"),document.addEventListener("keydown",tp),()=>{document.removeEventListener("keydown",tp)}),[]);let r={ref:t,tabIndex:0,role:n,"aria-hidden":!n||void 0,[tr("focus-guard")]:"",style:tf};return o.createElement("span",e4({},e,r))}),tb=o.createContext(null),ty=tr("portal");function tv(e){let{children:t,id:n,root:i=null,preserveTabOrder:r=!0}=e,s=function(e){void 0===e&&(e={});let{id:t,root:n}=e,i=e9(),r=tw(),[s,a]=o.useState(null),l=o.useRef(null);return e2(()=>()=>{null==s||s.remove(),queueMicrotask(()=>{l.current=null})},[s]),e2(()=>{if(!i||l.current)return;let e=t?document.getElementById(t):null;if(!e)return;let n=document.createElement("div");n.id=i,n.setAttribute(ty,""),e.appendChild(n),l.current=n,a(n)},[t,i]),e2(()=>{if(!i||l.current)return;let e=n||(null==r?void 0:r.portalNode);e&&!h(e)&&(e=e.current),e=e||document.body;let o=null;t&&((o=document.createElement("div")).id=t,e.appendChild(o));let s=document.createElement("div");s.id=i,s.setAttribute(ty,""),(e=o||e).appendChild(s),l.current=s,a(s)},[t,n,i,r]),s}({id:n,root:i}),[l,c]=o.useState(null),u=o.useRef(null),d=o.useRef(null),g=o.useRef(null),f=o.useRef(null),p=null==l?void 0:l.modal,m=null==l?void 0:l.open,b=!!l&&!l.modal&&l.open&&r&&!!(i||s);return o.useEffect(()=>{if(s&&r&&!p)return s.addEventListener("focusin",e,!0),s.addEventListener("focusout",e,!0),()=>{s.removeEventListener("focusin",e,!0),s.removeEventListener("focusout",e,!0)};function e(e){s&&th(e)&&("focusin"===e.type?tg:function(e){e_(e,tu()).forEach(e=>{e.dataset.tabindex=e.getAttribute("tabindex")||"",e.setAttribute("tabindex","-1")})})(s)}},[s,r,p]),o.useEffect(()=>{s&&(m||tg(s))},[m,s]),o.createElement(tb.Provider,{value:o.useMemo(()=>({preserveTabOrder:r,beforeOutsideRef:u,afterOutsideRef:d,beforeInsideRef:g,afterInsideRef:f,portalNode:s,setFocusManagerState:c}),[r,s])},b&&s&&o.createElement(tm,{"data-type":"outside",ref:u,onFocus:e=>{if(th(e,s)){var t;null==(t=g.current)||t.focus()}else{let e=td(document.body,"prev")||(null==l?void 0:l.refs.domReference.current);null==e||e.focus()}}}),b&&s&&o.createElement("span",{"aria-owns":s.id,style:tf}),s&&a.createPortal(t,s),b&&s&&o.createElement(tm,{"data-type":"outside",ref:d,onFocus:e=>{if(th(e,s)){var t;null==(t=f.current)||t.focus()}else{let t=td(document.body,"next")||(null==l?void 0:l.refs.domReference.current);null==t||t.focus(),null!=l&&l.closeOnFocusOut&&(null==l||l.onOpenChange(!1,e.nativeEvent,"focus-out"))}}}))}let tw=()=>o.useContext(tb);function t_(e){return g(e.target)&&"BUTTON"===e.target.tagName}let tS={pointerdown:"onPointerDown",mousedown:"onMouseDown",click:"onClick"},tC={pointerdown:"onPointerDownCapture",mousedown:"onMouseDownCapture",click:"onClickCapture"},tM=e=>{var t,n;return{escapeKey:"boolean"==typeof e?e:null!=(t=null==e?void 0:e.escapeKey)&&t,outsidePress:"boolean"==typeof e?e:null==(n=null==e?void 0:e.outsidePress)||n}},tR="active",tE="selected";function tO(e,t,n){let i=new Map,r="item"===n,o=e;if(r&&e){let{[tR]:t,[tE]:n,...i}=e;o=i}return{..."floating"===n&&{tabIndex:-1,"data-floating-ui-focusable":""},...o,...t.map(t=>{let i=t?t[n]:null;return"function"==typeof i?e?i(e):null:i}).concat(e).reduce((e,t)=>(t&&Object.entries(t).forEach(t=>{let[n,o]=t;if(!(r&&[tR,tE].includes(n))){if(0===n.indexOf("on")){if(i.has(n)||i.set(n,[]),"function"==typeof o){var s;null==(s=i.get(n))||s.push(o),e[n]=function(){for(var e,t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];return null==(e=i.get(n))?void 0:e.map(e=>e(...r)).find(e=>void 0!==e)}}}else e[n]=o}}),e),{})}}let tk=new Map([["select","listbox"],["combobox","listbox"],["label",!1]]),tx=e=>e.replace(/[A-Z]+(?![a-z])|[A-Z]/g,(e,t)=>(t?"-":"")+e.toLowerCase());function tA(e,t){return"function"==typeof e?e(t):e}var tT=n(26014);let tL={hidden:"_hidden_1iggh_1"},tI={primary:"_primary_145lr_1",arrow:"_arrow_145lr_5",white:"_white_145lr_9"},tP=({className:e,color:t="primary",content:n,disabled:i=!1,placement:s="top",renderOpener:l,triggerType:u="hover",width:d})=>{let[f,p]=(0,o.useState)(!1),m=(0,o.useRef)(null),{context:b,floatingStyles:y,refs:{setFloating:_,setReference:M}}=function(e){void 0===e&&(e={});let{nodeId:t}=e,n=function(e){let{open:t=!1,onOpenChange:n,elements:i}=e,r=e9(),s=o.useRef({}),[a]=o.useState(()=>(function(){let e=new Map;return{emit(t,n){var i;null==(i=e.get(t))||i.forEach(e=>e(n))},on(t,n){e.set(t,[...e.get(t)||[],n])},off(t,n){var i;e.set(t,(null==(i=e.get(t))?void 0:i.filter(e=>e!==n))||[])}}})()),l=null!=tn(),[c,u]=o.useState(i.reference),d=e1((e,t,i)=>{s.current.openEvent=e?t:void 0,a.emit("openchange",{open:e,event:t,reason:i,nested:l}),null==n||n(e,t,i)}),h=o.useMemo(()=>({setPositionReference:u}),[]),g=o.useMemo(()=>({reference:c||i.reference||null,floating:i.floating||null,domReference:i.reference}),[c,i.reference,i.floating]);return o.useMemo(()=>({dataRef:s,open:t,onOpenChange:d,elements:g,events:a,floatingId:r,refs:h}),[t,d,g,a,r,h])}({...e,elements:{reference:null,floating:null,...e.elements}}),i=e.rootContext||n,r=i.elements,[s,l]=o.useState(null),[c,u]=o.useState(null),d=(null==r?void 0:r.reference)||s,g=o.useRef(null),f=ti();e2(()=>{d&&(g.current=d)},[d]);let p=function(e){void 0===e&&(e={});let{placement:t="bottom",strategy:n="absolute",middleware:i=[],platform:r,elements:{reference:s,floating:l}={},transform:c=!0,whileElementsMounted:u,open:d}=e,[h,g]=o.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[f,p]=o.useState(i);eY(f,i)||p(i);let[m,b]=o.useState(null),[y,v]=o.useState(null),w=o.useCallback(e=>{e!==M.current&&(M.current=e,b(e))},[]),_=o.useCallback(e=>{e!==R.current&&(R.current=e,v(e))},[]),S=s||m,C=l||y,M=o.useRef(null),R=o.useRef(null),E=o.useRef(h),O=null!=u,k=ez(u),x=ez(r),A=o.useCallback(()=>{if(!M.current||!R.current)return;let e={placement:t,strategy:n,middleware:f};x.current&&(e.platform=x.current),eU(M.current,R.current,e).then(e=>{let t={...e,isPositioned:!0};T.current&&!eY(E.current,t)&&(E.current=t,a.flushSync(()=>{g(t)}))})},[f,t,n,x]);eV(()=>{!1===d&&E.current.isPositioned&&(E.current.isPositioned=!1,g(e=>({...e,isPositioned:!1})))},[d]);let T=o.useRef(!1);eV(()=>(T.current=!0,()=>{T.current=!1}),[]),eV(()=>{if(S&&(M.current=S),C&&(R.current=C),S&&C){if(k.current)return k.current(S,C,A);A()}},[S,C,A,k,O]);let L=o.useMemo(()=>({reference:M,floating:R,setReference:w,setFloating:_}),[w,_]),I=o.useMemo(()=>({reference:S,floating:C}),[S,C]),P=o.useMemo(()=>{let e={position:n,left:0,top:0};if(!I.floating)return e;let t=eq(I.floating,h.x),i=eq(I.floating,h.y);return c?{...e,transform:"translate("+t+"px, "+i+"px)",...eB(I.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:t,top:i}},[n,c,I.floating,h.x,h.y]);return o.useMemo(()=>({...h,update:A,refs:L,elements:I,floatingStyles:P}),[h,A,L,I,P])}({...e,elements:{...r,...c&&{reference:c}}}),m=o.useCallback(e=>{let t=h(e)?{getBoundingClientRect:()=>e.getBoundingClientRect(),contextElement:e}:e;u(t),p.refs.setReference(t)},[p.refs]),b=o.useCallback(e=>{(h(e)||null===e)&&(g.current=e,l(e)),(h(p.refs.reference.current)||null===p.refs.reference.current||null!==e&&!h(e))&&p.refs.setReference(e)},[p.refs]),y=o.useMemo(()=>({...p.refs,setReference:b,setPositionReference:m,domReference:g}),[p.refs,b,m]),v=o.useMemo(()=>({...p.elements,domReference:d}),[p.elements,d]),w=o.useMemo(()=>({...p,...i,refs:y,elements:v,nodeId:t}),[p,y,v,t,i]);return e2(()=>{i.dataRef.current.floatingContext=w;let e=null==f?void 0:f.nodesRef.current.find(e=>e.id===t);e&&(e.context=w)}),o.useMemo(()=>({...p,context:w,refs:y,elements:v}),[p,y,v,w])}({middleware:[eJ(12),e$({fallbackPlacements:["top","bottom"],fallbackStrategy:"bestFit",flipAlignment:!1}),eK({padding:8}),eX({element:m,padding:40})],onOpenChange:p,open:f,placement:s,whileElementsMounted:ej}),N=function(e,t){void 0===t&&(t={});let{open:n,onOpenChange:i,dataRef:r,events:s,elements:a}=e,{enabled:l=!0,delay:c=0,handleClose:u=null,mouseOnly:d=!1,restMs:g=0,move:f=!0}=t,p=ti(),m=tn(),b=to(u),y=to(c),v=to(n),w=o.useRef(),_=o.useRef(-1),S=o.useRef(),C=o.useRef(-1),M=o.useRef(!0),R=o.useRef(!1),O=o.useRef(()=>{}),k=o.useCallback(()=>{var e;let t=null==(e=r.current.openEvent)?void 0:e.type;return(null==t?void 0:t.includes("mouse"))&&"mousedown"!==t},[r]);o.useEffect(()=>{if(l)return s.on("openchange",e),()=>{s.off("openchange",e)};function e(e){let{open:t}=e;t||(clearTimeout(_.current),clearTimeout(C.current),M.current=!0)}},[l,s]),o.useEffect(()=>{if(!l||!b.current||!n)return;function e(e){k()&&i(!1,e,"hover")}let t=L(a.floating).documentElement;return t.addEventListener("mouseleave",e),()=>{t.removeEventListener("mouseleave",e)}},[a.floating,n,i,l,b,k]);let x=o.useCallback(function(e,t,n){void 0===t&&(t=!0),void 0===n&&(n="hover");let r=ta(y.current,"close",w.current);r&&!S.current?(clearTimeout(_.current),_.current=window.setTimeout(()=>i(!1,e,n),r)):t&&(clearTimeout(_.current),i(!1,e,n))},[y,i]),A=e1(()=>{O.current(),S.current=void 0}),I=e1(()=>{if(R.current){let e=L(a.floating).body;e.style.pointerEvents="",e.removeAttribute(ts),R.current=!1}});o.useEffect(()=>{if(l&&h(a.domReference)){var e;let t=a.domReference;return n&&t.addEventListener("mouseleave",c),null==(e=a.floating)||e.addEventListener("mouseleave",c),f&&t.addEventListener("mousemove",o,{once:!0}),t.addEventListener("mouseenter",o),t.addEventListener("mouseleave",s),()=>{var e;n&&t.removeEventListener("mouseleave",c),null==(e=a.floating)||e.removeEventListener("mouseleave",c),f&&t.removeEventListener("mousemove",o),t.removeEventListener("mouseenter",o),t.removeEventListener("mouseleave",s)}}function t(){return!!r.current.openEvent&&["click","mousedown"].includes(r.current.openEvent.type)}function o(e){if(clearTimeout(_.current),M.current=!1,d&&!T(w.current)||g>0&&!ta(y.current,"open"))return;let t=ta(y.current,"open",w.current);t?_.current=window.setTimeout(()=>{v.current||i(!0,e,"hover")},t):i(!0,e,"hover")}function s(e){if(t())return;O.current();let i=L(a.floating);if(clearTimeout(C.current),b.current&&r.current.floatingContext){n||clearTimeout(_.current),S.current=b.current({...r.current.floatingContext,tree:p,x:e.clientX,y:e.clientY,onClose(){I(),A(),x(e,!0,"safe-polygon")}});let t=S.current;i.addEventListener("mousemove",t),O.current=()=>{i.removeEventListener("mousemove",t)};return}"touch"===w.current&&E(a.floating,e.relatedTarget)||x(e)}function c(e){t()||r.current.floatingContext&&(null==b.current||b.current({...r.current.floatingContext,tree:p,x:e.clientX,y:e.clientY,onClose(){I(),A(),x(e)}})(e))}},[a,l,e,d,g,f,x,A,I,i,n,v,p,y,b,r]),e2(()=>{var e,t;if(l&&n&&null!=(e=b.current)&&e.__options.blockPointerEvents&&k()){R.current=!0;let e=a.floating;if(h(a.domReference)&&e){let n=L(a.floating).body;n.setAttribute(ts,"");let i=a.domReference,r=null==p||null==(t=p.nodesRef.current.find(e=>e.id===m))||null==(t=t.context)?void 0:t.elements.floating;return r&&(r.style.pointerEvents=""),n.style.pointerEvents="none",i.style.pointerEvents="auto",e.style.pointerEvents="auto",()=>{n.style.pointerEvents="",i.style.pointerEvents="",e.style.pointerEvents=""}}}},[l,n,m,a,p,b,k]),e2(()=>{n||(w.current=void 0,A(),I())},[n,A,I]),o.useEffect(()=>()=>{A(),clearTimeout(_.current),clearTimeout(C.current),I()},[l,a.domReference,A,I]);let P=o.useMemo(()=>{function e(e){w.current=e.pointerType}return{onPointerDown:e,onPointerEnter:e,onMouseMove(e){let{nativeEvent:t}=e;function r(){M.current||v.current||i(!0,t,"hover")}d&&!T(w.current)||n||0===g||(clearTimeout(C.current),"touch"===w.current?r():C.current=window.setTimeout(r,g))}}},[d,i,n,v,g]),D=o.useMemo(()=>({onMouseEnter(){clearTimeout(_.current)},onMouseLeave(e){x(e.nativeEvent,!1)}}),[x]);return o.useMemo(()=>l?{reference:P,floating:D}:{},[l,P,D])}(b,{delay:{close:250,open:50},enabled:"hover"===u,move:!1}),F=function(e,t){void 0===t&&(t={});let{open:n,onOpenChange:i,dataRef:r,elements:{domReference:s}}=e,{enabled:a=!0,event:l="click",toggle:c=!0,ignoreMouse:u=!1,keyboardHandlers:d=!0}=t,h=o.useRef(),g=o.useRef(!1),f=o.useMemo(()=>({onPointerDown(e){h.current=e.pointerType},onMouseDown(e){let t=h.current;0===e.button&&"click"!==l&&(T(t,!0)&&u||(n&&c&&(!r.current.openEvent||"mousedown"===r.current.openEvent.type)?i(!1,e.nativeEvent,"click"):(e.preventDefault(),i(!0,e.nativeEvent,"click"))))},onClick(e){let t=h.current;if("mousedown"===l&&h.current){h.current=void 0;return}T(t,!0)&&u||(n&&c&&(!r.current.openEvent||"click"===r.current.openEvent.type)?i(!1,e.nativeEvent,"click"):i(!0,e.nativeEvent,"click"))},onKeyDown(e){h.current=void 0,e.defaultPrevented||!d||t_(e)||(" "!==e.key||D(s)||(e.preventDefault(),g.current=!0),"Enter"===e.key&&i(!(n&&c),e.nativeEvent,"click"))},onKeyUp(e){e.defaultPrevented||!d||t_(e)||D(s)||" "===e.key&&g.current&&(g.current=!1,i(!(n&&c),e.nativeEvent,"click"))}}),[r,s,l,u,d,i,n,c]);return o.useMemo(()=>a?{reference:f}:{},[a,f])}(b,{enabled:"click"===u}),H=function(e,t){void 0===t&&(t={});let{open:n,onOpenChange:i,events:r,dataRef:s,elements:a}=e,{enabled:l=!0,visibleOnly:u=!0}=t,d=o.useRef(!1),f=o.useRef(),p=o.useRef(!0);o.useEffect(()=>{if(!l)return;let e=c(a.domReference);function t(){!n&&g(a.domReference)&&a.domReference===R(L(a.domReference))&&(d.current=!0)}function i(){p.current=!0}return e.addEventListener("blur",t),e.addEventListener("keydown",i,!0),()=>{e.removeEventListener("blur",t),e.removeEventListener("keydown",i,!0)}},[a.domReference,n,l]),o.useEffect(()=>{if(l)return r.on("openchange",e),()=>{r.off("openchange",e)};function e(e){let{reason:t}=e;("reference-press"===t||"escape-key"===t)&&(d.current=!0)}},[r,l]),o.useEffect(()=>()=>{clearTimeout(f.current)},[]);let m=o.useMemo(()=>({onPointerDown(e){var t;t=e.nativeEvent,!k().includes("jsdom/")&&(!A()&&0===t.width&&0===t.height||A()&&1===t.width&&1===t.height&&0===t.pressure&&0===t.detail&&"mouse"===t.pointerType||t.width<1&&t.height<1&&0===t.pressure&&0===t.detail&&"touch"===t.pointerType)||(p.current=!1)},onMouseLeave(){d.current=!1},onFocus(e){if(d.current)return;let t=P(e.nativeEvent);if(u&&h(t))try{if(x()&&O().toLowerCase().startsWith("mac")&&!navigator.maxTouchPoints)throw Error();if(!t.matches(":focus-visible"))return}catch{if(!p.current&&!D(t))return}i(!0,e.nativeEvent,"focus")},onBlur(e){d.current=!1;let t=e.relatedTarget,n=e.nativeEvent,r=h(t)&&t.hasAttribute(tr("focus-guard"))&&"outside"===t.getAttribute("data-type");f.current=window.setTimeout(()=>{var e;let o=R(a.domReference?a.domReference.ownerDocument:document);!t&&o===a.domReference||E(null==(e=s.current.floatingContext)?void 0:e.refs.floating.current,o)||E(a.domReference,o)||r||i(!1,n,"focus")})}}),[s,a.domReference,i,u]);return o.useMemo(()=>l?{reference:m}:{},[l,m])}(b),j=function(e,t){void 0===t&&(t={});let{open:n,onOpenChange:i,elements:r,dataRef:s}=e,{enabled:a=!0,escapeKey:l=!0,outsidePress:c=!0,outsidePressEvent:u="pointerdown",referencePress:d=!1,referencePressEvent:f="pointerdown",ancestorScroll:p=!1,bubbles:m,capture:b}=t,y=ti(),_=e1("function"==typeof c?c:()=>!1),M="function"==typeof c?_:c,R=o.useRef(!1),O=o.useRef(!1),{escapeKey:k,outsidePress:x}=tM(m),{escapeKey:A,outsidePress:T}=tM(b),D=e1(e=>{var t;if(!n||!a||!l||"Escape"!==e.key)return;let r=null==(t=s.current.floatingContext)?void 0:t.nodeId,o=y?tl(y.nodesRef.current,r):[];if(!k&&(e.stopPropagation(),o.length>0)){let e=!0;if(o.forEach(t=>{var n;if(null!=(n=t.context)&&n.open&&!t.context.dataRef.current.__escapeKeyBubbles){e=!1;return}}),!e)return}i(!1,"nativeEvent"in e?e.nativeEvent:e,"escape-key")}),N=e1(e=>{var t;let n=()=>{var t;D(e),null==(t=P(e))||t.removeEventListener("keydown",n)};null==(t=P(e))||t.addEventListener("keydown",n)}),F=e1(e=>{var t;let n=R.current;R.current=!1;let o=O.current;if(O.current=!1,"click"===u&&o||n||"function"==typeof M&&!M(e))return;let a=P(e),l="["+tr("inert")+"]",c=L(r.floating).querySelectorAll(l),d=h(a)?a:null;for(;d&&!v(d);){let e=S(d);if(v(e)||!h(e))break;d=e}if(c.length&&h(a)&&!a.matches("html,body")&&!E(a,r.floating)&&Array.from(c).every(e=>!E(d,e)))return;if(g(a)&&G){let t=a.clientWidth>0&&a.scrollWidth>a.clientWidth,n=a.clientHeight>0&&a.scrollHeight>a.clientHeight,i=n&&e.offsetX>a.clientWidth;if(n&&"rtl"===w(a).direction&&(i=e.offsetX<=a.offsetWidth-a.clientWidth),i||t&&e.offsetY>a.clientHeight)return}let f=null==(t=s.current.floatingContext)?void 0:t.nodeId,p=y&&tl(y.nodesRef.current,f).some(t=>{var n;return I(e,null==(n=t.context)?void 0:n.elements.floating)});if(I(e,r.floating)||I(e,r.domReference)||p)return;let m=y?tl(y.nodesRef.current,f):[];if(m.length>0){let e=!0;if(m.forEach(t=>{var n;if(null!=(n=t.context)&&n.open&&!t.context.dataRef.current.__outsidePressBubbles){e=!1;return}}),!e)return}i(!1,e,"outside-press")}),H=e1(e=>{var t;let n=()=>{var t;F(e),null==(t=P(e))||t.removeEventListener(u,n)};null==(t=P(e))||t.addEventListener(u,n)});o.useEffect(()=>{if(!n||!a)return;function e(e){i(!1,e,"ancestor-scroll")}s.current.__escapeKeyBubbles=k,s.current.__outsidePressBubbles=x;let t=L(r.floating);l&&t.addEventListener("keydown",A?N:D,A),M&&t.addEventListener(u,T?H:F,T);let o=[];return p&&(h(r.domReference)&&(o=C(r.domReference)),h(r.floating)&&(o=o.concat(C(r.floating))),!h(r.reference)&&r.reference&&r.reference.contextElement&&(o=o.concat(C(r.reference.contextElement)))),(o=o.filter(e=>{var n;return e!==(null==(n=t.defaultView)?void 0:n.visualViewport)})).forEach(t=>{t.addEventListener("scroll",e,{passive:!0})}),()=>{l&&t.removeEventListener("keydown",A?N:D,A),M&&t.removeEventListener(u,T?H:F,T),o.forEach(t=>{t.removeEventListener("scroll",e)})}},[s,r,l,M,u,n,i,p,a,k,x,D,A,N,F,T,H]),o.useEffect(()=>{R.current=!1},[M,u]);let j=o.useMemo(()=>({onKeyDown:D,[tS[f]]:e=>{d&&i(!1,e.nativeEvent,"reference-press")}}),[D,i,d,f]),G=o.useMemo(()=>({onKeyDown:D,onMouseDown(){O.current=!0},onMouseUp(){O.current=!0},[tC[u]]:()=>{R.current=!0}}),[D,u]);return o.useMemo(()=>a?{reference:j,floating:G}:{},[a,j,G])}(b),G=function(e,t){var n;void 0===t&&(t={});let{open:i,floatingId:r}=e,{enabled:s=!0,role:a="dialog"}=t,l=null!=(n=tk.get(a))?n:a,c=e9(),u=null!=tn(),d=o.useMemo(()=>"tooltip"===l||"label"===a?{["aria-"+("label"===a?"labelledby":"describedby")]:i?r:void 0}:{"aria-expanded":i?"true":"false","aria-haspopup":"alertdialog"===l?"dialog":l,"aria-controls":i?r:void 0,..."listbox"===l&&{role:"combobox"},..."menu"===l&&{id:c},..."menu"===l&&u&&{role:"menuitem"},..."select"===a&&{"aria-autocomplete":"none"},..."combobox"===a&&{"aria-autocomplete":"list"}},[l,r,u,i,c,a]),h=o.useMemo(()=>{let e={id:r,...l&&{role:l}};return"tooltip"===l||"label"===a?e:{...e,..."menu"===l&&{"aria-labelledby":c}}},[l,r,c,a]),g=o.useCallback(e=>{let{active:t,selected:n}=e,i={role:"option",...t&&{id:r+"-option"}};switch(a){case"select":return{...i,"aria-selected":t&&n};case"combobox":return{...i,...t&&{"aria-selected":!0}}}return{}},[r,a]);return o.useMemo(()=>s?{reference:d,floating:h,item:g}:{},[s,d,h,g])}(b,{role:"tooltip"}),{styles:U}=function(e,t){void 0===t&&(t={});let{initial:n={opacity:0},open:i,close:r,common:s,duration:a=250}=t,l=e.placement,c=l.split("-")[0],u=o.useMemo(()=>({side:c,placement:l}),[c,l]),d="number"==typeof a,h=(d?a:a.open)||0,g=(d?a:a.close)||0,[f,p]=o.useState(()=>({...tA(s,u),...tA(n,u)})),{isMounted:m,status:b}=function(e,t){void 0===t&&(t={});let{open:n,elements:{floating:i}}=e,{duration:r=250}=t,s=("number"==typeof r?r:r.close)||0,[a,l]=o.useState("unmounted"),c=function(e,t){let[n,i]=o.useState(e);return e&&!n&&i(!0),o.useEffect(()=>{if(!e&&n){let e=setTimeout(()=>i(!1),t);return()=>clearTimeout(e)}},[e,n,t]),n}(n,s);return c||"close"!==a||l("unmounted"),e2(()=>{if(i){if(n){l("initial");let e=requestAnimationFrame(()=>{l("open")});return()=>{cancelAnimationFrame(e)}}l("close")}},[n,i]),{isMounted:c,status:a}}(e,{duration:a}),y=to(n),v=to(i),w=to(r),_=to(s);return e2(()=>{let e=tA(y.current,u),t=tA(w.current,u),n=tA(_.current,u),i=tA(v.current,u)||Object.keys(e).reduce((e,t)=>(e[t]="",e),{});if("initial"===b&&p(t=>({transitionProperty:t.transitionProperty,...n,...e})),"open"===b&&p({transitionProperty:Object.keys(i).map(tx).join(","),transitionDuration:h+"ms",...n,...i}),"close"===b){let i=t||e;p({transitionProperty:Object.keys(i).map(tx).join(","),transitionDuration:g+"ms",...n,...i})}},[g,w,y,v,_,h,b,u]),{isMounted:m,styles:f}}(b,{initial:{opacity:0}}),{getFloatingProps:V,getReferenceProps:Y}=function(e){void 0===e&&(e=[]);let t=e.map(e=>null==e?void 0:e.reference),n=e.map(e=>null==e?void 0:e.floating),i=e.map(e=>null==e?void 0:e.item),r=o.useCallback(t=>tO(t,e,"reference"),t),s=o.useCallback(t=>tO(t,e,"floating"),n),a=o.useCallback(t=>tO(t,e,"item"),i);return o.useMemo(()=>({getReferenceProps:r,getFloatingProps:s,getItemProps:a}),[r,s,a])}([N,H,j,G,F]);return(0,r.jsxs)(r.Fragment,{children:[l({ref:M,...Y()}),n&&!i&&(0,r.jsx)(tv,{children:(0,r.jsx)("div",{className:(0,tT.c)({[tL.hidden]:!f}),ref:_,style:{...y,maxWidth:d?`${d}px`:void 0,zIndex:18},...V(),children:(0,r.jsxs)("div",{className:(0,tT.c)(tL.tooltipContainer,tI[t],e),style:U,children:[(0,r.jsx)(e7,{className:tI.arrow,context:b,height:10,ref:m,tipRadius:2,width:20}),n]})})})]})}},86894:(e,t,n)=>{"use strict";n.d(t,{s:()=>o});var i=n(52322);let r={sm:{height:"16",width:"18"},xxs:{height:"12",width:"15"}},o=({className:e,size:t="sm"})=>(0,i.jsxs)("svg",{className:e,fill:"currentColor",height:r[t].height,viewBox:"0 0 18 16",width:r[t].width,xmlns:"http://www.w3.org/2000/svg",children:[(0,i.jsx)("path",{d:"M17.647 1.076V13.17a.56.56 0 0 1-.178.407.626.626 0 0 1-.43.169h-.913a.313.313 0 0 1-.215-.085.28.28 0 0 1-.09-.203v-1.111a.274.274 0 0 1 .092-.206 2.53 2.53 0 0 0 .82-1.757 2.51 2.51 0 0 0-.819-1.943.289.289 0 0 1-.092-.206V4.53a2.506 2.506 0 0 1-1.722-.674 2.243 2.243 0 0 1-.713-1.63H4.26c0 .612-.257 1.198-.713 1.63a2.506 2.506 0 0 1-1.721.674v5.183c.645 0 1.264.243 1.72.675.457.432.714 1.018.714 1.629h7.564a.32.32 0 0 1 .219.088l.036.034a.29.29 0 0 1 .091.206v1.112a.28.28 0 0 1-.089.203.313.313 0 0 1-.215.085H.61a.626.626 0 0 1-.43-.169A.56.56 0 0 1 0 13.17V1.076c0-.153.064-.3.178-.407A.626.626 0 0 1 .608.5h16.43c.162 0 .317.06.43.169a.56.56 0 0 1 .179.407Z",fill:"currentColor"}),(0,i.jsx)("path",{d:"M14.902 8.467c.264.117.499.284.691.49.353.378.543.868.532 1.373-.01.504-.22.987-.588 1.352a2.182 2.182 0 0 1-1.4.62 2.212 2.212 0 0 1-1.55-.5 2.028 2.028 0 0 1-.518-.654 1.928 1.928 0 0 1 .422-2.282c.206-.195.451-.347.722-.449a2.237 2.237 0 0 1 1.69.05Z",fill:"currentColor",opacity:".4"}),(0,i.jsx)("g",{fill:"#currentColor",opacity:".4",children:(0,i.jsx)("path",{d:"M12.17 5.107H5.477a.313.313 0 0 1-.215-.084.28.28 0 0 1-.09-.204.28.28 0 0 1 .09-.203.313.313 0 0 1 .215-.085h6.693c.081 0 .159.03.216.085a.28.28 0 0 1 .089.203.28.28 0 0 1-.09.204.313.313 0 0 1-.215.084ZM12.17 7.41H5.477a.313.313 0 0 1-.215-.084.28.28 0 0 1-.09-.203.28.28 0 0 1 .09-.204.313.313 0 0 1 .215-.084h6.693c.081 0 .159.03.216.084a.28.28 0 0 1 .089.204.28.28 0 0 1-.09.203.313.313 0 0 1-.215.085ZM5.487 9.138h5.88a.12.12 0 0 1 .053.013c.017.008.03.02.041.035a.104.104 0 0 1 .01.101 2.48 2.48 0 0 0-.124.348.107.107 0 0 1-.04.057.118.118 0 0 1-.07.022h-5.76a.32.32 0 0 1-.222-.09.286.286 0 0 1-.082-.217.29.29 0 0 1 .101-.193.322.322 0 0 1 .213-.076Z"})}),(0,i.jsx)("path",{d:"M12.936 12.68a2.881 2.881 0 0 0 2.12 0 .121.121 0 0 1 .107.01.11.11 0 0 1 .037.039.103.103 0 0 1 .013.05v2.433a.276.276 0 0 1-.041.145.297.297 0 0 1-.113.106.317.317 0 0 1-.307-.004l-.6-.34a.318.318 0 0 0-.313 0l-.6.34a.317.317 0 0 1-.419-.102.276.276 0 0 1-.041-.145V12.78c0-.018.005-.036.013-.051a.109.109 0 0 1 .037-.04.119.119 0 0 1 .107-.01Z",fill:"currentColor",opacity:".4"})]})},15051:(e,t,n)=>{"use strict";n.d(t,{jd:()=>c,ms:()=>u,lv:()=>a});var i=n(2784);let r=Symbol.for("__ABLY_CONTEXT__"),o="undefined"!=typeof globalThis?globalThis:{},s=function(){let e=o[r];return e||(e=o[r]=i.createContext({})),e}();function a(e="default"){let t=i.useContext(s)[e].client;if(!t)throw Error("Could not find ably client in context. Make sure your ably hooks are called inside an <AblyProvider>");return t}var l=n(52322);let c=({client:e,children:t,ablyId:n="default"})=>{if(!e)throw Error("AblyProvider: the `client` prop is required");let r=i.useContext(s),o=(0,i.useMemo)(()=>Object.assign(Object.assign({},r),{[n]:{client:e,_channelNameToChannelContext:{}}}),[r,e,n]);return(0,l.jsx)(s.Provider,Object.assign({value:o},{children:t}))},u=({ablyId:e="default",channelName:t,options:n,deriveOptions:r,children:o})=>{let a=i.useContext(s),{client:c,_channelNameToChannelContext:u}=a[e];if(u[t])throw Error("You can not use more than one `ChannelProvider` with the same channel name");let d=!!r,h=d?c.channels.getDerived(t,r):c.channels.get(t),g=(0,i.useMemo)(()=>Object.assign(Object.assign({},a),{[e]:{client:c,_channelNameToChannelContext:Object.assign(Object.assign({},u),{[t]:{channel:h,derived:d}})}}),[d,c,h,t,u,e,a]);return(0,i.useLayoutEffect)(()=>{h.setOptions(function(e){return Object.assign(Object.assign({},e),{params:Object.assign(Object.assign({},null==e?void 0:e.params),{agent:"react-hooks/2.3.0"})})}(n))},[h,n]),(0,l.jsx)(s.Provider,Object.assign({value:g},{children:o}))}}}]);